!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.jsts=e.jsts||{})}(this,function(e){"use strict";function t(){}function n(e){this.message=e||""}function i(e){this.message=e||""}function r(){}function s(e){return null===e?Se:e.color}function o(e){return null===e?null:e.parent}function a(e,t){null!==e&&(e.color=t)}function u(e){return null===e?null:e.left}function l(e){return null===e?null:e.right}function h(){this.root_=null,this.size_=0}function c(){}function f(){this.array_=[],arguments[0]instanceof fe&&this.addAll(arguments[0])}function g(){}function y(e){return[e.x,e.y]}function v(e){this.message=e||""}function d(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(e){if(void 0===this||null===this)throw new TypeError(this+" is not an object");var t=Object(this),n=Math.max(Math.min(t.length,9007199254740991),0)||0,i=1 in arguments?parseInt(Number(arguments[1]),10)||0:0;i=i<0?Math.max(n+i,0):Math.min(i,n);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(r=r<0?Math.max(n+arguments[2],0):Math.min(r,n);i<r;)t[i]=e,++i;return t},writable:!0}),Number.isFinite=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(e){return e!=e},Math.trunc=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};var _=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},p=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),m=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},k=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},I=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}},{key:"equalsWithTolerance",value:function(e,t,n){return Math.abs(e-t)<=n}}]),e}(),x=function e(){_(this,e)},E=function(){function e(){_(this,e)}return p(e,null,[{key:"isNaN",value:function(e){return Number.isNaN(e)}},{key:"doubleToLongBits",value:function(e){return e}},{key:"longBitsToDouble",value:function(e){return e}},{key:"isInfinite",value:function(e){return!Number.isFinite(e)}},{key:"MAX_VALUE",get:function(){return Number.MAX_VALUE}}]),e}(),N=function e(){_(this,e)},C=function e(){_(this,e)},S=function e(){_(this,e)},L=function(){function e(){if(_(this,e),this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=e.NULL_ORDINATE;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.z=t.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=e.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])}return p(e,[{key:"setOrdinate",value:function(t,n){switch(t){case e.X:this.x=n;break;case e.Y:this.y=n;break;case e.Z:this.z=n;break;default:throw new x("Invalid ordinate index: "+t)}}},{key:"equals2D",value:function(){if(1===arguments.length){var e=arguments[0];return this.x===e.x&&this.y===e.y}if(2===arguments.length){var t=arguments[0],n=arguments[1];return!!I.equalsWithTolerance(this.x,t.x,n)&&!!I.equalsWithTolerance(this.y,t.y,n)}}},{key:"getOrdinate",value:function(t){switch(t){case e.X:return this.x;case e.Y:return this.y;case e.Z:return this.z}throw new x("Invalid ordinate index: "+t)}},{key:"equals3D",value:function(e){return this.x===e.x&&this.y===e.y&&(this.z===e.z||E.isNaN(this.z))&&E.isNaN(e.z)}},{key:"equals",value:function(t){return t instanceof e&&this.equals2D(t)}},{key:"equalInZ",value:function(e,t){return I.equalsWithTolerance(this.z,e.z,t)}},{key:"compareTo",value:function(e){var t=e;return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0}},{key:"clone",value:function(){}},{key:"copy",value:function(){return new e(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"distance3D",value:function(e){var t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return Math.sqrt(t*t+n*n+i*i)}},{key:"distance",value:function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}},{key:"hashCode",value:function(){var t=17;return t=37*t+e.hashCode(this.x),t=37*t+e.hashCode(this.y)}},{key:"setCoordinate",value:function(e){this.x=e.x,this.y=e.y,this.z=e.z}},{key:"interfaces_",value:function(){return[N,C,t]}},{key:"getClass",value:function(){return e}}],[{key:"hashCode",value:function(){if(1===arguments.length){var e=arguments[0],t=E.doubleToLongBits(e);return Math.trunc((t^t)>>>32)}}},{key:"DimensionalComparator",get:function(){return w}},{key:"serialVersionUID",get:function(){return 0x5cbf2c235c7e5800}},{key:"NULL_ORDINATE",get:function(){return E.NaN}},{key:"X",get:function(){return 0}},{key:"Y",get:function(){return 1}},{key:"Z",get:function(){return 2}}]),e}(),w=function(){function e(t){if(_(this,e),this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var n=arguments[0];if(2!==n&&3!==n)throw new x("only 2 or 3 dimensions may be specified");this._dimensionsToTest=n}}return p(e,[{key:"compare",value:function(t,n){var i=t,r=n,s=e.compare(i.x,r.x);if(0!==s)return s;var o=e.compare(i.y,r.y);if(0!==o)return o;if(this._dimensionsToTest<=2)return 0;return e.compare(i.z,r.z)}},{key:"interfaces_",value:function(){return[S]}},{key:"getClass",value:function(){return e}}],[{key:"compare",value:function(e,t){return e<t?-1:e>t?1:E.isNaN(e)?E.isNaN(t)?0:-1:E.isNaN(t)?1:0}}]),e}(),P=function(){function e(){_(this,e)}return p(e,[{key:"create",value:function(){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),O=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"toLocationSymbol",value:function(t){switch(t){case e.EXTERIOR:return"e";case e.BOUNDARY:return"b";case e.INTERIOR:return"i";case e.NONE:return"-"}throw new x("Unknown location value: "+t)}},{key:"INTERIOR",get:function(){return 0}},{key:"BOUNDARY",get:function(){return 1}},{key:"EXTERIOR",get:function(){return 2}},{key:"NONE",get:function(){return-1}}]),e}(),R=function(e,t){return e.interfaces_&&e.interfaces_().indexOf(t)>-1},T=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"log10",value:function(t){var n=Math.log(t);return E.isInfinite(n)?n:E.isNaN(n)?n:n/e.LOG_10}},{key:"min",value:function(e,t,n,i){var r=e;return t<r&&(r=t),n<r&&(r=n),i<r&&(r=i),r}},{key:"clamp",value:function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],t=arguments[1],n=arguments[2];return e<t?t:e>n?n:e}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],s=arguments[2];return i<r?r:i>s?s:i}}},{key:"wrap",value:function(e,t){return e<0?t- -e%t:e%t}},{key:"max",value:function(){if(3===arguments.length){var e=arguments[0],t=arguments[1],n=arguments[2],i=e;return t>i&&(i=t),n>i&&(i=n),i}if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3],u=r;return s>u&&(u=s),o>u&&(u=o),a>u&&(u=a),u}}},{key:"average",value:function(e,t){return(e+t)/2}},{key:"LOG_10",get:function(){return Math.log(10)}}]),e}(),b=function(){function e(t){_(this,e),this.str=t}return p(e,[{key:"append",value:function(e){this.str+=e}},{key:"setCharAt",value:function(e,t){this.str=this.str.substr(0,e)+t+this.str.substr(e+1)}},{key:"toString",value:function(e){return this.str}}]),e}(),D=function(){function e(t){_(this,e),this.value=t}return p(e,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(e){return this.value<e?-1:this.value>e?1:0}}],[{key:"isNaN",value:function(e){return Number.isNaN(e)}}]),e}(),M=function(){function e(){_(this,e)}return p(e,null,[{key:"isWhitespace",value:function(e){return e<=32&&e>=0||127===e}},{key:"toUpperCase",value:function(e){return e.toUpperCase()}}]),e}(),A=function(){function e(){if(_(this,e),this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}else if("string"==typeof arguments[0]){var i=arguments[0];e.call(this,e.parse(i))}}else if(2===arguments.length){var r=arguments[0],s=arguments[1];this.init(r,s)}}return p(e,[{key:"le",value:function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<=e._lo}},{key:"extractSignificantDigits",value:function(t,n){var i=this.abs(),r=e.magnitude(i._hi),s=e.TEN.pow(r);(i=i.divide(s)).gt(e.TEN)?(i=i.divide(e.TEN),r+=1):i.lt(e.ONE)&&(i=i.multiply(e.TEN),r-=1);for(var o=r+1,a=new b,u=e.MAX_PRINT_DIGITS-1,l=0;l<=u;l++){t&&l===o&&a.append(".");var h=Math.trunc(i._hi);if(h<0)break;var c=!1,f=0;h>9?(c=!0,f="9"):f="0"+h,a.append(f),i=i.subtract(e.valueOf(h)).multiply(e.TEN),c&&i.selfAdd(e.TEN);var g=!0,y=e.magnitude(i._hi);if(y<0&&Math.abs(y)>=u-l&&(g=!1),!g)break}return n[0]=r,a.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var n=arguments[0];return this.add(-n)}}},{key:"equals",value:function(){if(1===arguments.length){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}}},{key:"isZero",value:function(){return 0===this._hi&&0===this._lo}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var n=arguments[0];return this.isNaN()?this:this.selfAdd(-n,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(e){return this.le(e)?this:e}},{key:"selfDivide",value:function(){if(1===arguments.length){if(arguments[0]instanceof e){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var n=arguments[0];return this.selfDivide(n,0)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1],s=null,o=null,a=null,u=null,l=null,h=null,c=null,f=null;return l=this._hi/i,h=e.SPLIT*l,s=h-l,f=e.SPLIT*i,s=h-s,o=l-s,a=f-i,c=l*i,a=f-a,u=i-a,f=s*a-c+s*u+o*a+o*u,h=(this._hi-c-f+this._lo-l*r)/i,f=l+h,this._hi=f,this._lo=l-f+h,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof e){var t=arguments[0],n=null,i=null,r=null,s=null,o=null,a=null,u=null,l=null;i=(o=this._hi/t._hi)-(n=(a=e.SPLIT*o)-(n=a-o)),l=n*(r=(l=e.SPLIT*t._hi)-(r=l-t._hi))-(u=o*t._hi)+n*(s=t._hi-r)+i*r+i*s;return new e(l=o+(a=(this._hi-u-l+this._lo-o*t._lo)/t._hi),o-l+a)}if("number"==typeof arguments[0]){var h=arguments[0];return E.isNaN(h)?e.createNaN():e.copy(this).selfDivide(h,0)}}},{key:"ge",value:function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>=e._lo}},{key:"pow",value:function(t){if(0===t)return e.valueOf(1);var n=new e(this),i=e.valueOf(1),r=Math.abs(t);if(r>1)for(;r>0;)r%2==1&&i.selfMultiply(n),(r/=2)>0&&(n=n.sqr());else i=n;return t<0?i.reciprocal():i}},{key:"ceil",value:function(){if(this.isNaN())return e.NaN;var t=Math.ceil(this._hi),n=0;return t===this._hi&&(n=Math.ceil(this._lo)),new e(t,n)}},{key:"compareTo",value:function(e){var t=e;return this._hi<t._hi?-1:this._hi>t._hi?1:this._lo<t._lo?-1:this._lo>t._lo?1:0}},{key:"rint",value:function(){if(this.isNaN())return this;return this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var n=arguments[0];return this.init(n),this}}},{key:"max",value:function(e){return this.ge(e)?this:e}},{key:"sqrt",value:function(){if(this.isZero())return e.valueOf(0);if(this.isNegative())return e.NaN;var t=1/Math.sqrt(this._hi),n=this._hi*t,i=e.valueOf(n),r=this.subtract(i.sqr())._hi*(.5*t);return i.add(r)}},{key:"selfAdd",value:function(){if(1===arguments.length){if(arguments[0]instanceof e){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var n=arguments[0],i=null,r=null,s=null,o=null,a=null,u=null;return s=this._hi+n,a=s-this._hi,o=s-a,o=n-a+(this._hi-o),u=o+this._lo,i=s+u,r=u+(s-i),this._hi=i+r,this._lo=r+(i-this._hi),this}}else if(2===arguments.length){var l=arguments[0],h=arguments[1],c=null,f=null,g=null,y=null,v=null,d=null,_=null,p=null;v=this._hi+l,g=this._lo+h,d=v-(_=v-this._hi),y=g-(p=g-this._lo);var m=(c=v+(_=(d=l-_+(this._hi-d))+g))+(_=(y=h-p+(this._lo-y))+(f=_+(v-c))),k=_+(c-m);return this._hi=m,this._lo=k,this}}},{key:"selfMultiply",value:function(){if(1===arguments.length){if(arguments[0]instanceof e){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var n=arguments[0];return this.selfMultiply(n,0)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1],s=null,o=null,a=null,u=null,l=null,h=null;s=(l=e.SPLIT*this._hi)-this._hi,h=e.SPLIT*i,s=l-s,o=this._hi-s,a=h-i;var c=(l=this._hi*i)+(h=s*(a=h-a)-l+s*(u=i-a)+o*a+o*u+(this._hi*r+this._lo*i)),f=h+(s=l-c);return this._hi=c,this._lo=f,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return e.NaN;var t=Math.floor(this._hi),n=0;return t===this._hi&&(n=Math.floor(this._lo)),new e(t,n)}},{key:"negate",value:function(){return this.isNaN()?this:new e(-this._hi,-this._lo)}},{key:"clone",value:function(){}},{key:"multiply",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return t.isNaN()?e.createNaN():e.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var n=arguments[0];return E.isNaN(n)?e.createNaN():e.copy(this).selfMultiply(n,0)}}},{key:"isNaN",value:function(){return E.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var t=e.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var t=this.getSpecialNumberString();if(null!==t)return t;var n=new Array(1).fill(null),i=this.extractSignificantDigits(!0,n),r=n[0]+1,s=i;if("."===i.charAt(0))s="0"+i;else if(r<0)s="0."+e.stringOfChar("0",-r)+i;else if(-1===i.indexOf(".")){var o=r-i.length;s=i+e.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+s:s}},{key:"reciprocal",value:function(){var t=null,n=null,i=null,r=null,s=null,o=null,a=null,u=null;n=(s=1/this._hi)-(t=(o=e.SPLIT*s)-(t=o-s)),i=(u=e.SPLIT*this._hi)-this._hi;var l=s+(o=(1-(a=s*this._hi)-(u=t*(i=u-i)-a+t*(r=this._hi-i)+n*i+n*r)-s*this._lo)/this._hi);return new e(l,s-l+o)}},{key:"toSciNotation",value:function(){if(this.isZero())return e.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var n=new Array(1).fill(null),i=this.extractSignificantDigits(!1,n),r=e.SCI_NOT_EXPONENT_CHAR+n[0];if("0"===i.charAt(0))throw new Error("Found leading zero: "+i);var s="";i.length>1&&(s=i.substring(1));var o=i.charAt(0)+"."+s;return this.isNegative()?"-"+o+r:o+r}},{key:"abs",value:function(){return this.isNaN()?e.NaN:this.isNegative()?this.negate():new e(this)}},{key:"isPositive",value:function(){return(this._hi>0||0===this._hi)&&this._lo>0}},{key:"lt",value:function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<e._lo}},{key:"add",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return e.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var n=arguments[0];return e.copy(this).selfAdd(n)}}},{key:"init",value:function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof e){var n=arguments[0];this._hi=n._hi,this._lo=n._lo}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this._hi=i,this._lo=r}}},{key:"gt",value:function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>e._lo}},{key:"isNegative",value:function(){return(this._hi<0||0===this._hi)&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?e.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",value:function(){return[t,N,C]}},{key:"getClass",value:function(){return e}}],[{key:"sqr",value:function(t){return e.valueOf(t).selfMultiply(t)}},{key:"valueOf",value:function(){if("string"==typeof arguments[0]){var t=arguments[0];return e.parse(t)}if("number"==typeof arguments[0]){return new e(arguments[0])}}},{key:"sqrt",value:function(t){return e.valueOf(t).sqrt()}},{key:"parse",value:function(t){for(var n=0,i=t.length;M.isWhitespace(t.charAt(n));)n++;var r=!1;if(n<i){var s=t.charAt(n);"-"!==s&&"+"!==s||(n++,"-"===s&&(r=!0))}for(var o=new e,a=0,u=0,l=0;;){if(n>=i)break;var h=t.charAt(n);if(n++,M.isDigit(h)){var c=h-"0";o.selfMultiply(e.TEN),o.selfAdd(c),a++}else{if("."!==h){if("e"===h||"E"===h){var f=t.substring(n);try{l=D.parseInt(f)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+f+" in string "+t):e}break}throw new Error("Unexpected character '"+h+"' at position "+n+" in string "+t)}u=a}}var g=o,y=a-u-l;if(0===y)g=o;else if(y>0){var v=e.TEN.pow(y);g=o.divide(v)}else if(y<0){var d=e.TEN.pow(-y);g=o.multiply(d)}return r?g.negate():g}},{key:"createNaN",value:function(){return new e(E.NaN,E.NaN)}},{key:"copy",value:function(t){return new e(t)}},{key:"magnitude",value:function(e){var t=Math.abs(e),n=Math.log(t)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=t&&(i+=1),i}},{key:"stringOfChar",value:function(e,t){for(var n=new b,i=0;i<t;i++)n.append(e);return n.toString()}},{key:"PI",get:function(){return new e(3.141592653589793,1.2246467991473532e-16)}},{key:"TWO_PI",get:function(){return new e(6.283185307179586,2.4492935982947064e-16)}},{key:"PI_2",get:function(){return new e(1.5707963267948966,6.123233995736766e-17)}},{key:"E",get:function(){return new e(2.718281828459045,1.4456468917292502e-16)}},{key:"NaN",get:function(){return new e(E.NaN,E.NaN)}},{key:"EPS",get:function(){return 1.23259516440783e-32}},{key:"SPLIT",get:function(){return 134217729}},{key:"MAX_PRINT_DIGITS",get:function(){return 32}},{key:"TEN",get:function(){return e.valueOf(10)}},{key:"ONE",get:function(){return e.valueOf(1)}},{key:"SCI_NOT_EXPONENT_CHAR",get:function(){return"E"}},{key:"SCI_NOT_ZERO",get:function(){return"0.0E0"}}]),e}(),F=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"orientationIndex",value:function(t,n,i){var r=e.orientationIndexFilter(t,n,i);if(r<=1)return r;var s=A.valueOf(n.x).selfAdd(-t.x),o=A.valueOf(n.y).selfAdd(-t.y),a=A.valueOf(i.x).selfAdd(-n.x),u=A.valueOf(i.y).selfAdd(-n.y);return s.selfMultiply(u).selfSubtract(o.selfMultiply(a)).signum()}},{key:"signOfDet2x2",value:function(e,t,n,i){return e.multiply(i).selfSubtract(t.multiply(n)).signum()}},{key:"intersection",value:function(e,t,n,i){var r=A.valueOf(i.y).selfSubtract(n.y).selfMultiply(A.valueOf(t.x).selfSubtract(e.x)),s=A.valueOf(i.x).selfSubtract(n.x).selfMultiply(A.valueOf(t.y).selfSubtract(e.y)),o=r.subtract(s),a=A.valueOf(i.x).selfSubtract(n.x).selfMultiply(A.valueOf(e.y).selfSubtract(n.y)),u=A.valueOf(i.y).selfSubtract(n.y).selfMultiply(A.valueOf(e.x).selfSubtract(n.x)),l=a.subtract(u).selfDivide(o).doubleValue(),h=A.valueOf(e.x).selfAdd(A.valueOf(t.x).selfSubtract(e.x).selfMultiply(l)).doubleValue(),c=A.valueOf(t.x).selfSubtract(e.x).selfMultiply(A.valueOf(e.y).selfSubtract(n.y)),f=A.valueOf(t.y).selfSubtract(e.y).selfMultiply(A.valueOf(e.x).selfSubtract(n.x)),g=c.subtract(f).selfDivide(o).doubleValue(),y=A.valueOf(n.y).selfAdd(A.valueOf(i.y).selfSubtract(n.y).selfMultiply(g)).doubleValue();return new L(h,y)}},{key:"orientationIndexFilter",value:function(t,n,i){var r=null,s=(t.x-i.x)*(n.y-i.y),o=(t.y-i.y)*(n.x-i.x),a=s-o;if(s>0){if(o<=0)return e.signum(a);r=s+o}else{if(!(s<0))return e.signum(a);if(o>=0)return e.signum(a);r=-s-o}var u=e.DP_SAFE_EPSILON*r;return a>=u||-a>=u?e.signum(a):2}},{key:"signum",value:function(e){return e>0?1:e<0?-1:0}},{key:"DP_SAFE_EPSILON",get:function(){return 1e-15}}]),e}(),G=function(){function e(){_(this,e)}return p(e,[{key:"setOrdinate",value:function(e,t,n){}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(e,t){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(e){}},{key:"getDimension",value:function(){}},{key:"getX",value:function(e){}},{key:"clone",value:function(){}},{key:"expandEnvelope",value:function(e){}},{key:"copy",value:function(){}},{key:"getY",value:function(e){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",value:function(){return[C]}},{key:"getClass",value:function(){return e}}],[{key:"X",get:function(){return 0}},{key:"Y",get:function(){return 1}},{key:"Z",get:function(){return 2}},{key:"M",get:function(){return 3}}]),e}(),q=function e(){_(this,e)},B=function(e){function t(){return _(this,t),k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Projective point not representable on the Cartesian plane."))}return m(t,q),p(t,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),z=function(){function e(){_(this,e)}return p(e,null,[{key:"arraycopy",value:function(e,t,n,i,r){for(var s=0,o=t;o<t+r;o++)n[i+s]=e[o],s++}},{key:"getProperty",value:function(e){return{"line.separator":"\n"}[e]}}]),e}(),V=function(){function e(){if(_(this,e),this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this.x=n,this.y=i,this.w=1}else if(arguments[0]instanceof e&&arguments[1]instanceof e){var r=arguments[0],s=arguments[1];this.x=r.y*s.w-s.y*r.w,this.y=s.x*r.w-r.x*s.w,this.w=r.x*s.y-s.x*r.y}else if(arguments[0]instanceof L&&arguments[1]instanceof L){var o=arguments[0],a=arguments[1];this.x=o.y-a.y,this.y=a.x-o.x,this.w=o.x*a.y-a.x*o.y}}else if(3===arguments.length){var u=arguments[0],l=arguments[1],h=arguments[2];this.x=u,this.y=l,this.w=h}else if(4===arguments.length){var c=arguments[0],f=arguments[1],g=arguments[2],y=arguments[3],v=c.y-f.y,d=f.x-c.x,p=c.x*f.y-f.x*c.y,m=g.y-y.y,k=y.x-g.x,I=g.x*y.y-y.x*g.y;this.x=d*I-k*p,this.y=m*p-v*I,this.w=v*k-m*d}}return p(e,[{key:"getY",value:function(){var e=this.y/this.w;if(E.isNaN(e)||E.isInfinite(e))throw new B;return e}},{key:"getX",value:function(){var e=this.x/this.w;if(E.isNaN(e)||E.isInfinite(e))throw new B;return e}},{key:"getCoordinate",value:function(){var e=new L;return e.x=this.getX(),e.y=this.getY(),e}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"intersection",value:function(e,t,n,i){var r=e.y-t.y,s=t.x-e.x,o=e.x*t.y-t.x*e.y,a=n.y-i.y,u=i.x-n.x,l=n.x*i.y-i.x*n.y,h=r*u-a*s,c=(s*l-u*o)/h,f=(a*o-r*l)/h;if(E.isNaN(c)||E.isInfinite(c)||E.isNaN(f)||E.isInfinite(f))throw new B;return new L(c,f)}}]),e}(),U=function(){function e(){if(_(this,e),this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof L){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof e){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(4===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2],u=arguments[3];this.init(s,o,a,u)}}return p(e,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(t){if(!(t instanceof e))return!1;var n=t;return this.isNull()?n.isNull():this._maxx===n.getMaxX()&&this._maxy===n.getMaxY()&&this._minx===n.getMinX()&&this._miny===n.getMinY()}},{key:"intersection",value:function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new e;var n=this._minx>t._minx?this._minx:t._minx,i=this._miny>t._miny?this._miny:t._miny;return new e(n,this._maxx<t._maxx?this._maxx:t._maxx,i,this._maxy<t._maxy?this._maxy:t._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(1===arguments.length){if(arguments[0]instanceof L){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof e){var n=arguments[0];return!this.isNull()&&!n.isNull()&&(n.getMinX()>=this._minx&&n.getMaxX()<=this._maxx&&n.getMinY()>=this._miny&&n.getMaxY()<=this._maxy)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return!this.isNull()&&(i>=this._minx&&i<=this._maxx&&r>=this._miny&&r<=this._maxy)}}},{key:"intersects",value:function(){if(1===arguments.length){if(arguments[0]instanceof e){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof L){var n=arguments[0];return this.intersects(n.x,n.y)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return!this.isNull()&&!(i>this._maxx||i<this._minx||r>this._maxy||r<this._miny)}}},{key:"getMinY",value:function(){return this._miny}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(1===arguments.length){if(arguments[0]instanceof L){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof e){var n=arguments[0];if(n.isNull())return null;this.isNull()?(this._minx=n.getMinX(),this._maxx=n.getMaxX(),this._miny=n.getMinY(),this._maxy=n.getMaxY()):(n._minx<this._minx&&(this._minx=n._minx),n._maxx>this._maxx&&(this._maxx=n._maxx),n._miny<this._miny&&(this._miny=n._miny),n._maxy>this._maxy&&(this._maxy=n._maxy))}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.isNull()?(this._minx=i,this._maxx=i,this._miny=r,this._maxy=r):(i<this._minx&&(this._minx=i),i>this._maxx&&(this._maxx=i),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e<t?e:t}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(e){var t=e;return this.isNull()?t.isNull()?0:-1:t.isNull()?1:this._minx<t._minx?-1:this._minx>t._minx?1:this._miny<t._miny?-1:this._miny>t._miny?1:this._maxx<t._maxx?-1:this._maxx>t._maxx?1:this._maxy<t._maxy?-1:this._maxy>t._maxy?1:0}},{key:"translate",value:function(e,t){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+t,this.getMaxY()+t)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var e=this.getWidth(),t=this.getHeight();return e>t?e:t}},{key:"expandBy",value:function(){if(1===arguments.length){var e=arguments[0];this.expandBy(e,e)}else if(2===arguments.length){var t=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(1===arguments.length){if(arguments[0]instanceof e){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof L){var n=arguments[0];return this.covers(n)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return this.covers(i,r)}}},{key:"centre",value:function(){return this.isNull()?null:new L((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof L){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof e){var n=arguments[0];this._minx=n._minx,this._maxx=n._maxx,this._miny=n._miny,this._maxy=n._maxy}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(4===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2],u=arguments[3];s<o?(this._minx=s,this._maxx=o):(this._minx=o,this._maxx=s),a<u?(this._miny=a,this._maxy=u):(this._miny=u,this._maxy=a)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(e){if(this.intersects(e))return 0;var t=0;this._maxx<e._minx?t=e._minx-this._maxx:this._minx>e._maxx&&(t=this._minx-e._maxx);var n=0;return this._maxy<e._miny?n=e._miny-this._maxy:this._miny>e._maxy&&(n=this._miny-e._maxy),0===t?n:0===n?t:Math.sqrt(t*t+n*n)}},{key:"hashCode",value:function(){var e=17;return e=37*e+L.hashCode(this._minx),e=37*e+L.hashCode(this._maxx),e=37*e+L.hashCode(this._miny),e=37*e+L.hashCode(this._maxy)}},{key:"interfaces_",value:function(){return[N,t]}},{key:"getClass",value:function(){return e}}],[{key:"intersects",value:function(){if(3===arguments.length){var e=arguments[0],t=arguments[1],n=arguments[2];return n.x>=(e.x<t.x?e.x:t.x)&&n.x<=(e.x>t.x?e.x:t.x)&&n.y>=(e.y<t.y?e.y:t.y)&&n.y<=(e.y>t.y?e.y:t.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3],a=Math.min(s.x,o.x),u=Math.max(s.x,o.x),l=Math.min(i.x,r.x),h=Math.max(i.x,r.x);return!(l>u)&&(!(h<a)&&(a=Math.min(s.y,o.y),u=Math.max(s.y,o.y),l=Math.min(i.y,r.y),h=Math.max(i.y,r.y),!(l>u)&&!(h<a)))}}},{key:"serialVersionUID",get:function(){return 0x51845cd552189800}}]),e}(),X={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Y=function(){function e(t){_(this,e),this.geometryFactory=t||new nt}return p(e,[{key:"read",value:function(e){var t,n,i;e=e.replace(/[\n\r]/g," ");var r=X.typeStr.exec(e);if(-1!==e.search("EMPTY")&&((r=X.emptyTypeStr.exec(e))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],H[n]&&(t=H[n].apply(this,[i]))),void 0===t)throw new Error("Could not parse WKT "+e);return t}},{key:"write",value:function(e){return this.extractGeometry(e)}},{key:"extractGeometry",value:function(e){var t=e.getGeometryType().toLowerCase();if(!j[t])return null;var n=t.toUpperCase();return e.isEmpty()?n+" EMPTY":n+"("+j[t].apply(this,[e])+")"}}]),e}(),j={coordinate:function(e){return e.x+" "+e.y},point:function(e){return j.coordinate.call(this,e._coordinates._coordinates[0])},multipoint:function(e){for(var t=[],n=0,i=e._geometries.length;n<i;++n)t.push("("+j.point.apply(this,[e._geometries[n]])+")");return t.join(",")},linestring:function(e){for(var t=[],n=0,i=e._points._coordinates.length;n<i;++n)t.push(j.coordinate.apply(this,[e._points._coordinates[n]]));return t.join(",")},linearring:function(e){for(var t=[],n=0,i=e._points._coordinates.length;n<i;++n)t.push(j.coordinate.apply(this,[e._points._coordinates[n]]));return t.join(",")},multilinestring:function(e){for(var t=[],n=0,i=e._geometries.length;n<i;++n)t.push("("+j.linestring.apply(this,[e._geometries[n]])+")");return t.join(",")},polygon:function(e){var t=[];t.push("("+j.linestring.apply(this,[e._shell])+")");for(var n=0,i=e._holes.length;n<i;++n)t.push("("+j.linestring.apply(this,[e._holes[n]])+")");return t.join(",")},multipolygon:function(e){for(var t=[],n=0,i=e._geometries.length;n<i;++n)t.push("("+j.polygon.apply(this,[e._geometries[n]])+")");return t.join(",")},geometrycollection:function(e){for(var t=[],n=0,i=e._geometries.length;n<i;++n)t.push(this.extractGeometry(e._geometries[n]));return t.join(",")}},H={point:function(e){if(void 0===e)return this.geometryFactory.createPoint();var t=e.trim().split(X.spaces);return this.geometryFactory.createPoint(new L(Number.parseFloat(t[0]),Number.parseFloat(t[1])))},multipoint:function(e){if(void 0===e)return this.geometryFactory.createMultiPoint();for(var t,n=e.trim().split(","),i=[],r=0,s=n.length;r<s;++r)t=n[r].replace(X.trimParens,"$1"),i.push(H.point.apply(this,[t]));return this.geometryFactory.createMultiPoint(i)},linestring:function(e){if(void 0===e)return this.geometryFactory.createLineString();for(var t,n=e.trim().split(","),i=[],r=0,s=n.length;r<s;++r)t=n[r].trim().split(X.spaces),i.push(new L(Number.parseFloat(t[0]),Number.parseFloat(t[1])));return this.geometryFactory.createLineString(i)},linearring:function(e){if(void 0===e)return this.geometryFactory.createLinearRing();for(var t,n=e.trim().split(","),i=[],r=0,s=n.length;r<s;++r)t=n[r].trim().split(X.spaces),i.push(new L(Number.parseFloat(t[0]),Number.parseFloat(t[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(e){if(void 0===e)return this.geometryFactory.createMultiLineString();for(var t,n=e.trim().split(X.parenComma),i=[],r=0,s=n.length;r<s;++r)t=n[r].replace(X.trimParens,"$1"),i.push(H.linestring.apply(this,[t]));return this.geometryFactory.createMultiLineString(i)},polygon:function(e){if(void 0===e)return this.geometryFactory.createPolygon();for(var t,n,i,r,s=e.trim().split(X.parenComma),o=[],a=0,u=s.length;a<u;++a)t=s[a].replace(X.trimParens,"$1"),n=H.linestring.apply(this,[t]),i=this.geometryFactory.createLinearRing(n._points),0===a?r=i:o.push(i);return this.geometryFactory.createPolygon(r,o)},multipolygon:function(e){if(void 0===e)return this.geometryFactory.createMultiPolygon();for(var t,n=e.trim().split(X.doubleParenComma),i=[],r=0,s=n.length;r<s;++r)t=n[r].replace(X.trimParens,"$1"),i.push(H.polygon.apply(this,[t]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(e){if(void 0===e)return this.geometryFactory.createGeometryCollection();for(var t=(e=e.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=t.length;i<r;++i)n.push(this.read(t[i]));return this.geometryFactory.createGeometryCollection(n)}},W=function(){function e(t){_(this,e),this.parser=new Y(t)}return p(e,[{key:"write",value:function(e){return this.parser.write(e)}}],[{key:"toLineString",value:function(e,t){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+e.x+" "+e.y+", "+t.x+" "+t.y+" )"}}]),e}(),K=function(e){function t(e){_(this,t);var n=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.name="RuntimeException",n.message=e,n.stack=(new Error).stack,n}return m(t,e),t}(Error),J=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(0===arguments.length)K.call(e);else if(1===arguments.length){var n=arguments[0];K.call(e,n)}return e}return m(t,K),p(t,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),Q=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"shouldNeverReachHere",value:function(){if(0===arguments.length)e.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new J("Should never reach here"+(null!==t?": "+t:""))}}},{key:"isTrue",value:function(){var t=void 0,n=void 0;if(1===arguments.length)t=arguments[0],e.isTrue(t,null);else if(2===arguments.length&&(t=arguments[0],n=arguments[1],!t))throw null===n?new J:new J(n)}},{key:"equals",value:function(){var t=void 0,n=void 0,i=void 0;if(2===arguments.length)t=arguments[0],n=arguments[1],e.equals(t,n,null);else if(3===arguments.length&&(t=arguments[0],n=arguments[1],i=arguments[2],!n.equals(t)))throw new J("Expected "+t+" but encountered "+n+(null!==i?": "+i:""))}}]),e}(),Z=function(){function e(){_(this,e),this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new L,this._intPt[1]=new L,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}return p(e,[{key:"getIndexAlongSegment",value:function(e,t){return this.computeIntLineIndex(),this._intLineIndex[e][t]}},{key:"getTopologySummary",value:function(){var e=new b;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()}},{key:"computeIntersection",value:function(e,t,n,i){this._inputLines[0][0]=e,this._inputLines[0][1]=t,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(e,t,n,i)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var e=arguments[0];this.getEdgeDistance(e,0)>this.getEdgeDistance(e,1)?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(e){this._precisionModel=e}},{key:"isInteriorIntersection",value:function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var e=arguments[0],t=0;t<this._result;t++)if(!this._intPt[t].equals2D(this._inputLines[e][0])&&!this._intPt[t].equals2D(this._inputLines[e][1]))return!0;return!1}}},{key:"getIntersection",value:function(e){return this._intPt[e]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==e.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(t,n){return e.computeEdgeDistance(this._intPt[n],this._inputLines[t][0],this._inputLines[t][1])}},{key:"isCollinear",value:function(){return this._result===e.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return W.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+W.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(e,t){return this._inputLines[e][t]}},{key:"isIntersection",value:function(e){for(var t=0;t<this._result;t++)if(this._intPt[t].equals2D(e))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(e,t){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][t]]}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"computeEdgeDistance",value:function(e,t,n){var i=Math.abs(n.x-t.x),r=Math.abs(n.y-t.y),s=-1;if(e.equals(t))s=0;else if(e.equals(n))s=i>r?i:r;else{var o=Math.abs(e.x-t.x),a=Math.abs(e.y-t.y);0!==(s=i>r?o:a)||e.equals(t)||(s=Math.max(o,a))}return Q.isTrue(!(0===s&&!e.equals(t)),"Bad distance calculation"),s}},{key:"nonRobustComputeEdgeDistance",value:function(e,t,n){var i=e.x-t.x,r=e.y-t.y,s=Math.sqrt(i*i+r*r);return Q.isTrue(!(0===s&&!e.equals(t)),"Invalid distance calculation"),s}},{key:"DONT_INTERSECT",get:function(){return 0}},{key:"DO_INTERSECT",get:function(){return 1}},{key:"COLLINEAR",get:function(){return 2}},{key:"NO_INTERSECTION",get:function(){return 0}},{key:"POINT_INTERSECTION",get:function(){return 1}},{key:"COLLINEAR_INTERSECTION",get:function(){return 2}}]),e}(),$=function(e){function t(){return _(this,t),k(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,Z),p(t,[{key:"isInSegmentEnvelopes",value:function(e){var t=new U(this._inputLines[0][0],this._inputLines[0][1]),n=new U(this._inputLines[1][0],this._inputLines[1][1]);return t.contains(e)&&n.contains(e)}},{key:"computeIntersection",value:function(){if(3!==arguments.length)return Z.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],t=arguments[1],n=arguments[2];if(this._isProper=!1,U.intersects(t,n,e)&&0===ne.orientationIndex(t,n,e)&&0===ne.orientationIndex(n,t,e))return this._isProper=!0,(e.equals(t)||e.equals(n))&&(this._isProper=!1),this._result=Z.POINT_INTERSECTION,null;this._result=Z.NO_INTERSECTION}},{key:"normalizeToMinimum",value:function(e,t,n,i,r){r.x=this.smallestInAbsValue(e.x,t.x,n.x,i.x),r.y=this.smallestInAbsValue(e.y,t.y,n.y,i.y),e.x-=r.x,e.y-=r.y,t.x-=r.x,t.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y}},{key:"safeHCoordinateIntersection",value:function(e,n,i,r){var s=null;try{s=V.intersection(e,n,i,r)}catch(o){if(!(o instanceof B))throw o;s=t.nearestEndpoint(e,n,i,r)}return s}},{key:"intersection",value:function(e,n,i,r){var s=this.intersectionWithNormalization(e,n,i,r);return this.isInSegmentEnvelopes(s)||(s=new L(t.nearestEndpoint(e,n,i,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(s),s}},{key:"smallestInAbsValue",value:function(e,t,n,i){var r=e,s=Math.abs(r);return Math.abs(t)<s&&(r=t,s=Math.abs(t)),Math.abs(n)<s&&(r=n,s=Math.abs(n)),Math.abs(i)<s&&(r=i),r}},{key:"checkDD",value:function(e,t,n,i,r){var s=F.intersection(e,t,n,i),o=this.isInSegmentEnvelopes(s);z.out.println("DD in env = "+o+"  --------------------- "+s),r.distance(s)>1e-4&&z.out.println("Distance = "+r.distance(s))}},{key:"intersectionWithNormalization",value:function(e,t,n,i){var r=new L(e),s=new L(t),o=new L(n),a=new L(i),u=new L;this.normalizeToEnvCentre(r,s,o,a,u);var l=this.safeHCoordinateIntersection(r,s,o,a);return l.x+=u.x,l.y+=u.y,l}},{key:"computeCollinearIntersection",value:function(e,t,n,i){var r=U.intersects(e,t,n),s=U.intersects(e,t,i),o=U.intersects(n,i,e),a=U.intersects(n,i,t);return r&&s?(this._intPt[0]=n,this._intPt[1]=i,Z.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=e,this._intPt[1]=t,Z.COLLINEAR_INTERSECTION):r&&o?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||s||a?Z.COLLINEAR_INTERSECTION:Z.POINT_INTERSECTION):r&&a?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||s||o?Z.COLLINEAR_INTERSECTION:Z.POINT_INTERSECTION):s&&o?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||r||a?Z.COLLINEAR_INTERSECTION:Z.POINT_INTERSECTION):s&&a?(this._intPt[0]=i,this._intPt[1]=t,!i.equals(t)||r||o?Z.COLLINEAR_INTERSECTION:Z.POINT_INTERSECTION):Z.NO_INTERSECTION}},{key:"normalizeToEnvCentre",value:function(e,t,n,i,r){var s=e.x<t.x?e.x:t.x,o=e.y<t.y?e.y:t.y,a=e.x>t.x?e.x:t.x,u=e.y>t.y?e.y:t.y,l=n.x<i.x?n.x:i.x,h=n.y<i.y?n.y:i.y,c=n.x>i.x?n.x:i.x,f=n.y>i.y?n.y:i.y,g=((s>l?s:l)+(a<c?a:c))/2,y=((o>h?o:h)+(u<f?u:f))/2;r.x=g,r.y=y,e.x-=r.x,e.y-=r.y,t.x-=r.x,t.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y}},{key:"computeIntersect",value:function(e,t,n,i){if(this._isProper=!1,!U.intersects(e,t,n,i))return Z.NO_INTERSECTION;var r=ne.orientationIndex(e,t,n),s=ne.orientationIndex(e,t,i);if(r>0&&s>0||r<0&&s<0)return Z.NO_INTERSECTION;var o=ne.orientationIndex(n,i,e),a=ne.orientationIndex(n,i,t);if(o>0&&a>0||o<0&&a<0)return Z.NO_INTERSECTION;return 0===r&&0===s&&0===o&&0===a?this.computeCollinearIntersection(e,t,n,i):(0===r||0===s||0===o||0===a?(this._isProper=!1,e.equals2D(n)||e.equals2D(i)?this._intPt[0]=e:t.equals2D(n)||t.equals2D(i)?this._intPt[0]=t:0===r?this._intPt[0]=new L(n):0===s?this._intPt[0]=new L(i):0===o?this._intPt[0]=new L(e):0===a&&(this._intPt[0]=new L(t))):(this._isProper=!0,this._intPt[0]=this.intersection(e,t,n,i)),Z.POINT_INTERSECTION)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}],[{key:"nearestEndpoint",value:function(e,t,n,i){var r=e,s=ne.distancePointLine(e,n,i),o=ne.distancePointLine(t,n,i);return o<s&&(s=o,r=t),(o=ne.distancePointLine(n,e,t))<s&&(s=o,r=n),(o=ne.distancePointLine(i,e,t))<s&&(s=o,r=i),r}}]),t}(),ee=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"orientationIndex",value:function(t,n,i){var r=n.x-t.x,s=n.y-t.y,o=i.x-n.x,a=i.y-n.y;return e.signOfDet2x2(r,s,o,a)}},{key:"signOfDet2x2",value:function(e,t,n,i){var r=null,s=null,o=null;if(r=1,0===e||0===i)return 0===t||0===n?0:t>0?n>0?-r:r:n>0?r:-r;if(0===t||0===n)return i>0?e>0?r:-r:e>0?-r:r;if(t>0?i>0?t<=i||(r=-r,s=e,e=n,n=s,s=t,t=i,i=s):t<=-i?(r=-r,n=-n,i=-i):(s=e,e=-n,n=s,s=t,t=-i,i=s):i>0?-t<=i?(r=-r,e=-e,t=-t):(s=-e,e=n,n=s,s=-t,t=i,i=s):t>=i?(e=-e,t=-t,n=-n,i=-i):(r=-r,s=-e,e=-n,n=s,s=-t,t=-i,i=s),e>0){if(!(n>0))return r;if(!(e<=n))return r}else{if(n>0)return-r;if(!(e>=n))return-r;r=-r,e=-e,n=-n}for(;;){if(o=Math.floor(n/e),n-=o*e,(i-=o*t)<0)return-r;if(i>t)return r;if(e>n+n){if(t<i+i)return r}else{if(t>i+i)return-r;n=e-n,i=t-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if(o=Math.floor(e/n),e-=o*n,(t-=o*i)<0)return r;if(t>i)return-r;if(n>e+e){if(i<t+t)return-r}else{if(i>t+t)return r;e=n-e,t=i-t,r=-r}if(0===t)return 0===e?0:r;if(0===e)return-r}}}]),e}(),te=function(){function e(){_(this,e),this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t}return p(e,[{key:"countSegment",value:function(e,t){if(e.x<this._p.x&&t.x<this._p.x)return null;if(this._p.x===t.x&&this._p.y===t.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&t.y===this._p.y){var n=e.x,i=t.x;return n>i&&(n=t.x,i=e.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&t.y<=this._p.y||t.y>this._p.y&&e.y<=this._p.y){var r=e.x-this._p.x,s=e.y-this._p.y,o=t.x-this._p.x,a=t.y-this._p.y,u=ee.signOfDet2x2(r,s,o,a);if(0===u)return this._isPointOnSegment=!0,null;a<s&&(u=-u),u>0&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==O.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?O.BOUNDARY:this._crossingCount%2==1?O.INTERIOR:O.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"locatePointInRing",value:function(){if(arguments[0]instanceof L&&R(arguments[1],G)){for(var t=arguments[0],n=arguments[1],i=new e(t),r=new L,s=new L,o=1;o<n.size();o++)if(n.getCoordinate(o,r),n.getCoordinate(o-1,s),i.countSegment(r,s),i.isOnSegment())return i.getLocation();return i.getLocation()}if(arguments[0]instanceof L&&arguments[1]instanceof Array){for(var a=arguments[0],u=arguments[1],l=new e(a),h=1;h<u.length;h++){var c=u[h],f=u[h-1];if(l.countSegment(c,f),l.isOnSegment())return l.getLocation()}return l.getLocation()}}}]),e}(),ne=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"orientationIndex",value:function(e,t,n){return F.orientationIndex(e,t,n)}},{key:"signedArea",value:function(){if(arguments[0]instanceof Array){var e=arguments[0];if(e.length<3)return 0;for(var t=0,n=e[0].x,i=1;i<e.length-1;i++){var r=e[i].x-n,s=e[i+1].y;t+=r*(e[i-1].y-s)}return t/2}if(R(arguments[0],G)){var o=arguments[0],a=o.size();if(a<3)return 0;var u=new L,l=new L,h=new L;o.getCoordinate(0,l),o.getCoordinate(1,h);var c=l.x;h.x-=c;for(var f=0,g=1;g<a-1;g++)u.y=l.y,l.x=h.x,l.y=h.y,o.getCoordinate(g+1,h),h.x-=c,f+=l.x*(u.y-h.y);return f/2}}},{key:"distanceLineLine",value:function(t,n,i,r){if(t.equals(n))return e.distancePointLine(t,i,r);if(i.equals(r))return e.distancePointLine(r,t,n);var s=!1;if(U.intersects(t,n,i,r)){var o=(n.x-t.x)*(r.y-i.y)-(n.y-t.y)*(r.x-i.x);if(0===o)s=!0;else{var a=(t.y-i.y)*(r.x-i.x)-(t.x-i.x)*(r.y-i.y),u=((t.y-i.y)*(n.x-t.x)-(t.x-i.x)*(n.y-t.y))/o,l=a/o;(l<0||l>1||u<0||u>1)&&(s=!0)}}else s=!0;return s?T.min(e.distancePointLine(t,i,r),e.distancePointLine(n,i,r),e.distancePointLine(i,t,n),e.distancePointLine(r,t,n)):0}},{key:"isPointInRing",value:function(t,n){return e.locatePointInRing(t,n)!==O.EXTERIOR}},{key:"computeLength",value:function(e){var t=e.size();if(t<=1)return 0;var n=0,i=new L;e.getCoordinate(0,i);for(var r=i.x,s=i.y,o=1;o<t;o++){e.getCoordinate(o,i);var a=i.x,u=i.y,l=a-r,h=u-s;n+=Math.sqrt(l*l+h*h),r=a,s=u}return n}},{key:"isCCW",value:function(t){var n=t.length-1;if(n<3)throw new x("Ring has fewer than 4 points, so orientation cannot be determined");for(var i=t[0],r=0,s=1;s<=n;s++){var o=t[s];o.y>i.y&&(i=o,r=s)}var a=r;do{(a-=1)<0&&(a=n)}while(t[a].equals2D(i)&&a!==r);var u=r;do{u=(u+1)%n}while(t[u].equals2D(i)&&u!==r);var l=t[a],h=t[u];if(l.equals2D(i)||h.equals2D(i)||l.equals2D(h))return!1;var c=e.computeOrientation(l,i,h),f=!1;return f=0===c?l.x>h.x:c>0,f}},{key:"locatePointInRing",value:function(e,t){return te.locatePointInRing(e,t)}},{key:"distancePointLinePerpendicular",value:function(e,t,n){var i=(n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y),r=((t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y))/i;return Math.abs(r)*Math.sqrt(i)}},{key:"computeOrientation",value:function(t,n,i){return e.orientationIndex(t,n,i)}},{key:"distancePointLine",value:function(){if(2===arguments.length){var t=arguments[0],n=arguments[1];if(0===n.length)throw new x("Line array must contain at least one vertex");for(var i=t.distance(n[0]),r=0;r<n.length-1;r++){var s=e.distancePointLine(t,n[r],n[r+1]);s<i&&(i=s)}return i}if(3===arguments.length){var o=arguments[0],a=arguments[1],u=arguments[2];if(a.x===u.x&&a.y===u.y)return o.distance(a);var l=(u.x-a.x)*(u.x-a.x)+(u.y-a.y)*(u.y-a.y),h=((o.x-a.x)*(u.x-a.x)+(o.y-a.y)*(u.y-a.y))/l;if(h<=0)return o.distance(a);if(h>=1)return o.distance(u);var c=((a.y-o.y)*(u.x-a.x)-(a.x-o.x)*(u.y-a.y))/l;return Math.abs(c)*Math.sqrt(l)}}},{key:"isOnLine",value:function(e,t){for(var n=new $,i=1;i<t.length;i++){var r=t[i-1],s=t[i];if(n.computeIntersection(e,r,s),n.hasIntersection())return!0}return!1}},{key:"CLOCKWISE",get:function(){return-1}},{key:"RIGHT",get:function(){return e.CLOCKWISE}},{key:"COUNTERCLOCKWISE",get:function(){return 1}},{key:"LEFT",get:function(){return e.COUNTERCLOCKWISE}},{key:"COLLINEAR",get:function(){return 0}},{key:"STRAIGHT",get:function(){return e.COLLINEAR}}]),e}(),ie=function(){function e(){_(this,e)}return p(e,[{key:"filter",value:function(e){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),re=function(){function e(){_(this,e);var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()}return p(e,[{key:"isGeometryCollection",value:function(){return this.getSortIndex()===e.SORTINDEX_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(e){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equals",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var n=arguments[0];if(!(n instanceof e))return!1;var i=n;return this.equalsExact(i)}}},{key:"equalsExact",value:function(e){return this===e||this.equalsExact(e,0)}},{key:"geometryChanged",value:function(){this.apply(e.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(e){return null!==e&&this.norm().equalsExact(e.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){if(1===arguments.length){var e=arguments[0],t=e;return this.getSortIndex()!==t.getSortIndex()?this.getSortIndex()-t.getSortIndex():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,i)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(t){if(t.getSortIndex()===e.SORTINDEX_GEOMETRYCOLLECTION)throw new x("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(e,t,n){return 0===n?e.equals(t):e.distance(t)<=n}},{key:"norm",value:function(){var e=this.copy();return e.normalize(),e}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new U(this._envelope)}},{key:"setSRID",value:function(e){this._SRID=e}},{key:"setUserData",value:function(e){this._userData=e}},{key:"compare",value:function(e,t){for(var n=e.iterator(),i=t.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),s=i.next(),o=r.compareTo(s);if(0!==o)return o}return n.hasNext()?1:i.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getSortIndex()===e.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===e.SORTINDEX_MULTIPOINT||this.getSortIndex()===e.SORTINDEX_MULTILINESTRING||this.getSortIndex()===e.SORTINDEX_MULTIPOLYGON}},{key:"interfaces_",value:function(){return[C,N,t]}},{key:"getClass",value:function(){return e}}],[{key:"hasNonEmptyElements",value:function(e){for(var t=0;t<e.length;t++)if(!e[t].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(e){for(var t=0;t<e.length;t++)if(null===e[t])return!0;return!1}},{key:"serialVersionUID",get:function(){return 0x799ea46522854c00}},{key:"SORTINDEX_POINT",get:function(){return 0}},{key:"SORTINDEX_MULTIPOINT",get:function(){return 1}},{key:"SORTINDEX_LINESTRING",get:function(){return 2}},{key:"SORTINDEX_LINEARRING",get:function(){return 3}},{key:"SORTINDEX_MULTILINESTRING",get:function(){return 4}},{key:"SORTINDEX_POLYGON",get:function(){return 5}},{key:"SORTINDEX_MULTIPOLYGON",get:function(){return 6}},{key:"SORTINDEX_GEOMETRYCOLLECTION",get:function(){return 7}},{key:"geometryChangedFilter",get:function(){return se}}]),e}(),se=function(){function e(){_(this,e)}return p(e,null,[{key:"interfaces_",value:function(){return[ie]}},{key:"filter",value:function(e){e.geometryChangedAction()}}]),e}(),oe=function(){function e(){_(this,e)}return p(e,[{key:"filter",value:function(e){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),ae=function(){function e(){_(this,e)}return p(e,[{key:"isInBoundary",value:function(e){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"Mod2BoundaryNodeRule",get:function(){return ue}},{key:"EndPointBoundaryNodeRule",get:function(){return le}},{key:"MultiValentEndPointBoundaryNodeRule",get:function(){return he}},{key:"MonoValentEndPointBoundaryNodeRule",get:function(){return ce}},{key:"MOD2_BOUNDARY_RULE",get:function(){return new ue}},{key:"ENDPOINT_BOUNDARY_RULE",get:function(){return new le}},{key:"MULTIVALENT_ENDPOINT_BOUNDARY_RULE",get:function(){return new he}},{key:"MONOVALENT_ENDPOINT_BOUNDARY_RULE",get:function(){return new ce}},{key:"OGC_SFS_BOUNDARY_RULE",get:function(){return e.MOD2_BOUNDARY_RULE}}]),e}(),ue=function(){function e(){_(this,e)}return p(e,[{key:"isInBoundary",value:function(e){return e%2==1}},{key:"interfaces_",value:function(){return[ae]}},{key:"getClass",value:function(){return e}}]),e}(),le=function(){function e(){_(this,e)}return p(e,[{key:"isInBoundary",value:function(e){return e>0}},{key:"interfaces_",value:function(){return[ae]}},{key:"getClass",value:function(){return e}}]),e}(),he=function(){function e(){_(this,e)}return p(e,[{key:"isInBoundary",value:function(e){return e>1}},{key:"interfaces_",value:function(){return[ae]}},{key:"getClass",value:function(){return e}}]),e}(),ce=function(){function e(){_(this,e)}return p(e,[{key:"isInBoundary",value:function(e){return 1===e}},{key:"interfaces_",value:function(){return[ae]}},{key:"getClass",value:function(){return e}}]),e}(),fe=function(){function e(){_(this,e)}return p(e,[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}]),e}(),ge=function(e){function t(e){_(this,t);var n=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.message=e||"",n}return m(t,e),p(t,null,[{key:"name",get:function(){return"IndexOutOfBoundsException"}}]),t}(Error),ye=function(){function e(){_(this,e)}return p(e,[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}]),e}(),ve=function(e){function t(){return _(this,t),k(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,fe),p(t,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}]),t}();(n.prototype=new Error).name="NoSuchElementException";var de=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.array_=[],arguments[0]instanceof fe&&e.addAll(arguments[0]),e}return m(t,ve),p(t,[{key:"ensureCapacity",value:function(){}},{key:"interfaces_",value:function(){return[ve,fe]}},{key:"add",value:function(e){return 1===arguments.length?this.array_.push(e):this.array_.splice(arguments[0],arguments[1]),!0}},{key:"clear",value:function(){this.array_=[]}},{key:"addAll",value:function(e){for(var t=e.iterator();t.hasNext();)this.add(t.next());return!0}},{key:"set",value:function(e,t){var n=this.array_[e];return this.array_[e]=t,n}},{key:"iterator",value:function(){return new _e(this)}},{key:"get",value:function(e){if(e<0||e>=this.size())throw new ge;return this.array_[e]}},{key:"isEmpty",value:function(){return 0===this.array_.length}},{key:"size",value:function(){return this.array_.length}},{key:"toArray",value:function(){for(var e=[],t=0,n=this.array_.length;t<n;t++)e.push(this.array_[t]);return e}},{key:"remove",value:function(e){for(var t=!1,n=0,i=this.array_.length;n<i;n++)if(this.array_[n]===e){this.array_.splice(n,1),t=!0;break}return t}}]),t}(),_e=function(e){function t(e){_(this,t);var n=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.arrayList_=e,n.position_=0,n}return m(t,ye),p(t,[{key:"next",value:function(){if(this.position_===this.arrayList_.size())throw new n;return this.arrayList_.get(this.position_++)}},{key:"hasNext",value:function(){return this.position_<this.arrayList_.size()}},{key:"set",value:function(e){return this.arrayList_.set(this.position_-1,e)}},{key:"remove",value:function(){this.arrayList_.remove(this.arrayList_.get(this.position_))}}]),t}(),pe=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(0===arguments.length);else if(1===arguments.length){var n=arguments[0];e.ensureCapacity(n.length),e.add(n,!0)}else if(2===arguments.length){var i=arguments[0],r=arguments[1];e.ensureCapacity(i.length),e.add(i,r)}return e}return m(t,de),p(t,[{key:"getCoordinate",value:function(e){return this.get(e)}},{key:"addAll",value:function(){if(2===arguments.length){for(var e=arguments[0],t=arguments[1],n=!1,i=e.iterator();i.hasNext();)this.add(i.next(),t),n=!0;return n}return de.prototype.addAll.apply(this,arguments)}},{key:"clone",value:function(){for(var e=de.prototype.clone.call(this),t=0;t<this.size();t++)e.add(t,this.get(t).copy());return e}},{key:"toCoordinateArray",value:function(){return this.toArray(t.coordArrayType)}},{key:"add",value:function(){if(1===arguments.length){var e=arguments[0];de.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var t=arguments[0],n=arguments[1];return this.add(t,n,!0),!0}if(arguments[0]instanceof L&&"boolean"==typeof arguments[1]){var i=arguments[0];if(!arguments[1]&&this.size()>=1){if(this.get(this.size()-1).equals2D(i))return null}de.prototype.add.call(this,i)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var r=arguments[0],s=arguments[1];return this.add(r,s),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var o=arguments[0],a=arguments[1];if(arguments[2])for(var u=0;u<o.length;u++)this.add(o[u],a);else for(var l=o.length-1;l>=0;l--)this.add(o[l],a);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof L){var h=arguments[0],c=arguments[1];if(!arguments[2]){var f=this.size();if(f>0){if(h>0){if(this.get(h-1).equals2D(c))return null}if(h<f){if(this.get(h).equals2D(c))return null}}}de.prototype.add.call(this,h,c)}}else if(4===arguments.length){var g=arguments[0],y=arguments[1],v=arguments[2],d=arguments[3],_=1;v>d&&(_=-1);for(var p=v;p!==d;p+=_)this.add(g[p],y);return!0}}},{key:"closeRing",value:function(){this.size()>0&&this.add(new L(this.get(0)),!1)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}],[{key:"coordArrayType",get:function(){return new Array(0).fill(null)}}]),t}(),me=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"isRing",value:function(e){return!(e.length<4)&&!!e[0].equals2D(e[e.length-1])}},{key:"ptNotInList",value:function(t,n){for(var i=0;i<t.length;i++){var r=t[i];if(e.indexOf(r,n)<0)return r}return null}},{key:"scroll",value:function(t,n){var i=e.indexOf(n,t);if(i<0)return null;var r=new Array(t.length).fill(null);z.arraycopy(t,i,r,0,t.length-i),z.arraycopy(t,0,r,t.length-i,i),z.arraycopy(r,0,t,0,t.length)}},{key:"equals",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];if(e===t)return!0;if(null===e||null===t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].equals(t[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var o=0;o<i.length;o++)if(0!==s.compare(i[o],r[o]))return!1;return!0}}},{key:"intersection",value:function(e,t){for(var n=new pe,i=0;i<e.length;i++)t.intersects(e[i])&&n.add(e[i],!0);return n.toCoordinateArray()}},{key:"hasRepeatedPoints",value:function(e){for(var t=1;t<e.length;t++)if(e[t-1].equals(e[t]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(t){if(!e.hasRepeatedPoints(t))return t;return new pe(t,!1).toCoordinateArray()}},{key:"reverse",value:function(e){for(var t=e.length-1,n=Math.trunc(t/2),i=0;i<=n;i++){var r=e[i];e[i]=e[t-i],e[t-i]=r}}},{key:"removeNull",value:function(e){for(var t=0,n=0;n<e.length;n++)null!==e[n]&&t++;var i=new Array(t).fill(null);if(0===t)return i;for(var r=0,s=0;s<e.length;s++)null!==e[s]&&(i[r++]=e[s]);return i}},{key:"copyDeep",value:function(){if(1===arguments.length){for(var e=arguments[0],t=new Array(e.length).fill(null),n=0;n<e.length;n++)t[n]=new L(e[n]);return t}if(5===arguments.length)for(var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4],u=0;u<a;u++)s[o+u]=new L(i[r+u])}},{key:"isEqualReversed",value:function(e,t){for(var n=0;n<e.length;n++){var i=e[n],r=t[e.length-n-1];if(0!==i.compareTo(r))return!1}return!0}},{key:"envelope",value:function(e){for(var t=new U,n=0;n<e.length;n++)t.expandToInclude(e[n]);return t}},{key:"toCoordinateArray",value:function(t){return t.toArray(e.coordArrayType)}},{key:"atLeastNCoordinatesOrNothing",value:function(e,t){return t.length>=e?t:[]}},{key:"indexOf",value:function(e,t){for(var n=0;n<t.length;n++)if(e.equals(t[n]))return n;return-1}},{key:"increasingDirection",value:function(e){for(var t=0;t<Math.trunc(e.length/2);t++){var n=e.length-1-t,i=e[t].compareTo(e[n]);if(0!==i)return i}return 1}},{key:"compare",value:function(e,t){for(var n=0;n<e.length&&n<t.length;){var i=e[n].compareTo(t[n]);if(0!==i)return i;n++}return n<t.length?-1:n<e.length?1:0}},{key:"minCoordinate",value:function(e){for(var t=null,n=0;n<e.length;n++)(null===t||t.compareTo(e[n])>0)&&(t=e[n]);return t}},{key:"extract",value:function(e,t,n){t=T.clamp(t,0,e.length);var i=(n=T.clamp(n,-1,e.length))-t+1;n<0&&(i=0),t>=e.length&&(i=0),n<t&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var s=0,o=t;o<=n;o++)r[s++]=e[o];return r}},{key:"ForwardComparator",get:function(){return ke}},{key:"BidirectionalComparator",get:function(){return Ie}},{key:"coordArrayType",get:function(){return new Array(0).fill(null)}}]),e}(),ke=function(){function e(){_(this,e)}return p(e,[{key:"compare",value:function(e,t){var n=e,i=t;return me.compare(n,i)}},{key:"interfaces_",value:function(){return[S]}},{key:"getClass",value:function(){return e}}]),e}(),Ie=function(){function e(){_(this,e)}return p(e,[{key:"compare",value:function(e,t){var n=e,i=t;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=me.compare(n,i);return me.isEqualReversed(n,i)?0:r}},{key:"OLDcompare",value:function(e,t){var n=e,i=t;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=me.increasingDirection(n),s=me.increasingDirection(i),o=r>0?0:n.length-1,a=s>0?0:n.length-1,u=0;u<n.length;u++){var l=n[o].compareTo(i[a]);if(0!==l)return l;o+=r,a+=s}return 0}},{key:"interfaces_",value:function(){return[S]}},{key:"getClass",value:function(){return e}}]),e}(),xe=function(){function e(){_(this,e)}return p(e,[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}]),e}(),Ee=function(e){function t(){return _(this,t),k(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,xe),t}();(i.prototype=new Error).name="OperationNotSupported",(r.prototype=new fe).contains=function(){};var Ne=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.array_=[],arguments[0]instanceof fe&&e.addAll(arguments[0]),e}return m(t,r),p(t,[{key:"contains",value:function(e){for(var t=0,n=this.array_.length;t<n;t++){if(this.array_[t]===e)return!0}return!1}},{key:"add",value:function(e){return!this.contains(e)&&(this.array_.push(e),!0)}},{key:"addAll",value:function(e){for(var t=e.iterator();t.hasNext();)this.add(t.next());return!0}},{key:"remove",value:function(e){throw new Error}},{key:"size",value:function(){return this.array_.length}},{key:"isEmpty",value:function(){return 0===this.array_.length}},{key:"toArray",value:function(){for(var e=[],t=0,n=this.array_.length;t<n;t++)e.push(this.array_[t]);return e}},{key:"iterator",value:function(){return new Ce(this)}}]),t}(),Ce=function(e){function t(e){_(this,t);var n=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.hashSet_=e,n.position_=0,n}return m(t,ye),p(t,[{key:"next",value:function(){if(this.position_===this.hashSet_.size())throw new n;return this.hashSet_.array_[this.position_++]}},{key:"hasNext",value:function(){return this.position_<this.hashSet_.size()}},{key:"remove",value:function(){throw new i}}]),t}(),Se=0;(h.prototype=new Ee).get=function(e){for(var t=this.root_;null!==t;){var n=e.compareTo(t.key);if(n<0)t=t.left;else{if(!(n>0))return t.value;t=t.right}}return null},h.prototype.put=function(e,t){if(null===this.root_)return this.root_={key:e,value:t,left:null,right:null,parent:null,color:Se,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n=this.root_,i=void 0,r=void 0;do{if(i=n,(r=e.compareTo(n.key))<0)n=n.left;else{if(!(r>0)){var s=n.value;return n.value=t,s}n=n.right}}while(null!==n);var o={key:e,left:null,right:null,value:t,parent:i,color:Se,getValue:function(){return this.value},getKey:function(){return this.key}};return r<0?i.left=o:i.right=o,this.fixAfterInsertion(o),this.size_++,null},h.prototype.fixAfterInsertion=function(e){for(e.color=1;null!=e&&e!==this.root_&&1===e.parent.color;)if(o(e)===u(o(o(e)))){var t=l(o(o(e)));1===s(t)?(a(o(e),Se),a(t,Se),a(o(o(e)),1),e=o(o(e))):(e===l(o(e))&&(e=o(e),this.rotateLeft(e)),a(o(e),Se),a(o(o(e)),1),this.rotateRight(o(o(e))))}else{var n=u(o(o(e)));1===s(n)?(a(o(e),Se),a(n,Se),a(o(o(e)),1),e=o(o(e))):(e===u(o(e))&&(e=o(e),this.rotateRight(e)),a(o(e),Se),a(o(o(e)),1),this.rotateLeft(o(o(e))))}this.root_.color=Se},h.prototype.values=function(){var e=new de,t=this.getFirstEntry();if(null!==t)for(e.add(t.value);null!==(t=h.successor(t));)e.add(t.value);return e},h.prototype.entrySet=function(){var e=new Ne,t=this.getFirstEntry();if(null!==t)for(e.add(t);null!==(t=h.successor(t));)e.add(t);return e},h.prototype.rotateLeft=function(e){if(null!=e){var t=e.right;e.right=t.left,null!=t.left&&(t.left.parent=e),t.parent=e.parent,null===e.parent?this.root_=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}},h.prototype.rotateRight=function(e){if(null!=e){var t=e.left;e.left=t.right,null!=t.right&&(t.right.parent=e),t.parent=e.parent,null===e.parent?this.root_=t:e.parent.right===e?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}},h.prototype.getFirstEntry=function(){var e=this.root_;if(null!=e)for(;null!=e.left;)e=e.left;return e},h.successor=function(e){if(null===e)return null;if(null!==e.right){for(var t=e.right;null!==t.left;)t=t.left;return t}for(var n=e.parent,i=e;null!==n&&i===n.right;)i=n,n=n.parent;return n},h.prototype.size=function(){return this.size_};var Le=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}();c.prototype=new r,(f.prototype=new c).contains=function(e){for(var t=0,n=this.array_.length;t<n;t++){if(0===this.array_[t].compareTo(e))return!0}return!1},f.prototype.add=function(e){if(this.contains(e))return!1;for(var t=0,n=this.array_.length;t<n;t++){if(1===this.array_[t].compareTo(e))return this.array_.splice(t,0,e),!0}return this.array_.push(e),!0},f.prototype.addAll=function(e){for(var t=e.iterator();t.hasNext();)this.add(t.next());return!0},f.prototype.remove=function(e){throw new i},f.prototype.size=function(){return this.array_.length},f.prototype.isEmpty=function(){return 0===this.array_.length},f.prototype.toArray=function(){for(var e=[],t=0,n=this.array_.length;t<n;t++)e.push(this.array_[t]);return e},f.prototype.iterator=function(){return new we(this)};var we=function(e){this.treeSet_=e,this.position_=0};we.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new n;return this.treeSet_.array_[this.position_++]},we.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},we.prototype.remove=function(){throw new i};var Pe=function(){function e(){_(this,e)}return p(e,null,[{key:"sort",value:function(){var e=arguments[0],t=void 0,n=void 0,i=void 0,r=void 0;if(1===arguments.length)r=function(e,t){return e.compareTo(t)},e.sort(r);else if(2===arguments.length)i=arguments[1],r=function(e,t){return i.compare(e,t)},e.sort(r);else if(3===arguments.length){(n=e.slice(arguments[1],arguments[2])).sort();var s=e.slice(0,arguments[1]).concat(n,e.slice(arguments[2],e.length));for(e.splice(0,e.length),t=0;t<s.length;t++)e.push(s[t])}else if(4===arguments.length)for(n=e.slice(arguments[1],arguments[2]),i=arguments[3],r=function(e,t){return i.compare(e,t)},n.sort(r),s=e.slice(0,arguments[1]).concat(n,e.slice(arguments[2],e.length)),e.splice(0,e.length),t=0;t<s.length;t++)e.push(s[t])}},{key:"asList",value:function(e){for(var t=new de,n=0,i=e.length;n<i;n++)t.add(e[n]);return t}}]),e}(),Oe=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"toDimensionSymbol",value:function(t){switch(t){case e.FALSE:return e.SYM_FALSE;case e.TRUE:return e.SYM_TRUE;case e.DONTCARE:return e.SYM_DONTCARE;case e.P:return e.SYM_P;case e.L:return e.SYM_L;case e.A:return e.SYM_A}throw new x("Unknown dimension value: "+t)}},{key:"toDimensionValue",value:function(t){switch(M.toUpperCase(t)){case e.SYM_FALSE:return e.FALSE;case e.SYM_TRUE:return e.TRUE;case e.SYM_DONTCARE:return e.DONTCARE;case e.SYM_P:return e.P;case e.SYM_L:return e.L;case e.SYM_A:return e.A}throw new x("Unknown dimension symbol: "+t)}},{key:"P",get:function(){return 0}},{key:"L",get:function(){return 1}},{key:"A",get:function(){return 2}},{key:"FALSE",get:function(){return-1}},{key:"TRUE",get:function(){return-2}},{key:"DONTCARE",get:function(){return-3}},{key:"SYM_FALSE",get:function(){return"F"}},{key:"SYM_TRUE",get:function(){return"T"}},{key:"SYM_DONTCARE",get:function(){return"*"}},{key:"SYM_P",get:function(){return"0"}},{key:"SYM_L",get:function(){return"1"}},{key:"SYM_A",get:function(){return"2"}}]),e}(),Re=function(){function e(){_(this,e)}return p(e,[{key:"filter",value:function(e){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Te=function(){function e(){_(this,e)}return p(e,[{key:"filter",value:function(e,t){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),be=function(e){function t(e,n){_(this,t);var i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));if(i._geometries=e||[],re.hasNullElements(i._geometries))throw new x("geometries must not contain null elements");return i}return m(t,re),p(t,[{key:"computeEnvelopeInternal",value:function(){for(var e=new U,t=0;t<this._geometries.length;t++)e.expandToInclude(this._geometries[t].getEnvelopeInternal());return e}},{key:"getGeometryN",value:function(e){return this._geometries[e]}},{key:"getSortIndex",value:function(){return re.SORTINDEX_GEOMETRYCOLLECTION}},{key:"getCoordinates",value:function(){for(var e=new Array(this.getNumPoints()).fill(null),t=-1,n=0;n<this._geometries.length;n++)for(var i=this._geometries[n].getCoordinates(),r=0;r<i.length;r++)e[++t]=i[r];return e}},{key:"getArea",value:function(){for(var e=0,t=0;t<this._geometries.length;t++)e+=this._geometries[t].getArea();return e}},{key:"equalsExact",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];if(!this.isEquivalentClass(e))return!1;var n=e;if(this._geometries.length!==n._geometries.length)return!1;for(var i=0;i<this._geometries.length;i++)if(!this._geometries[i].equalsExact(n._geometries[i],t))return!1;return!0}return re.prototype.equalsExact.apply(this,arguments)}},{key:"normalize",value:function(){for(var e=0;e<this._geometries.length;e++)this._geometries[e].normalize();Pe.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var e=Oe.FALSE,t=0;t<this._geometries.length;t++)e=Math.max(e,this._geometries[t].getBoundaryDimension());return e}},{key:"getDimension",value:function(){for(var e=Oe.FALSE,t=0;t<this._geometries.length;t++)e=Math.max(e,this._geometries[t].getDimension());return e}},{key:"getLength",value:function(){for(var e=0,t=0;t<this._geometries.length;t++)e+=this._geometries[t].getLength();return e}},{key:"getNumPoints",value:function(){for(var e=0,t=0;t<this._geometries.length;t++)e+=this._geometries[t].getNumPoints();return e}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"reverse",value:function(){for(var e=this._geometries.length,t=new Array(e).fill(null),n=0;n<this._geometries.length;n++)t[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(t)}},{key:"compareToSameClass",value:function(){if(1===arguments.length){var e=arguments[0],t=new f(Pe.asList(this._geometries)),n=new f(Pe.asList(e._geometries));return this.compare(t,n)}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],s=i,o=this.getNumGeometries(),a=s.getNumGeometries(),u=0;u<o&&u<a;){var l=this.getGeometryN(u),h=s.getGeometryN(u),c=l.compareToSameClass(h,r);if(0!==c)return c;u++}return u<o?1:u<a?-1:0}}},{key:"apply",value:function(){if(R(arguments[0],oe))for(var e=arguments[0],t=0;t<this._geometries.length;t++)this._geometries[t].apply(e);else if(R(arguments[0],Te)){var n=arguments[0];if(0===this._geometries.length)return null;for(var i=0;i<this._geometries.length&&(this._geometries[i].apply(n),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(R(arguments[0],Re)){var r=arguments[0];r.filter(this);for(var s=0;s<this._geometries.length;s++)this._geometries[s].apply(r)}else if(R(arguments[0],ie)){var o=arguments[0];o.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(o)}}},{key:"getBoundary",value:function(){return this.checkNotGeometryCollection(this),Q.shouldNeverReachHere(),null}},{key:"clone",value:function(){var e=re.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var t=0;t<this._geometries.length;t++)e._geometries[t]=this._geometries[t].clone();return e}},{key:"getGeometryType",value:function(){return"GeometryCollection"}},{key:"copy",value:function(){for(var e=new Array(this._geometries.length).fill(null),n=0;n<e.length;n++)e[n]=this._geometries[n].copy();return new t(e,this._factory)}},{key:"isEmpty",value:function(){for(var e=0;e<this._geometries.length;e++)if(!this._geometries[e].isEmpty())return!1;return!0}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}],[{key:"serialVersionUID",get:function(){return-0x4f07bcb1f857d800}}]),t}(),De=function(e){function t(){return _(this,t),k(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,be),p(t,[{key:"getSortIndex",value:function(){return re.SORTINDEX_MULTILINESTRING}},{key:"equalsExact",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];return!!this.isEquivalentClass(e)&&be.prototype.equalsExact.call(this,e,t)}return be.prototype.equalsExact.apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?Oe.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var e=0;e<this._geometries.length;e++)if(!this._geometries[e].isClosed())return!1;return!0}},{key:"getDimension",value:function(){return 1}},{key:"reverse",value:function(){for(var e=this._geometries.length,t=new Array(e).fill(null),n=0;n<this._geometries.length;n++)t[e-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(t)}},{key:"getBoundary",value:function(){return new Me(this).getBoundary()}},{key:"getGeometryType",value:function(){return"MultiLineString"}},{key:"copy",value:function(){for(var e=new Array(this._geometries.length).fill(null),n=0;n<e.length;n++)e[n]=this._geometries[n].copy();return new t(e,this._factory)}},{key:"interfaces_",value:function(){return[Le]}},{key:"getClass",value:function(){return t}}],[{key:"serialVersionUID",get:function(){return 0x7155d2ab4afa8000}}]),t}(),Me=function(){function e(){if(_(this,e),this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],n=ae.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=n}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this._geom=i,this._geomFact=i.getFactory(),this._bnRule=r}}return p(e,[{key:"boundaryMultiLineString",value:function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var t=this.computeBoundaryCoordinates(e);return 1===t.length?this._geomFact.createPoint(t[0]):this._geomFact.createMultiPointFromCoords(t)}},{key:"getBoundary",value:function(){return this._geom instanceof qe?this.boundaryLineString(this._geom):this._geom instanceof De?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()}},{key:"boundaryLineString",value:function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();if(e.isClosed()){return this._bnRule.isInBoundary(2)?e.getStartPoint():this._geomFact.createMultiPoint()}return this._geomFact.createMultiPoint([e.getStartPoint(),e.getEndPoint()])}},{key:"getEmptyMultiPoint",value:function(){return this._geomFact.createMultiPoint()}},{key:"computeBoundaryCoordinates",value:function(e){var t=new de;this._endpointMap=new h;for(var n=0;n<e.getNumGeometries();n++){var i=e.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var s=r.next(),o=s.getValue().count;this._bnRule.isInBoundary(o)&&t.add(s.getKey())}return me.toCoordinateArray(t)}},{key:"addEndpoint",value:function(e){var t=this._endpointMap.get(e);null===t&&(t=new Ae,this._endpointMap.put(e,t)),t.count++}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"getBoundary",value:function(){if(1===arguments.length){return new e(arguments[0]).getBoundary()}if(2===arguments.length){return new e(arguments[0],arguments[1]).getBoundary()}}}]),e}(),Ae=function(){function e(){_(this,e),this.count=null}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Fe=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"chars",value:function(e,t){for(var n=new Array(t).fill(null),i=0;i<t;i++)n[i]=e;return String(n)}},{key:"getStackTrace",value:function(){if(1===arguments.length){var t=arguments[0],n=new function(){},i=new function(){}(n);return t.printStackTrace(i),n.toString()}if(2===arguments.length){for(var r=arguments[0],s=arguments[1],o="",a=new function(){}(new function(){}(e.getStackTrace(r))),u=0;u<s;u++)try{o+=a.readLine()+e.NEWLINE}catch(e){if(!(e instanceof g))throw e;Q.shouldNeverReachHere()}return o}}},{key:"split",value:function(e,t){for(var n=t.length,i=new de,r=""+e,s=r.indexOf(t);s>=0;){var o=r.substring(0,s);i.add(o),s=(r=r.substring(s+n)).indexOf(t)}r.length>0&&i.add(r);for(var a=new Array(i.size()).fill(null),u=0;u<a.length;u++)a[u]=i.get(u);return a}},{key:"toString",value:function(){if(1===arguments.length){var t=arguments[0];return e.SIMPLE_ORDINATE_FORMAT.format(t)}}},{key:"spaces",value:function(t){return e.chars(" ",t)}},{key:"NEWLINE",get:function(){return z.getProperty("line.separator")}},{key:"SIMPLE_ORDINATE_FORMAT",get:function(){return new function e(){_(this,e)}("0.#")}}]),e}(),Ge=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"copyCoord",value:function(e,t,n,i){for(var r=Math.min(e.getDimension(),n.getDimension()),s=0;s<r;s++)n.setOrdinate(i,s,e.getOrdinate(t,s))}},{key:"isRing",value:function(e){var t=e.size();return 0===t||!(t<=3)&&(e.getOrdinate(0,G.X)===e.getOrdinate(t-1,G.X)&&e.getOrdinate(0,G.Y)===e.getOrdinate(t-1,G.Y))}},{key:"isEqual",value:function(e,t){var n=e.size();if(n!==t.size())return!1;for(var i=Math.min(e.getDimension(),t.getDimension()),r=0;r<n;r++)for(var s=0;s<i;s++){var o=e.getOrdinate(r,s),a=t.getOrdinate(r,s);if(e.getOrdinate(r,s)!==t.getOrdinate(r,s)&&(!E.isNaN(o)||!E.isNaN(a)))return!1}return!0}},{key:"extend",value:function(t,n,i){var r=t.create(i,n.getDimension()),s=n.size();if(e.copy(n,0,r,0,s),s>0)for(var o=s;o<i;o++)e.copy(n,s-1,r,o,1);return r}},{key:"reverse",value:function(t){for(var n=t.size()-1,i=Math.trunc(n/2),r=0;r<=i;r++)e.swap(t,r,n-r)}},{key:"swap",value:function(e,t,n){if(t===n)return null;for(var i=0;i<e.getDimension();i++){var r=e.getOrdinate(t,i);e.setOrdinate(t,i,e.getOrdinate(n,i)),e.setOrdinate(n,i,r)}}},{key:"copy",value:function(t,n,i,r,s){for(var o=0;o<s;o++)e.copyCoord(t,n+o,i,r+o)}},{key:"toString",value:function(){if(1===arguments.length){var e=arguments[0],t=e.size();if(0===t)return"()";var n=e.getDimension(),i=new b;i.append("(");for(var r=0;r<t;r++){r>0&&i.append(" ");for(var s=0;s<n;s++)s>0&&i.append(","),i.append(Fe.toString(e.getOrdinate(r,s)))}return i.append(")"),i.toString()}}},{key:"ensureValidRing",value:function(t,n){var i=n.size();if(0===i)return n;if(i<=3)return e.createClosedRing(t,n,4);return n.getOrdinate(0,G.X)===n.getOrdinate(i-1,G.X)&&n.getOrdinate(0,G.Y)===n.getOrdinate(i-1,G.Y)?n:e.createClosedRing(t,n,i+1)}},{key:"createClosedRing",value:function(t,n,i){var r=t.create(i,n.getDimension()),s=n.size();e.copy(n,0,r,0,s);for(var o=s;o<i;o++)e.copy(n,0,r,o,1);return r}}]),e}(),qe=function(e){function t(e,n){_(this,t);var i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i._points=null,i.init(e),i}return m(t,re),p(t,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new U:this._points.expandEnvelope(new U)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getSortIndex",value:function(){return re.SORTINDEX_LINESTRING}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"equalsExact",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];if(!this.isEquivalentClass(e))return!1;var n=e;if(this._points.size()!==n._points.size())return!1;for(var i=0;i<this._points.size();i++)if(!this.equal(this._points.getCoordinate(i),n._points.getCoordinate(i),t))return!1;return!0}return re.prototype.equalsExact.apply(this,arguments)}},{key:"normalize",value:function(){for(var e=0;e<Math.trunc(this._points.size()/2);e++){var t=this._points.size()-1-e;if(!this._points.getCoordinate(e).equals(this._points.getCoordinate(t)))return this._points.getCoordinate(e).compareTo(this._points.getCoordinate(t))>0&&Ge.reverse(this._points),null}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?Oe.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return ne.computeLength(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"reverse",value:function(){var e=this._points.copy();Ge.reverse(e);return this.getFactory().createLineString(e)}},{key:"compareToSameClass",value:function(){if(1===arguments.length){for(var e=arguments[0],t=0,n=0;t<this._points.size()&&n<e._points.size();){var i=this._points.getCoordinate(t).compareTo(e._points.getCoordinate(n));if(0!==i)return i;t++,n++}return t<this._points.size()?1:n<e._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}}},{key:"apply",value:function(){if(R(arguments[0],oe))for(var e=arguments[0],t=0;t<this._points.size();t++)e.filter(this._points.getCoordinate(t));else if(R(arguments[0],Te)){var n=arguments[0];if(0===this._points.size())return null;for(var i=0;i<this._points.size()&&(n.filter(this._points,i),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(R(arguments[0],Re)){arguments[0].filter(this)}else if(R(arguments[0],ie)){arguments[0].filter(this)}}},{key:"getBoundary",value:function(){return new Me(this).getBoundary()}},{key:"isEquivalentClass",value:function(e){return e instanceof t}},{key:"clone",value:function(){var e=re.prototype.clone.call(this);return e._points=this._points.clone(),e}},{key:"getCoordinateN",value:function(e){return this._points.getCoordinate(e)}},{key:"getGeometryType",value:function(){return"LineString"}},{key:"copy",value:function(){return new t(this._points.copy(),this._factory)}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return 0===this._points.size()}},{key:"init",value:function(e){if(null===e&&(e=this.getFactory().getCoordinateSequenceFactory().create([])),1===e.size())throw new x("Invalid number of points in LineString (found "+e.size()+" - must be 0 or >= 2)");this._points=e}},{key:"isCoordinate",value:function(e){for(var t=0;t<this._points.size();t++)if(this._points.getCoordinate(t).equals(e))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(e){return this.getFactory().createPoint(this._points.getCoordinate(e))}},{key:"interfaces_",value:function(){return[Le]}},{key:"getClass",value:function(){return t}}],[{key:"serialVersionUID",get:function(){return 0x2b2b51ba435c8e00}}]),t}(),Be=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),ze=function(e){function t(e,n){_(this,t);var i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return i._coordinates=e||null,i.init(i._coordinates),i}return m(t,re),p(t,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new U;var e=new U;return e.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),e}},{key:"getSortIndex",value:function(){return re.SORTINDEX_POINT}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"equalsExact",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),t))}return re.prototype.equalsExact.apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return Oe.FALSE}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"reverse",value:function(){return this.copy()}},{key:"getX",value:function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(1===arguments.length){var e=arguments[0];return this.getCoordinate().compareTo(e.getCoordinate())}if(2===arguments.length){var t=arguments[0];return arguments[1].compare(this._coordinates,t._coordinates)}}},{key:"apply",value:function(){if(R(arguments[0],oe)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this.getCoordinate())}else if(R(arguments[0],Te)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this._coordinates,0),t.isGeometryChanged()&&this.geometryChanged()}else if(R(arguments[0],Re)){arguments[0].filter(this)}else if(R(arguments[0],ie)){arguments[0].filter(this)}}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection(null)}},{key:"clone",value:function(){var e=re.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e}},{key:"getGeometryType",value:function(){return"Point"}},{key:"copy",value:function(){return new t(this._coordinates.copy(),this._factory)}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return 0===this._coordinates.size()}},{key:"init",value:function(e){null===e&&(e=this.getFactory().getCoordinateSequenceFactory().create([])),Q.isTrue(e.size()<=1),this._coordinates=e}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",value:function(){return[Be]}},{key:"getClass",value:function(){return t}}],[{key:"serialVersionUID",get:function(){return 0x44077bad161cbc00}}]),t}(),Ve=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Ue=function(e){function t(e,n,i){_(this,t);var r=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i));if(r._shell=null,r._holes=null,null===e&&(e=r.getFactory().createLinearRing()),null===n&&(n=[]),re.hasNullElements(n))throw new x("holes must not contain null elements");if(e.isEmpty()&&re.hasNonEmptyElements(n))throw new x("shell is empty but holes are not");return r._shell=e,r._holes=n,r}return m(t,re),p(t,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getSortIndex",value:function(){return re.SORTINDEX_POLYGON}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var e=new Array(this.getNumPoints()).fill(null),t=-1,n=this._shell.getCoordinates(),i=0;i<n.length;i++)e[++t]=n[i];for(var r=0;r<this._holes.length;r++)for(var s=this._holes[r].getCoordinates(),o=0;o<s.length;o++)e[++t]=s[o];return e}},{key:"getArea",value:function(){var e=0;e+=Math.abs(ne.signedArea(this._shell.getCoordinateSequence()));for(var t=0;t<this._holes.length;t++)e-=Math.abs(ne.signedArea(this._holes[t].getCoordinateSequence()));return e}},{key:"isRectangle",value:function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var e=this._shell.getCoordinateSequence(),t=this.getEnvelopeInternal(),n=0;n<5;n++){var i=e.getX(n);if(i!==t.getMinX()&&i!==t.getMaxX())return!1;var r=e.getY(n);if(r!==t.getMinY()&&r!==t.getMaxY())return!1}for(var s=e.getX(0),o=e.getY(0),a=1;a<=4;a++){var u=e.getX(a),l=e.getY(a);if(u!==s===(l!==o))return!1;s=u,o=l}return!0}},{key:"equalsExact",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];if(!this.isEquivalentClass(e))return!1;var n=e,i=this._shell,r=n._shell;if(!i.equalsExact(r,t))return!1;if(this._holes.length!==n._holes.length)return!1;for(var s=0;s<this._holes.length;s++)if(!this._holes[s].equalsExact(n._holes[s],t))return!1;return!0}return re.prototype.equalsExact.apply(this,arguments)}},{key:"normalize",value:function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var e=0;e<this._holes.length;e++)this.normalize(this._holes[e],!1);Pe.sort(this._holes)}else if(2===arguments.length){var t=arguments[0],n=arguments[1];if(t.isEmpty())return null;var i=new Array(t.getCoordinates().length-1).fill(null);z.arraycopy(t.getCoordinates(),0,i,0,i.length);var r=me.minCoordinate(t.getCoordinates());me.scroll(i,r),z.arraycopy(i,0,t.getCoordinates(),0,i.length),t.getCoordinates()[i.length]=i[0],ne.isCCW(t.getCoordinates())===n&&me.reverse(t.getCoordinates())}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var e=0;e+=this._shell.getLength();for(var t=0;t<this._holes.length;t++)e+=this._holes[t].getLength();return e}},{key:"getNumPoints",value:function(){for(var e=this._shell.getNumPoints(),t=0;t<this._holes.length;t++)e+=this._holes[t].getNumPoints();return e}},{key:"reverse",value:function(){var e=this.copy();e._shell=this._shell.copy().reverse(),e._holes=new Array(this._holes.length).fill(null);for(var t=0;t<this._holes.length;t++)e._holes[t]=this._holes[t].copy().reverse();return e}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"compareToSameClass",value:function(){if(1===arguments.length){var e=arguments[0],t=this._shell,n=e._shell;return t.compareToSameClass(n)}if(2===arguments.length){var i=arguments[0],r=arguments[1],s=i,o=this._shell,a=s._shell,u=o.compareToSameClass(a,r);if(0!==u)return u;for(var l=this.getNumInteriorRing(),h=s.getNumInteriorRing(),c=0;c<l&&c<h;){var f=this.getInteriorRingN(c),g=s.getInteriorRingN(c),y=f.compareToSameClass(g,r);if(0!==y)return y;c++}return c<l?1:c<h?-1:0}}},{key:"apply",value:function(e){if(R(e,oe)){this._shell.apply(e);for(var t=0;t<this._holes.length;t++)this._holes[t].apply(e)}else if(R(e,Te)){if(this._shell.apply(e),!e.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(e),!e.isDone());n++);e.isGeometryChanged()&&this.geometryChanged()}else if(R(e,Re))e.filter(this);else if(R(e,ie)){e.filter(this),this._shell.apply(e);for(var i=0;i<this._holes.length;i++)this._holes[i].apply(e)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var e=new Array(this._holes.length+1).fill(null);e[0]=this._shell;for(var t=0;t<this._holes.length;t++)e[t+1]=this._holes[t];return e.length<=1?this.getFactory().createLinearRing(e[0].getCoordinateSequence()):this.getFactory().createMultiLineString(e)}},{key:"clone",value:function(){var e=re.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var t=0;t<this._holes.length;t++)e._holes[t]=this._holes[t].clone();return e}},{key:"getGeometryType",value:function(){return"Polygon"}},{key:"copy",value:function(){for(var e=this._shell.copy(),n=new Array(this._holes.length).fill(null),i=0;i<n.length;i++)n[i]=this._holes[i].copy();return new t(e,n,this._factory)}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(e){return this._holes[e]}},{key:"interfaces_",value:function(){return[Ve]}},{key:"getClass",value:function(){return t}}],[{key:"serialVersionUID",get:function(){return-0x307ffefd8dc97200}}]),t}(),Xe=function(e){function t(){return _(this,t),k(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,be),p(t,[{key:"getSortIndex",value:function(){return re.SORTINDEX_MULTIPOINT}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];return!!this.isEquivalentClass(e)&&be.prototype.equalsExact.call(this,e,t)}return be.prototype.equalsExact.apply(this,arguments)}},{key:"getCoordinate",value:function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return be.prototype.getCoordinate.apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return Oe.FALSE}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection(null)}},{key:"getGeometryType",value:function(){return"MultiPoint"}},{key:"copy",value:function(){for(var e=new Array(this._geometries.length).fill(null),n=0;n<e.length;n++)e[n]=this._geometries[n].copy();return new t(e,this._factory)}},{key:"interfaces_",value:function(){return[Be]}},{key:"getClass",value:function(){return t}}],[{key:"serialVersionUID",get:function(){return-0x6fb1ed4162e0fc00}}]),t}(),Ye=function(e){function t(e,n){_(this,t),e instanceof L&&n instanceof nt&&(e=n.getCoordinateSequenceFactory().create(e));var i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.validateConstruction(),i}return m(t,qe),p(t,[{key:"getSortIndex",value:function(){return re.SORTINDEX_LINEARRING}},{key:"getBoundaryDimension",value:function(){return Oe.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||qe.prototype.isClosed.call(this)}},{key:"reverse",value:function(){var e=this._points.copy();Ge.reverse(e);return this.getFactory().createLinearRing(e)}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!qe.prototype.isClosed.call(this))throw new x("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new x("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return"LinearRing"}},{key:"copy",value:function(){return new t(this._points.copy(),this._factory)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}],[{key:"MINIMUM_VALID_SIZE",get:function(){return 4}},{key:"serialVersionUID",get:function(){return-0x3b229e262367a600}}]),t}(),je=function(e){function t(){return _(this,t),k(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,be),p(t,[{key:"getSortIndex",value:function(){return re.SORTINDEX_MULTIPOLYGON}},{key:"equalsExact",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];return!!this.isEquivalentClass(e)&&be.prototype.equalsExact.call(this,e,t)}return be.prototype.equalsExact.apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getDimension",value:function(){return 2}},{key:"reverse",value:function(){for(var e=this._geometries.length,t=new Array(e).fill(null),n=0;n<this._geometries.length;n++)t[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(t)}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var e=new de,t=0;t<this._geometries.length;t++)for(var n=this._geometries[t].getBoundary(),i=0;i<n.getNumGeometries();i++)e.add(n.getGeometryN(i));var r=new Array(e.size()).fill(null);return this.getFactory().createMultiLineString(e.toArray(r))}},{key:"getGeometryType",value:function(){return"MultiPolygon"}},{key:"copy",value:function(){for(var e=new Array(this._geometries.length).fill(null),n=0;n<e.length;n++)e[n]=this._geometries[n].copy();return new t(e,this._factory)}},{key:"interfaces_",value:function(){return[Ve]}},{key:"getClass",value:function(){return t}}],[{key:"serialVersionUID",get:function(){return-0x7a5aa1369171980}}]),t}(),He=function(){function e(t){_(this,e),this._factory=t||null,this._isUserDataCopied=!1}return p(e,[{key:"setCopyUserData",value:function(e){this._isUserDataCopied=e}},{key:"edit",value:function(e,t){if(null===e)return null;var n=this.editInternal(e,t);return this._isUserDataCopied&&n.setUserData(e.getUserData()),n}},{key:"editInternal",value:function(e,t){return null===this._factory&&(this._factory=e.getFactory()),e instanceof be?this.editGeometryCollection(e,t):e instanceof Ue?this.editPolygon(e,t):e instanceof ze?t.edit(e,this._factory):e instanceof qe?t.edit(e,this._factory):(Q.shouldNeverReachHere("Unsupported Geometry class: "+e.getClass().getName()),null)}},{key:"editGeometryCollection",value:function(e,t){for(var n=t.edit(e,this._factory),i=new de,r=0;r<n.getNumGeometries();r++){var s=this.edit(n.getGeometryN(r),t);null===s||s.isEmpty()||i.add(s)}return n.getClass()===Xe?this._factory.createMultiPoint(i.toArray([])):n.getClass()===De?this._factory.createMultiLineString(i.toArray([])):n.getClass()===je?this._factory.createMultiPolygon(i.toArray([])):this._factory.createGeometryCollection(i.toArray([]))}},{key:"editPolygon",value:function(e,t){var n=t.edit(e,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),t);if(null===i||i.isEmpty())return this._factory.createPolygon();for(var r=new de,s=0;s<n.getNumInteriorRing();s++){var o=this.edit(n.getInteriorRingN(s),t);null===o||o.isEmpty()||r.add(o)}return this._factory.createPolygon(i,r.toArray([]))}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"GeometryEditorOperation",value:function(){}},{key:"NoOpGeometryOperation",get:function(){return We}},{key:"CoordinateOperation",get:function(){return Ke}},{key:"CoordinateSequenceOperation",get:function(){return Je}}]),e}(),We=function(){function e(){_(this,e)}return p(e,[{key:"edit",value:function(e,t){return e}},{key:"interfaces_",value:function(){return[He.GeometryEditorOperation]}},{key:"getClass",value:function(){return e}}]),e}(),Ke=function(){function e(){_(this,e)}return p(e,[{key:"edit",value:function(e,t){var n=this.editCoordinates(e.getCoordinates(),e);return null===n?e:e instanceof Ye?t.createLinearRing(n):e instanceof qe?t.createLineString(n):e instanceof ze?n.length>0?t.createPoint(n[0]):t.createPoint():e}},{key:"interfaces_",value:function(){return[He.GeometryEditorOperation]}},{key:"getClass",value:function(){return e}}]),e}(),Je=function(){function e(){_(this,e)}return p(e,[{key:"edit",value:function(e,t){return e instanceof Ye?t.createLinearRing(this.edit(e.getCoordinateSequence(),e)):e instanceof qe?t.createLineString(this.edit(e.getCoordinateSequence(),e)):e instanceof ze?t.createPoint(this.edit(e.getCoordinateSequence(),e)):e}},{key:"interfaces_",value:function(){return[He.GeometryEditorOperation]}},{key:"getClass",value:function(){return e}}]),e}(),Qe=function(){function e(){if(_(this,e),this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var n=0;n<t;n++)this._coordinates[n]=new L}else if(R(arguments[0],G)){var i=arguments[0];if(null===i)return this._coordinates=new Array(0).fill(null),null;this._dimension=i.getDimension(),this._coordinates=new Array(i.size()).fill(null);for(var r=0;r<this._coordinates.length;r++)this._coordinates[r]=i.getCoordinateCopy(r)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var s=arguments[0],o=arguments[1];this._coordinates=s,this._dimension=o,null===s&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var a=arguments[0],u=arguments[1];this._coordinates=new Array(a).fill(null),this._dimension=u;for(var l=0;l<a;l++)this._coordinates[l]=new L}}return p(e,[{key:"setOrdinate",value:function(e,t,n){switch(t){case G.X:this._coordinates[e].x=n;break;case G.Y:this._coordinates[e].y=n;break;case G.Z:this._coordinates[e].z=n;break;default:throw new x("invalid ordinateIndex")}}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(e,t){switch(t){case G.X:return this._coordinates[e].x;case G.Y:return this._coordinates[e].y;case G.Z:return this._coordinates[e].z}return E.NaN}},{key:"getCoordinate",value:function(){if(1===arguments.length){var e=arguments[0];return this._coordinates[e]}if(2===arguments.length){var t=arguments[0],n=arguments[1];n.x=this._coordinates[t].x,n.y=this._coordinates[t].y,n.z=this._coordinates[t].z}}},{key:"getCoordinateCopy",value:function(e){return new L(this._coordinates[e])}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(e){return this._coordinates[e].x}},{key:"clone",value:function(){for(var t=new Array(this.size()).fill(null),n=0;n<this._coordinates.length;n++)t[n]=this._coordinates[n].clone();return new e(t,this._dimension)}},{key:"expandEnvelope",value:function(e){for(var t=0;t<this._coordinates.length;t++)e.expandToInclude(this._coordinates[t]);return e}},{key:"copy",value:function(){for(var t=new Array(this.size()).fill(null),n=0;n<this._coordinates.length;n++)t[n]=this._coordinates[n].copy();return new e(t,this._dimension)}},{key:"toString",value:function(){if(this._coordinates.length>0){var e=new b(17*this._coordinates.length);e.append("("),e.append(this._coordinates[0]);for(var t=1;t<this._coordinates.length;t++)e.append(", "),e.append(this._coordinates[t]);return e.append(")"),e.toString()}return"()"}},{key:"getY",value:function(e){return this._coordinates[e].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",value:function(){return[G,t]}},{key:"getClass",value:function(){return e}}],[{key:"serialVersionUID",get:function(){return-0xcb44a778db18e00}}]),e}(),Ze=function(){function e(){_(this,e)}return p(e,[{key:"readResolve",value:function(){return e.instance()}},{key:"create",value:function(){if(1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];return new Qe(e)}if(R(arguments[0],G)){var t=arguments[0];return new Qe(t)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return i>3&&(i=3),i<2?new Qe(n):new Qe(n,i)}}},{key:"interfaces_",value:function(){return[P,t]}},{key:"getClass",value:function(){return e}}],[{key:"instance",value:function(){return e.instanceObject}},{key:"serialVersionUID",get:function(){return-0x38e49fa6cf6f2e00}},{key:"instanceObject",get:function(){return new e}}]),e}(),$e=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.map_=new Map,e}return m(t,xe),p(t,[{key:"get",value:function(e){return this.map_.get(e)||null}},{key:"put",value:function(e,t){return this.map_.set(e,t),t}},{key:"values",value:function(){for(var e=new de,t=this.map_.values(),n=t.next();!n.done;)e.add(n.value),n=t.next();return e}},{key:"entrySet",value:function(){var e=new Ne;return this.map_.entries().forEach(function(t){return e.add(t)}),e}},{key:"size",value:function(){return this.map_.size()}}]),t}(),et=function(){function e(){if(_(this,e),this._modelType=null,this._scale=null,0===arguments.length)this._modelType=e.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof tt){var t=arguments[0];this._modelType=t,t===e.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=e.FIXED,this.setScale(n)}else if(arguments[0]instanceof e){var i=arguments[0];this._modelType=i._modelType,this._scale=i._scale}}return p(e,[{key:"equals",value:function(t){if(!(t instanceof e))return!1;var n=t;return this._modelType===n._modelType&&this._scale===n._scale}},{key:"compareTo",value:function(e){var t=e,n=this.getMaximumSignificantDigits(),i=t.getMaximumSignificantDigits();return new D(n).compareTo(new D(i))}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===e.FLOATING||this._modelType===e.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var t="UNKNOWN";return this._modelType===e.FLOATING?t="Floating":this._modelType===e.FLOATING_SINGLE?t="Floating-Single":this._modelType===e.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}},{key:"makePrecise",value:function(){if("number"==typeof arguments[0]){var t=arguments[0];if(E.isNaN(t))return t;if(this._modelType===e.FLOATING_SINGLE){return t}return this._modelType===e.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof L){var n=arguments[0];if(this._modelType===e.FLOATING)return null;n.x=this.makePrecise(n.x),n.y=this.makePrecise(n.y)}}},{key:"getMaximumSignificantDigits",value:function(){var t=16;return this._modelType===e.FLOATING?t=16:this._modelType===e.FLOATING_SINGLE?t=6:this._modelType===e.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}},{key:"setScale",value:function(e){this._scale=Math.abs(e)}},{key:"interfaces_",value:function(){return[t,N]}},{key:"getClass",value:function(){return e}}],[{key:"mostPrecise",value:function(e,t){return e.compareTo(t)>=0?e:t}},{key:"serialVersionUID",get:function(){return 0x6bee6404e9a25c00}},{key:"maximumPreciseValue",get:function(){return 9007199254740992}}]),e}(),tt=function(){function e(t){_(this,e),this._name=t||null,e.nameToTypeMap.put(t,this)}return p(e,[{key:"readResolve",value:function(){return e.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",value:function(){return[t]}},{key:"getClass",value:function(){return e}}],[{key:"serialVersionUID",get:function(){return-552860263173159e4}},{key:"nameToTypeMap",get:function(){return new $e}}]),e}();et.Type=tt,et.FIXED=new tt("FIXED"),et.FLOATING=new tt("FLOATING"),et.FLOATING_SINGLE=new tt("FLOATING SINGLE");var nt=function(){function e(){_(this,e),this._precisionModel=new et,this._SRID=0,this._coordinateSequenceFactory=e.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?R(arguments[0],P)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof et&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))}return p(e,[{key:"toGeometry",value:function(e){return e.isNull()?this.createPoint(null):e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new L(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new L(e.getMinX(),e.getMinY()),new L(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new L(e.getMinX(),e.getMinY()),new L(e.getMinX(),e.getMaxY()),new L(e.getMaxX(),e.getMaxY()),new L(e.getMaxX(),e.getMinY()),new L(e.getMinX(),e.getMinY())]),null)}},{key:"createLineString",value:function(e){return e?e instanceof Array?new qe(this.getCoordinateSequenceFactory().create(e),this):R(e,G)?new qe(e,this):void 0:new qe(this.getCoordinateSequenceFactory().create([]),this)}},{key:"createMultiLineString",value:function(){if(0===arguments.length)return new De(null,this);if(1===arguments.length){var e=arguments[0];return new De(e,this)}}},{key:"buildGeometry",value:function(t){for(var n=null,i=!1,r=!1,s=t.iterator();s.hasNext();){var o=s.next(),a=o.getClass();null===n&&(n=a),a!==n&&(i=!0),o.isGeometryCollectionOrDerived()&&(r=!0)}if(null===n)return this.createGeometryCollection();if(i||r)return this.createGeometryCollection(e.toGeometryArray(t));var u=t.iterator().next();if(t.size()>1){if(u instanceof Ue)return this.createMultiPolygon(e.toPolygonArray(t));if(u instanceof qe)return this.createMultiLineString(e.toLineStringArray(t));if(u instanceof ze)return this.createMultiPoint(e.toPointArray(t));Q.shouldNeverReachHere("Unhandled class: "+u.getClass().getName())}return u}},{key:"createMultiPointFromCoords",value:function(e){return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)}},{key:"createPoint",value:function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof L){var e=arguments[0];return this.createPoint(null!==e?this.getCoordinateSequenceFactory().create([e]):null)}if(R(arguments[0],G)){var t=arguments[0];return new ze(t,this)}}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(0===arguments.length)return new Ue(null,null,this);if(1===arguments.length){if(R(arguments[0],G)){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Array){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Ye){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return new Ue(i,r,this)}}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){if(0===arguments.length)return new be(null,this);if(1===arguments.length){var e=arguments[0];return new be(e,this)}}},{key:"createGeometry",value:function(e){return new He(this).edit(e,{edit:function(){if(2===arguments.length){var e=arguments[0];return this._coordinateSequenceFactory.create(e)}}})}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLinearRing(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(R(arguments[0],G)){var t=arguments[0];return new Ye(t,this)}}}},{key:"createMultiPolygon",value:function(){if(0===arguments.length)return new je(null,this);if(1===arguments.length){var e=arguments[0];return new je(e,this)}}},{key:"createMultiPoint",value:function(){if(0===arguments.length)return new Xe(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];return new Xe(e,this)}if(arguments[0]instanceof Array){var t=arguments[0];return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(R(arguments[0],G)){var n=arguments[0];if(null===n)return this.createMultiPoint(new Array(0).fill(null));for(var i=new Array(n.size()).fill(null),r=0;r<n.size();r++){var s=this.getCoordinateSequenceFactory().create(1,n.getDimension());Ge.copy(n,r,s,0,1),i[r]=this.createPoint(s)}return this.createMultiPoint(i)}}}},{key:"interfaces_",value:function(){return[t]}},{key:"getClass",value:function(){return e}}],[{key:"toMultiPolygonArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toGeometryArray",value:function(e){if(null===e)return null;var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return Ze.instance()}},{key:"toMultiLineStringArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toLineStringArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toMultiPointArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toLinearRingArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toPointArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"toPolygonArray",value:function(e){var t=new Array(e.size()).fill(null);return e.toArray(t)}},{key:"createPointFromInternalCoord",value:function(e,t){return t.getPrecisionModel().makePrecise(e),t.getFactory().createPoint(e)}},{key:"serialVersionUID",get:function(){return-0x5ea75f2051eeb400}}]),e}(),it=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],rt=function(){function e(t){_(this,e),this.geometryFactory=t||new nt}return p(e,[{key:"read",value:function(e){var t=void 0,n=(t="string"==typeof e?JSON.parse(e):e).type;if(!st[n])throw new Error("Unknown GeoJSON type: "+t.type);return-1!==it.indexOf(n)?st[n].apply(this,[t.coordinates]):"GeometryCollection"===n?st[n].apply(this,[t.geometries]):st[n].apply(this,[t])}},{key:"write",value:function(e){var t=e.getGeometryType();if(!ot[t])throw new Error("Geometry is not supported");return ot[t].apply(this,[e])}}]),e}(),st={Feature:function(e){var t={};for(var n in e)t[n]=e[n];if(e.geometry){var i=e.geometry.type;if(!st[i])throw new Error("Unknown GeoJSON type: "+e.type);t.geometry=this.read(e.geometry)}return e.bbox&&(t.bbox=st.bbox.apply(this,[e.bbox])),t},FeatureCollection:function(e){var t={};if(e.features){t.features=[];for(var n=0;n<e.features.length;++n)t.features.push(this.read(e.features[n]))}return e.bbox&&(t.bbox=this.parse.bbox.apply(this,[e.bbox])),t},coordinates:function(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];t.push(new L(i[0],i[1]))}return t},bbox:function(e){return this.geometryFactory.createLinearRing([new L(e[0],e[1]),new L(e[2],e[1]),new L(e[2],e[3]),new L(e[0],e[3]),new L(e[0],e[1])])},Point:function(e){var t=new L(e[0],e[1]);return this.geometryFactory.createPoint(t)},MultiPoint:function(e){for(var t=[],n=0;n<e.length;++n)t.push(st.Point.apply(this,[e[n]]));return this.geometryFactory.createMultiPoint(t)},LineString:function(e){var t=st.coordinates.apply(this,[e]);return this.geometryFactory.createLineString(t)},MultiLineString:function(e){for(var t=[],n=0;n<e.length;++n)t.push(st.LineString.apply(this,[e[n]]));return this.geometryFactory.createMultiLineString(t)},Polygon:function(e){for(var t=st.coordinates.apply(this,[e[0]]),n=this.geometryFactory.createLinearRing(t),i=[],r=1;r<e.length;++r){var s=e[r],o=st.coordinates.apply(this,[s]),a=this.geometryFactory.createLinearRing(o);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];t.push(st.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(t)},GeometryCollection:function(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];t.push(this.read(i))}return this.geometryFactory.createGeometryCollection(t)}},ot={coordinate:function(e){return[e.x,e.y]},Point:function(e){return{type:"Point",coordinates:ot.coordinate.apply(this,[e.getCoordinate()])}},MultiPoint:function(e){for(var t=[],n=0;n<e._geometries.length;++n){var i=e._geometries[n],r=ot.Point.apply(this,[i]);t.push(r.coordinates)}return{type:"MultiPoint",coordinates:t}},LineString:function(e){for(var t=[],n=e.getCoordinates(),i=0;i<n.length;++i){var r=n[i];t.push(ot.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:t}},MultiLineString:function(e){for(var t=[],n=0;n<e._geometries.length;++n){var i=e._geometries[n],r=ot.LineString.apply(this,[i]);t.push(r.coordinates)}return{type:"MultiLineString",coordinates:t}},Polygon:function(e){var t=[],n=ot.LineString.apply(this,[e._shell]);t.push(n.coordinates);for(var i=0;i<e._holes.length;++i){var r=e._holes[i],s=ot.LineString.apply(this,[r]);t.push(s.coordinates)}return{type:"Polygon",coordinates:t}},MultiPolygon:function(e){for(var t=[],n=0;n<e._geometries.length;++n){var i=e._geometries[n],r=ot.Polygon.apply(this,[i]);t.push(r.coordinates)}return{type:"MultiPolygon",coordinates:t}},GeometryCollection:function(e){for(var t=[],n=0;n<e._geometries.length;++n){var i=e._geometries[n],r=i.getGeometryType();t.push(ot[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:t}}},at=function(){function e(t){_(this,e),this.geometryFactory=t||new nt,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new rt(this.geometryFactory)}return p(e,[{key:"read",value:function(e){var t=this.parser.read(e);return this.precisionModel.getType()===et.FIXED&&this.reducePrecision(t),t}},{key:"reducePrecision",value:function(e){var t,n;if(e.coordinate)this.precisionModel.makePrecise(e.coordinate);else if(e.points)for(t=0,n=e.points.length;t<n;t++)this.precisionModel.makePrecise(e.points[t]);else if(e.geometries)for(t=0,n=e.geometries.length;t<n;t++)this.reducePrecision(e.geometries[t])}}]),e}(),ut=function(){function e(){_(this,e),this.parser=new rt(this.geometryFactory)}return p(e,[{key:"write",value:function(e){return this.parser.write(e)}}]),e}(),lt=(function(){function e(t,n){_(this,e),this.geometryFactory=t||new nt,this.ol=n||"undefined"!=typeof ol&&ol}p(e,[{key:"read",value:function(e){var t=this.ol;return e instanceof t.geom.Point?this.convertFromPoint(e):e instanceof t.geom.LineString?this.convertFromLineString(e):e instanceof t.geom.LinearRing?this.convertFromLinearRing(e):e instanceof t.geom.Polygon?this.convertFromPolygon(e):e instanceof t.geom.MultiPoint?this.convertFromMultiPoint(e):e instanceof t.geom.MultiLineString?this.convertFromMultiLineString(e):e instanceof t.geom.MultiPolygon?this.convertFromMultiPolygon(e):e instanceof t.geom.GeometryCollection?this.convertFromCollection(e):void 0}},{key:"convertFromPoint",value:function(e){var t=e.getCoordinates();return this.geometryFactory.createPoint(new L(t[0],t[1]))}},{key:"convertFromLineString",value:function(e){return this.geometryFactory.createLineString(e.getCoordinates().map(function(e){return new L(e[0],e[1])}))}},{key:"convertFromLinearRing",value:function(e){return this.geometryFactory.createLinearRing(e.getCoordinates().map(function(e){return new L(e[0],e[1])}))}},{key:"convertFromPolygon",value:function(e){for(var t=e.getLinearRings(),n=null,i=[],r=0;r<t.length;r++){var s=this.convertFromLinearRing(t[r]);0===r?n=s:i.push(s)}return this.geometryFactory.createPolygon(n,i)}},{key:"convertFromMultiPoint",value:function(e){var t=e.getPoints().map(function(e){return this.convertFromPoint(e)},this);return this.geometryFactory.createMultiPoint(t)}},{key:"convertFromMultiLineString",value:function(e){var t=e.getLineStrings().map(function(e){return this.convertFromLineString(e)},this);return this.geometryFactory.createMultiLineString(t)}},{key:"convertFromMultiPolygon",value:function(e){var t=e.getPolygons().map(function(e){return this.convertFromPolygon(e)},this);return this.geometryFactory.createMultiPolygon(t)}},{key:"convertFromCollection",value:function(e){var t=e.getGeometries().map(function(e){return this.read(e)},this);return this.geometryFactory.createGeometryCollection(t)}},{key:"write",value:function(e){return"Point"===e.getGeometryType()?this.convertToPoint(e.getCoordinate()):"LineString"===e.getGeometryType()?this.convertToLineString(e):"LinearRing"===e.getGeometryType()?this.convertToLinearRing(e):"Polygon"===e.getGeometryType()?this.convertToPolygon(e):"MultiPoint"===e.getGeometryType()?this.convertToMultiPoint(e):"MultiLineString"===e.getGeometryType()?this.convertToMultiLineString(e):"MultiPolygon"===e.getGeometryType()?this.convertToMultiPolygon(e):"GeometryCollection"===e.getGeometryType()?this.convertToCollection(e):void 0}},{key:"convertToPoint",value:function(e){return new this.ol.geom.Point([e.x,e.y])}},{key:"convertToLineString",value:function(e){var t=e.points.coordinates.map(y);return new this.ol.geom.LineString(t)}},{key:"convertToLinearRing",value:function(e){var t=e.points.coordinates.map(y);return new this.ol.geom.LinearRing(t)}},{key:"convertToPolygon",value:function(e){for(var t=[e.shell.points.coordinates.map(y)],n=0;n<e.holes.length;n++)t.push(e.holes[n].points.coordinates.map(y));return new this.ol.geom.Polygon(t)}},{key:"convertToMultiPoint",value:function(e){return new this.ol.geom.MultiPoint(e.getCoordinates().map(y))}},{key:"convertToMultiLineString",value:function(e){for(var t=[],n=0;n<e.geometries.length;n++)t.push(this.convertToLineString(e.geometries[n]).getCoordinates());return new this.ol.geom.MultiLineString(t)}},{key:"convertToMultiPolygon",value:function(e){for(var t=[],n=0;n<e.geometries.length;n++)t.push(this.convertToPolygon(e.geometries[n]).getCoordinates());return new this.ol.geom.MultiPolygon(t)}},{key:"convertToCollection",value:function(e){for(var t=[],n=0;n<e.geometries.length;n++){var i=e.geometries[n];t.push(this.write(i))}return new this.ol.geom.GeometryCollection(t)}}])}(),function(){function e(t){_(this,e),this.geometryFactory=t||new nt,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Y(this.geometryFactory)}p(e,[{key:"read",value:function(e){var t=this.parser.read(e);return this.precisionModel.getType()===et.FIXED&&this.reducePrecision(t),t}},{key:"reducePrecision",value:function(e){if(e.coordinate)this.precisionModel.makePrecise(e.coordinate);else if(e._points)for(var t=0,n=e._points._coordinates.length;t<n;t++)this.precisionModel.makePrecise(e._points._coordinates[t]);else if(e._geometries)for(var i=0,r=e._geometries.length;i<r;i++)this.reducePrecision(e._geometries[i])}}])}(),function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"opposite",value:function(t){return t===e.LEFT?e.RIGHT:t===e.RIGHT?e.LEFT:t}},{key:"ON",get:function(){return 0}},{key:"LEFT",get:function(){return 1}},{key:"RIGHT",get:function(){return 2}}]),e}());(v.prototype=new Error).name="EmptyStackException",(d.prototype=new ve).add=function(e){return this.array_.push(e),!0},d.prototype.get=function(e){if(e<0||e>=this.size())throw new Error;return this.array_[e]},d.prototype.push=function(e){return this.array_.push(e),e},d.prototype.pop=function(e){if(0===this.array_.length)throw new v;return this.array_.pop()},d.prototype.peek=function(){if(0===this.array_.length)throw new v;return this.array_[this.array_.length-1]},d.prototype.empty=function(){return 0===this.array_.length},d.prototype.isEmpty=function(){return this.empty()},d.prototype.search=function(e){return this.array_.indexOf(e)},d.prototype.size=function(){return this.array_.length},d.prototype.toArray=function(){for(var e=[],t=0,n=this.array_.length;t<n;t++)e.push(this.array_[t]);return e};var ht=function(){function e(){_(this,e),this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}return p(e,[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(e,t){var n=this.getRightmostSideOfSegment(e,t);return n<0&&(n=this.getRightmostSideOfSegment(e,t-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(e)),n}},{key:"findRightmostEdgeAtVertex",value:function(){var e=this._minDe.getEdge().getCoordinates();Q.isTrue(this._minIndex>0&&this._minIndex<e.length,"rightmost point expected to be interior vertex of edge");var t=e[this._minIndex-1],n=e[this._minIndex+1],i=ne.computeOrientation(this._minCoord,n,t),r=!1;t.y<this._minCoord.y&&n.y<this._minCoord.y&&i===ne.COUNTERCLOCKWISE?r=!0:t.y>this._minCoord.y&&n.y>this._minCoord.y&&i===ne.CLOCKWISE&&(r=!0),r&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(e,t){var n=e.getEdge().getCoordinates();if(t<0||t+1>=n.length)return-1;if(n[t].y===n[t+1].y)return-1;var i=lt.LEFT;return n[t].y<n[t+1].y&&(i=lt.RIGHT),i}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(e){for(var t=e.getEdge().getCoordinates(),n=0;n<t.length-1;n++)(null===this._minCoord||t[n].x>this._minCoord.x)&&(this._minDe=e,this._minIndex=n,this._minCoord=t[n])}},{key:"findRightmostEdgeAtNode",value:function(){var e=this._minDe.getNode().getEdges();this._minDe=e.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();n.isForward()&&this.checkForRightmostCoordinate(n)}Q.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;this.getRightmostSide(this._minDe,this._minIndex)===lt.LEFT&&(this._orientedDe=this._minDe.getSym())}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),ct=function(e){function t(e,n){_(this,t);var i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,t.msgWithCoord(e,n)));return i.pt=n?new L(n):null,i.name="TopologyException",i}return m(t,K),p(t,[{key:"getCoordinate",value:function(){return this.pt}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}],[{key:"msgWithCoord",value:function(e,t){return t?e:e+" [ "+t+" ]"}}]),t}(),ft=function(){function e(){_(this,e),this.array_=[]}return p(e,[{key:"addLast",value:function(e){this.array_.push(e)}},{key:"removeFirst",value:function(){return this.array_.shift()}},{key:"isEmpty",value:function(){return 0===this.array_.length}}]),e}(),gt=function(){function e(){_(this,e),this._finder=null,this._dirEdgeList=new de,this._nodes=new de,this._rightMostCoord=null,this._env=null,this._finder=new ht}return p(e,[{key:"clearVisitedEdges",value:function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){e.next().setVisited(!1)}}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(e){for(var t=null,n=e.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){t=i;break}}if(null===t)throw new ct("unable to find edge to compute depths at "+e.getCoordinate());e.getEdges().computeDepths(t);for(var r=e.getEdges().iterator();r.hasNext();){var s=r.next();s.setVisited(!0),this.copySymDepths(s)}}},{key:"computeDepth",value:function(e){this.clearVisitedEdges();var t=this._finder.getEdge();t.setEdgeDepths(lt.RIGHT,e),this.copySymDepths(t),this.computeDepths(t)}},{key:"create",value:function(e){this.addReachable(e),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var t=e.next();t.getDepth(lt.RIGHT)>=1&&t.getDepth(lt.LEFT)<=0&&!t.isInteriorAreaEdge()&&t.setInResult(!0)}}},{key:"computeDepths",value:function(e){var t=new Ne,n=new ft,i=e.getNode();for(n.addLast(i),t.add(i),e.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();t.add(r),this.computeNodeDepth(r);for(var s=r.getEdges().iterator();s.hasNext();){var o=s.next().getSym();if(!o.isVisited()){var a=o.getNode();t.contains(a)||(n.addLast(a),t.add(a))}}}}},{key:"compareTo",value:function(e){var t=e;return this._rightMostCoord.x<t._rightMostCoord.x?-1:this._rightMostCoord.x>t._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(null===this._env){for(var e=new U,t=this._dirEdgeList.iterator();t.hasNext();)for(var n=t.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)e.expandToInclude(n[i]);this._env=e}return this._env}},{key:"addReachable",value:function(e){var t=new d;for(t.add(e);!t.empty();){var n=t.pop();this.add(n,t)}}},{key:"copySymDepths",value:function(e){var t=e.getSym();t.setDepth(lt.LEFT,e.getDepth(lt.RIGHT)),t.setDepth(lt.RIGHT,e.getDepth(lt.LEFT))}},{key:"add",value:function(e,t){e.setVisited(!0),this._nodes.add(e);for(var n=e.getEdges().iterator();n.hasNext();){var i=n.next();this._dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||t.push(r)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",value:function(){return[N]}},{key:"getClass",value:function(){return e}}]),e}(),yt=function(){function e(){if(_(this,e),this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[lt.ON]=n}else if(arguments[0]instanceof e){var i=arguments[0];if(this.init(i.location.length),null!==i)for(var r=0;r<this.location.length;r++)this.location[r]=i.location[r]}}else if(3===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2];this.init(3),this.location[lt.ON]=s,this.location[lt.LEFT]=o,this.location[lt.RIGHT]=a}}return p(e,[{key:"setAllLocations",value:function(e){for(var t=0;t<this.location.length;t++)this.location[t]=e}},{key:"isNull",value:function(){for(var e=0;e<this.location.length;e++)if(this.location[e]!==O.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(e){for(var t=0;t<this.location.length;t++)this.location[t]===O.NONE&&(this.location[t]=e)}},{key:"isLine",value:function(){return 1===this.location.length}},{key:"merge",value:function(e){if(e.location.length>this.location.length){var t=new Array(3).fill(null);t[lt.ON]=this.location[lt.ON],t[lt.LEFT]=O.NONE,t[lt.RIGHT]=O.NONE,this.location=t}for(var n=0;n<this.location.length;n++)this.location[n]===O.NONE&&n<e.location.length&&(this.location[n]=e.location[n])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var e=this.location[lt.LEFT];this.location[lt.LEFT]=this.location[lt.RIGHT],this.location[lt.RIGHT]=e}},{key:"toString",value:function(){var e=new b;return this.location.length>1&&e.append(O.toLocationSymbol(this.location[lt.LEFT])),e.append(O.toLocationSymbol(this.location[lt.ON])),this.location.length>1&&e.append(O.toLocationSymbol(this.location[lt.RIGHT])),e.toString()}},{key:"setLocations",value:function(e,t,n){this.location[lt.ON]=e,this.location[lt.LEFT]=t,this.location[lt.RIGHT]=n}},{key:"get",value:function(e){return e<this.location.length?this.location[e]:O.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var e=0;e<this.location.length;e++)if(this.location[e]===O.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(1===arguments.length){var e=arguments[0];this.setLocation(lt.ON,e)}else if(2===arguments.length){var t=arguments[0],n=arguments[1];this.location[t]=n}}},{key:"init",value:function(e){this.location=new Array(e).fill(null),this.setAllLocations(O.NONE)}},{key:"isEqualOnSide",value:function(e,t){return this.location[t]===e.location[t]}},{key:"allPositionsEqual",value:function(e){for(var t=0;t<this.location.length;t++)if(this.location[t]!==e)return!1;return!0}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),vt=function(){function e(){if(_(this,e),this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new yt(t),this.elt[1]=new yt(t)}else if(arguments[0]instanceof e){var n=arguments[0];this.elt[0]=new yt(n.elt[0]),this.elt[1]=new yt(n.elt[1])}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.elt[0]=new yt(O.NONE),this.elt[1]=new yt(O.NONE),this.elt[i].setLocation(r)}else if(3===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2];this.elt[0]=new yt(s,o,a),this.elt[1]=new yt(s,o,a)}else if(4===arguments.length){var u=arguments[0],l=arguments[1],h=arguments[2],c=arguments[3];this.elt[0]=new yt(O.NONE,O.NONE,O.NONE),this.elt[1]=new yt(O.NONE,O.NONE,O.NONE),this.elt[u].setLocations(l,h,c)}}return p(e,[{key:"getGeometryCount",value:function(){var e=0;return this.elt[0].isNull()||e++,this.elt[1].isNull()||e++,e}},{key:"setAllLocations",value:function(e,t){this.elt[e].setAllLocations(t)}},{key:"isNull",value:function(e){return this.elt[e].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(1===arguments.length){var e=arguments[0];this.setAllLocationsIfNull(0,e),this.setAllLocationsIfNull(1,e)}else if(2===arguments.length){var t=arguments[0],n=arguments[1];this.elt[t].setAllLocationsIfNull(n)}}},{key:"isLine",value:function(e){return this.elt[e].isLine()}},{key:"merge",value:function(e){for(var t=0;t<2;t++)null===this.elt[t]&&null!==e.elt[t]?this.elt[t]=new yt(e.elt[t]):this.elt[t].merge(e.elt[t])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(1===arguments.length){var e=arguments[0];return this.elt[e].get(lt.ON)}if(2===arguments.length){var t=arguments[0],n=arguments[1];return this.elt[t].get(n)}}},{key:"toString",value:function(){var e=new b;return null!==this.elt[0]&&(e.append("A:"),e.append(this.elt[0].toString())),null!==this.elt[1]&&(e.append(" B:"),e.append(this.elt[1].toString())),e.toString()}},{key:"isArea",value:function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var e=arguments[0];return this.elt[e].isArea()}}},{key:"isAnyNull",value:function(e){return this.elt[e].isAnyNull()}},{key:"setLocation",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];this.elt[e].setLocation(lt.ON,t)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}}},{key:"isEqualOnSide",value:function(e,t){return this.elt[0].isEqualOnSide(e.elt[0],t)&&this.elt[1].isEqualOnSide(e.elt[1],t)}},{key:"allPositionsEqual",value:function(e,t){return this.elt[e].allPositionsEqual(t)}},{key:"toLine",value:function(e){this.elt[e].isArea()&&(this.elt[e]=new yt(this.elt[e].location[0]))}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"toLineLabel",value:function(t){for(var n=new e(O.NONE),i=0;i<2;i++)n.setLocation(i,t.getLocation(i));return n}}]),e}(),dt=function(){function e(){_(this,e),this._startDe=null,this._maxNodeDegree=-1,this._edges=new de,this._pts=new de,this._label=new vt(O.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new de,this._geometryFactory=null;var t=arguments[0],n=arguments[1];this._geometryFactory=n,this.computePoints(t),this.computeRing()}return p(e,[{key:"computeRing",value:function(){if(null!==this._ring)return null;for(var e=new Array(this._pts.size()).fill(null),t=0;t<this._pts.size();t++)e[t]=this._pts.get(t);this._ring=this._geometryFactory.createLinearRing(e),this._isHole=ne.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return 1===this._label.getGeometryCount()}},{key:"computePoints",value:function(e){this._startDe=e;var t=e,n=!0;do{if(null===t)throw new ct("Found null DirectedEdge");if(t.getEdgeRing()===this)throw new ct("Directed Edge visited twice during ring-building at "+t.getCoordinate());this._edges.add(t);var i=t.getLabel();Q.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(t.getEdge(),t.isForward(),n),n=!1,this.setEdgeRing(t,this),t=this.getNext(t)}while(t!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(e){return this._pts.get(e)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var e=this._startDe;do{var t=e.getNode().getEdges().getOutgoingDegree(this);t>this._maxNodeDegree&&(this._maxNodeDegree=t),e=this.getNext(e)}while(e!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(e,t,n){var i=e.getCoordinates();if(t){var r=1;n&&(r=0);for(var s=r;s<i.length;s++)this._pts.add(i[s])}else{var o=i.length-2;n&&(o=i.length-1);for(var a=o;a>=0;a--)this._pts.add(i[a])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var e=this._startDe;do{e.getEdge().setInResult(!0),e=e.getNext()}while(e!==this._startDe)}},{key:"containsPoint",value:function(e){var t=this.getLinearRing();if(!t.getEnvelopeInternal().contains(e))return!1;if(!ne.isPointInRing(e,t.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();){if(n.next().containsPoint(e))return!1}return!0}},{key:"addHole",value:function(e){this._holes.add(e)}},{key:"isShell",value:function(){return null===this._shell}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(1===arguments.length){var e=arguments[0];this.mergeLabel(e,0),this.mergeLabel(e,1)}else if(2===arguments.length){var t=arguments[0],n=arguments[1],i=t.getLocation(n,lt.RIGHT);if(i===O.NONE)return null;if(this._label.getLocation(n)===O.NONE)return this._label.setLocation(n,i),null}}},{key:"setShell",value:function(e){this._shell=e,null!==e&&e.addHole(this)}},{key:"toPolygon",value:function(e){for(var t=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)t[n]=this._holes.get(n).getLinearRing();return e.createPolygon(this.getLinearRing(),t)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),_t=function(e){function t(){_(this,t);var e=arguments[0],n=arguments[1];return k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return m(t,dt),p(t,[{key:"setEdgeRing",value:function(e,t){e.setMinEdgeRing(t)}},{key:"getNext",value:function(e){return e.getNextMin()}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),pt=function(e){function t(){_(this,t);var e=arguments[0],n=arguments[1];return k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return m(t,dt),p(t,[{key:"buildMinimalRings",value:function(){var e=new de,t=this._startDe;do{if(null===t.getMinEdgeRing()){var n=new _t(t,this._geometryFactory);e.add(n)}t=t.getNext()}while(t!==this._startDe);return e}},{key:"setEdgeRing",value:function(e,t){e.setEdgeRing(t)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var e=this._startDe;do{e.getNode().getEdges().linkMinimalDirectedEdges(this),e=e.getNext()}while(e!==this._startDe)}},{key:"getNext",value:function(e){return e.getNext()}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),mt=function(){function e(){if(_(this,e),this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}}return p(e,[{key:"setVisited",value:function(e){this._isVisited=e}},{key:"setInResult",value:function(e){this._isInResult=e}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(e){this._label=e}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(e){this._isCovered=e,this._isCoveredSet=!0}},{key:"updateIM",value:function(e){Q.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(e)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),kt=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._coord=null,e._edges=null;var n=arguments[0],i=arguments[1];return e._coord=n,e._edges=i,e._label=new vt(0,O.NONE),e}return m(t,mt),p(t,[{key:"isIncidentEdgeInResult",value:function(){for(var e=this.getEdges().getEdges().iterator();e.hasNext();){if(e.next().getEdge().isInResult())return!0}return!1}},{key:"isIsolated",value:function(){return 1===this._label.getGeometryCount()}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(e){e.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(e){}},{key:"computeMergedLocation",value:function(e,t){var n=O.NONE;if(n=this._label.getLocation(t),!e.isNull(t)){var i=e.getLocation(t);n!==O.BOUNDARY&&(n=i)}return n}},{key:"setLabel",value:function(){if(2!==arguments.length)return mt.prototype.setLabel.apply(this,arguments);var e=arguments[0],t=arguments[1];null===this._label?this._label=new vt(e,t):this._label.setLocation(e,t)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof t){var e=arguments[0];this.mergeLabel(e._label)}else if(arguments[0]instanceof vt)for(var n=arguments[0],i=0;i<2;i++){var r=this.computeMergedLocation(n,i);this._label.getLocation(i)===O.NONE&&this._label.setLocation(i,r)}}},{key:"add",value:function(e){this._edges.insert(e),e.setNode(this)}},{key:"setLabelBoundary",value:function(e){if(null===this._label)return null;var t=O.NONE;null!==this._label&&(t=this._label.getLocation(e));var n=null;switch(t){case O.BOUNDARY:n=O.INTERIOR;break;case O.INTERIOR:default:n=O.BOUNDARY}this._label.setLocation(e,n)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),It=function(){function e(){_(this,e),this.nodeMap=new h,this.nodeFact=null;var t=arguments[0];this.nodeFact=t}return p(e,[{key:"find",value:function(e){return this.nodeMap.get(e)}},{key:"addNode",value:function(){if(arguments[0]instanceof L){var e=arguments[0],t=this.nodeMap.get(e);return null===t&&(t=this.nodeFact.createNode(e),this.nodeMap.put(e,t)),t}if(arguments[0]instanceof kt){var n=arguments[0],i=this.nodeMap.get(n.getCoordinate());return null===i?(this.nodeMap.put(n.getCoordinate(),n),n):(i.mergeLabel(n),i)}}},{key:"print",value:function(e){for(var t=this.iterator();t.hasNext();){t.next().print(e)}}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(e){for(var t=new de,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(e)===O.BOUNDARY&&t.add(i)}return t}},{key:"add",value:function(e){var t=e.getCoordinate();this.addNode(t).add(e)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),xt=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"isNorthern",value:function(t){return t===e.NE||t===e.NW}},{key:"isOpposite",value:function(e,t){if(e===t)return!1;return 2===(e-t+4)%4}},{key:"commonHalfPlane",value:function(e,t){if(e===t)return e;if(2===(e-t+4)%4)return-1;var n=e<t?e:t;return 0===n&&3===(e>t?e:t)?3:n}},{key:"isInHalfPlane",value:function(t,n){return n===e.SE?t===e.SE||t===e.SW:t===n||t===n+1}},{key:"quadrant",value:function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],n=arguments[1];if(0===t&&0===n)throw new x("Cannot compute the quadrant for point ( "+t+", "+n+" )");return t>=0?n>=0?e.NE:e.SE:n>=0?e.NW:e.SW}if(arguments[0]instanceof L&&arguments[1]instanceof L){var i=arguments[0],r=arguments[1];if(r.x===i.x&&r.y===i.y)throw new x("Cannot compute the quadrant for two identical points "+i);return r.x>=i.x?r.y>=i.y?e.NE:e.SE:r.y>=i.y?e.NW:e.SW}}},{key:"NE",get:function(){return 0}},{key:"NW",get:function(){return 1}},{key:"SW",get:function(){return 2}},{key:"SE",get:function(){return 3}}]),e}(),Et=function(){function e(){if(_(this,e),this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._edge=n,this.init(i,r),this._label=null}else if(4===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2],u=arguments[3];this._edge=s,this.init(o,a),this._label=u}}return p(e,[{key:"compareDirection",value:function(e){return this._dx===e._dx&&this._dy===e._dy?0:this._quadrant>e._quadrant?1:this._quadrant<e._quadrant?-1:ne.computeOrientation(e._p0,e._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(e){this._node=e}},{key:"print",value:function(e){var t=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);e.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label)}},{key:"compareTo",value:function(e){var t=e;return this.compareDirection(t)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var e=Math.atan2(this._dy,this._dx),t=this.getClass().getName(),n=t.lastIndexOf(".");return"  "+t.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label}},{key:"computeLabel",value:function(e){}},{key:"init",value:function(e,t){this._p0=e,this._p1=t,this._dx=t.x-e.x,this._dy=t.y-e.y,this._quadrant=xt.quadrant(this._dx,this._dy),Q.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",value:function(){return[N]}},{key:"getClass",value:function(){return e}}]),e}(),Nt=function(e){function t(){_(this,t);var e=arguments[0],n=arguments[1],i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(i._isForward=null,i._isInResult=!1,i._isVisited=!1,i._sym=null,i._next=null,i._nextMin=null,i._edgeRing=null,i._minEdgeRing=null,i._depth=[0,-999,-999],i._isForward=n,n)i.init(e.getCoordinate(0),e.getCoordinate(1));else{var r=e.getNumPoints()-1;i.init(e.getCoordinate(r),e.getCoordinate(r-1))}return i.computeDirectedLabel(),i}return m(t,Et),p(t,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(e){return this._depth[e]}},{key:"setVisited",value:function(e){this._isVisited=e}},{key:"computeDirectedLabel",value:function(){this._label=new vt(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(e,t){if(-999!==this._depth[e]&&this._depth[e]!==t)throw new ct("assigned depths do not match",this.getCoordinate());this._depth[e]=t}},{key:"isInteriorAreaEdge",value:function(){for(var e=!0,t=0;t<2;t++)this._label.isArea(t)&&this._label.getLocation(t,lt.LEFT)===O.INTERIOR&&this._label.getLocation(t,lt.RIGHT)===O.INTERIOR||(e=!1);return e}},{key:"setNextMin",value:function(e){this._nextMin=e}},{key:"print",value:function(e){Et.prototype.print.call(this,e),e.print(" "+this._depth[lt.LEFT]+"/"+this._depth[lt.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")}},{key:"setMinEdgeRing",value:function(e){this._minEdgeRing=e}},{key:"isLineEdge",value:function(){var e=this._label.isLine(0)||this._label.isLine(1),t=!this._label.isArea(0)||this._label.allPositionsEqual(0,O.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,O.EXTERIOR);return e&&t&&n}},{key:"setEdgeRing",value:function(e){this._edgeRing=e}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var e=this._edge.getDepthDelta();return this._isForward||(e=-e),e}},{key:"setInResult",value:function(e){this._isInResult=e}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(e){this.print(e),e.print(" "),this._isForward?this._edge.print(e):this._edge.printReverse(e)}},{key:"setSym",value:function(e){this._sym=e}},{key:"setVisitedEdge",value:function(e){this.setVisited(e),this._sym.setVisited(e)}},{key:"setEdgeDepths",value:function(e,t){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;e===lt.LEFT&&(i=-1);var r=lt.opposite(e),s=t+n*i;this.setDepth(e,t),this.setDepth(r,s)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(e){this._next=e}},{key:"isVisited",value:function(){return this._isVisited}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}],[{key:"depthFactor",value:function(e,t){return e===O.EXTERIOR&&t===O.INTERIOR?1:e===O.INTERIOR&&t===O.EXTERIOR?-1:0}}]),t}(),Ct=function(){function e(){_(this,e)}return p(e,[{key:"createNode",value:function(e){return new kt(e,null)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),St=function(){function e(){if(_(this,e),this._edges=new de,this._nodes=null,this._edgeEndList=new de,0===arguments.length)this._nodes=new It(new Ct);else if(1===arguments.length){var t=arguments[0];this._nodes=new It(t)}}return p(e,[{key:"printEdges",value:function(e){e.println("Edges:");for(var t=0;t<this._edges.size();t++){e.println("edge "+t+":");var n=this._edges.get(t);n.print(e),n.eiList.print(e)}}},{key:"find",value:function(e){return this._nodes.find(e)}},{key:"addNode",value:function(){if(arguments[0]instanceof kt){var e=arguments[0];return this._nodes.addNode(e)}if(arguments[0]instanceof L){var t=arguments[0];return this._nodes.addNode(t)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var e=this._nodes.iterator();e.hasNext();){e.next().getEdges().linkResultDirectedEdges()}}},{key:"debugPrintln",value:function(e){z.out.println(e)}},{key:"isBoundaryNode",value:function(e,t){var n=this._nodes.find(t);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(e)===O.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var e=this._nodes.iterator();e.hasNext();){e.next().getEdges().linkAllDirectedEdges()}}},{key:"matchInSameDirection",value:function(e,t,n,i){return!!e.equals(n)&&(ne.computeOrientation(e,t,i)===ne.COLLINEAR&&xt.quadrant(e,t)===xt.quadrant(n,i))}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(e){z.out.print(e)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(e,t){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(e,t,r[0],r[1]))return i;if(this.matchInSameDirection(e,t,r[r.length-1],r[r.length-2]))return i}return null}},{key:"insertEdge",value:function(e){this._edges.add(e)}},{key:"findEdgeEnd",value:function(e){for(var t=this.getEdgeEnds().iterator();t.hasNext();){var n=t.next();if(n.getEdge()===e)return n}return null}},{key:"addEdges",value:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this._edges.add(n);var i=new Nt(n,!0),r=new Nt(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}}},{key:"add",value:function(e){this._nodes.add(e),this._edgeEndList.add(e)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(e,t){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(e.equals(r[0])&&t.equals(r[1]))return i}return null}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"linkResultDirectedEdges",value:function(e){for(var t=e.iterator();t.hasNext();){t.next().getEdges().linkResultDirectedEdges()}}}]),e}(),Lt=function(){function e(){_(this,e),this._geometryFactory=null,this._shellList=new de;var t=arguments[0];this._geometryFactory=t}return p(e,[{key:"sortShellsAndHoles",value:function(e,t,n){for(var i=e.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):t.add(r)}}},{key:"computePolygons",value:function(e){for(var t=new de,n=e.iterator();n.hasNext();){var i=n.next().toPolygon(this._geometryFactory);t.add(i)}return t}},{key:"placeFreeHoles",value:function(e,t){for(var n=t.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,e);if(null===r)throw new ct("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}}},{key:"buildMinimalEdgeRings",value:function(e,t,n){for(var i=new de,r=e.iterator();r.hasNext();){var s=r.next();if(s.getMaxNodeDegree()>2){s.linkDirectedEdgesForMinimalEdgeRings();var o=s.buildMinimalRings(),a=this.findShell(o);null!==a?(this.placePolygonHoles(a,o),t.add(a)):n.addAll(o)}else i.add(s)}return i}},{key:"containsPoint",value:function(e){for(var t=this._shellList.iterator();t.hasNext();){if(t.next().containsPoint(e))return!0}return!1}},{key:"buildMaximalEdgeRings",value:function(e){for(var t=new de,n=e.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new pt(i,this._geometryFactory);t.add(r),r.setInResult()}}return t}},{key:"placePolygonHoles",value:function(e,t){for(var n=t.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(e)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findEdgeRingContaining",value:function(e,t){for(var n=e.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),s=null,o=null,a=t.iterator();a.hasNext();){var u=a.next(),l=u.getLinearRing(),h=l.getEnvelopeInternal();null!==s&&(o=s.getLinearRing().getEnvelopeInternal());var c=!1;h.contains(i)&&ne.isPointInRing(r,l.getCoordinates())&&(c=!0),c&&(null===s||o.contains(h))&&(s=u)}return s}},{key:"findShell",value:function(e){for(var t=0,n=null,i=e.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,t++)}return Q.isTrue(t<=1,"found two shells in MinimalEdgeRing list"),n}},{key:"add",value:function(){if(1===arguments.length){var e=arguments[0];this.add(e.getEdgeEnds(),e.getNodes())}else if(2===arguments.length){var t=arguments[0],n=arguments[1];St.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(t),r=new de,s=this.buildMinimalEdgeRings(i,this._shellList,r);this.sortShellsAndHoles(s,this._shellList,r),this.placeFreeHoles(this._shellList,r)}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),wt=function(){function e(){_(this,e)}return p(e,[{key:"getBounds",value:function(){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Pt=function(){function e(){_(this,e),this._bounds=null,this._item=null;var t=arguments[0],n=arguments[1];this._bounds=t,this._item=n}return p(e,[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",value:function(){return[wt,t]}},{key:"getClass",value:function(){return e}}]),e}(),Ot=function(){function e(){_(this,e),this._size=null,this._items=null,this._size=0,this._items=new de,this._items.add(null)}return p(e,[{key:"poll",value:function(){if(this.isEmpty())return null;var e=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),e}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(e){for(var t=null,n=this._items.get(e);2*e<=this._size&&((t=2*e)!==this._size&&this._items.get(t+1).compareTo(this._items.get(t))<0&&t++,this._items.get(t).compareTo(n)<0);e=t)this._items.set(e,this._items.get(t));this._items.set(e,n)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"isEmpty",value:function(){return 0===this._size}},{key:"add",value:function(e){this._items.add(null),this._size+=1;var t=this._size;for(this._items.set(0,e);e.compareTo(this._items.get(Math.trunc(t/2)))<0;t/=2)this._items.set(t,this._items.get(Math.trunc(t/2)));this._items.set(t,e)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Rt=function(){function e(){_(this,e)}return p(e,[{key:"visitItem",value:function(e){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Tt=function(){function e(){_(this,e)}return p(e,[{key:"insert",value:function(e,t){}},{key:"remove",value:function(e,t){}},{key:"query",value:function(){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),bt=function(){function e(){if(_(this,e),this._childBoundables=new de,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}}return p(e,[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(e){Q.isTrue(null===this._bounds),this._childBoundables.add(e)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",value:function(){return[wt,t]}},{key:"getClass",value:function(){return e}}],[{key:"serialVersionUID",get:function(){return 0x5a1e55ec41369800}}]),e}(),Dt=function(){function e(){_(this,e)}return p(e,null,[{key:"reverseOrder",value:function(){return{compare:function(e,t){return t.compareTo(e)}}}},{key:"min",value:function(t){return e.sort(t),t.get(0)}},{key:"sort",value:function(e,t){var n=e.toArray();t?Pe.sort(n,t):Pe.sort(n);for(var i=e.iterator(),r=0,s=n.length;r<s;r++)i.next(),i.set(n[r])}},{key:"singletonList",value:function(e){var t=new de;return t.add(e),t}}]),e}(),Mt=function(){function e(){_(this,e),this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],n=arguments[1],i=arguments[2];this._boundable1=t,this._boundable2=n,this._itemDistance=i,this._distance=this.distance()}return p(e,[{key:"expandToQueue",value:function(t,n){var i=e.isComposite(this._boundable1),r=e.isComposite(this._boundable2);if(i&&r)return e.area(this._boundable1)>e.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,n),null):(this.expand(this._boundable2,this._boundable1,t,n),null);if(i)return this.expand(this._boundable1,this._boundable2,t,n),null;if(r)return this.expand(this._boundable2,this._boundable1,t,n),null;throw new x("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(e.isComposite(this._boundable1)||e.isComposite(this._boundable2))}},{key:"compareTo",value:function(e){var t=e;return this._distance<t._distance?-1:this._distance>t._distance?1:0}},{key:"expand",value:function(t,n,i,r){for(var s=t.getChildBoundables().iterator();s.hasNext();){var o=new e(s.next(),n,this._itemDistance);o.getDistance()<r&&i.add(o)}}},{key:"getBoundable",value:function(e){return 0===e?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",value:function(){return[N]}},{key:"getClass",value:function(){return e}}],[{key:"area",value:function(e){return e.getBounds().getArea()}},{key:"isComposite",value:function(e){return e instanceof bt}}]),e}(),At=function(){function e(){if(_(this,e),this._root=null,this._built=!1,this._itemBoundables=new de,this._nodeCapacity=null,0===arguments.length){var t=e.DEFAULT_NODE_CAPACITY;this._nodeCapacity=t}else if(1===arguments.length){var n=arguments[0];Q.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}}return p(e,[{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(e){return e.get(e.size()-1)}},{key:"size",value:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var e=0,t=arguments[0].getChildBoundables().iterator();t.hasNext();){var n=t.next();n instanceof bt?e+=this.size(n):n instanceof Pt&&(e+=1)}return e}}},{key:"removeItem",value:function(e,t){for(var n=null,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof Pt&&r.getItem()===t&&(n=r)}return null!==n&&(e.getChildBoundables().remove(n),!0)}},{key:"itemsTree",value:function(){if(0===arguments.length){this.build();var e=this.itemsTree(this._root);return null===e?new de:e}if(1===arguments.length){for(var t=arguments[0],n=new de,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof bt){var s=this.itemsTree(r);null!==s&&n.add(s)}else r instanceof Pt?n.add(r.getItem()):Q.shouldNeverReachHere()}return n.size()<=0?null:n}}},{key:"insert",value:function(e,t){Q.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Pt(e,t))}},{key:"boundablesAtLevel",value:function(){if(1===arguments.length){var e=arguments[0],t=new de;return this.boundablesAtLevel(e,this._root,t),t}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(Q.isTrue(n>-2),i.getLevel()===n)return r.add(i),null;for(var s=i.getChildBoundables().iterator();s.hasNext();){var o=s.next();o instanceof bt?this.boundablesAtLevel(n,o,r):(Q.isTrue(o instanceof Pt),-1===n&&r.add(o))}return null}}},{key:"query",value:function(){if(1===arguments.length){var e=arguments[0];this.build();var t=new de;return this.isEmpty()?t:(this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.query(e,this._root,t),t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,i)}else if(3===arguments.length)if(R(arguments[2],Rt)&&arguments[0]instanceof Object&&arguments[1]instanceof bt)for(var r=arguments[0],s=arguments[1],o=arguments[2],a=s.getChildBoundables(),u=0;u<a.size();u++){var l=a.get(u);this.getIntersectsOp().intersects(l.getBounds(),r)&&(l instanceof bt?this.query(r,l,o):l instanceof Pt?o.visitItem(l.getItem()):Q.shouldNeverReachHere())}else if(R(arguments[2],ve)&&arguments[0]instanceof Object&&arguments[1]instanceof bt)for(var h=arguments[0],c=arguments[1],f=arguments[2],g=c.getChildBoundables(),y=0;y<g.size();y++){var v=g.get(y);this.getIntersectsOp().intersects(v.getBounds(),h)&&(v instanceof bt?this.query(h,v,f):v instanceof Pt?f.add(v.getItem()):Q.shouldNeverReachHere())}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.remove(e,this._root,t)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],s=this.removeItem(i,r);if(s)return!0;for(var o=null,a=i.getChildBoundables().iterator();a.hasNext();){var u=a.next();if(this.getIntersectsOp().intersects(u.getBounds(),n)&&(u instanceof bt&&(s=this.remove(n,u,r)))){o=u;break}}return null!==o&&o.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(o),s}}},{key:"createHigherLevels",value:function(e,t){Q.isTrue(!e.isEmpty());var n=this.createParentBoundables(e,t+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,t+1)}},{key:"depth",value:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var e=0,t=arguments[0].getChildBoundables().iterator();t.hasNext();){var n=t.next();if(n instanceof bt){var i=this.depth(n);i>e&&(e=i)}}return e+1}}},{key:"createParentBoundables",value:function(e,t){Q.isTrue(!e.isEmpty());var n=new de;n.add(this.createNode(t));var i=new de(e);Dt.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var s=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(t)),this.lastNode(n).addChildBoundable(s)}return n}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",value:function(){return[t]}},{key:"getClass",value:function(){return e}}],[{key:"compareDoubles",value:function(e,t){return e>t?1:e<t?-1:0}},{key:"IntersectsOp",get:function(){return Ft}},{key:"serialVersionUID",get:function(){return-0x35ef64c82d4c5400}},{key:"DEFAULT_NODE_CAPACITY",get:function(){return 10}}]),e}(),Ft=function e(){_(this,e)},Gt=function(){function e(){_(this,e)}return p(e,[{key:"distance",value:function(e,t){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),qt=function(e){function n(e){return _(this,n),e=e||n.DEFAULT_NODE_CAPACITY,k(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e))}return m(n,At),p(n,[{key:"createParentBoundablesFromVerticalSlices",value:function(e,t){Q.isTrue(e.length>0);for(var n=new de,i=0;i<e.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(e[i],t));return n}},{key:"createNode",value:function(e){return new Bt(e)}},{key:"size",value:function(){return 0===arguments.length?At.prototype.size.call(this):At.prototype.size.apply(this,arguments)}},{key:"insert",value:function(){if(2!==arguments.length)return At.prototype.insert.apply(this,arguments);var e=arguments[0],t=arguments[1];if(e.isNull())return null;At.prototype.insert.call(this,e,t)}},{key:"getIntersectsOp",value:function(){return n.intersectsOp}},{key:"verticalSlices",value:function(e,t){for(var n=Math.trunc(Math.ceil(e.size()/t)),i=new Array(t).fill(null),r=e.iterator(),s=0;s<t;s++){i[s]=new de;for(var o=0;r.hasNext()&&o<n;){var a=r.next();i[s].add(a),o++}}return i}},{key:"query",value:function(){if(1===arguments.length){var e=arguments[0];return At.prototype.query.call(this,e)}if(2===arguments.length){var t=arguments[0],n=arguments[1];At.prototype.query.call(this,t,n)}else if(3===arguments.length)if(R(arguments[2],Rt)&&arguments[0]instanceof Object&&arguments[1]instanceof bt){var i=arguments[0],r=arguments[1],s=arguments[2];At.prototype.query.call(this,i,r,s)}else if(R(arguments[2],ve)&&arguments[0]instanceof Object&&arguments[1]instanceof bt){var o=arguments[0],a=arguments[1],u=arguments[2];At.prototype.query.call(this,o,a,u)}}},{key:"getComparator",value:function(){return n.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(e,t){return At.prototype.createParentBoundables.call(this,e,t)}},{key:"remove",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];return At.prototype.remove.call(this,e,t)}return At.prototype.remove.apply(this,arguments)}},{key:"depth",value:function(){return 0===arguments.length?At.prototype.depth.call(this):At.prototype.depth.apply(this,arguments)}},{key:"createParentBoundables",value:function(e,t){Q.isTrue(!e.isEmpty());var i=Math.trunc(Math.ceil(e.size()/this.getNodeCapacity())),r=new de(e);Dt.sort(r,n.xComparator);var s=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(i))));return this.createParentBoundablesFromVerticalSlices(s,t)}},{key:"nearestNeighbour",value:function(){if(1===arguments.length){if(R(arguments[0],Gt)){var e=arguments[0],t=new Mt(this.getRoot(),this.getRoot(),e);return this.nearestNeighbour(t)}if(arguments[0]instanceof Mt){var i=arguments[0];return this.nearestNeighbour(i,E.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof n&&R(arguments[1],Gt)){var r=arguments[0],s=arguments[1],o=new Mt(this.getRoot(),r.getRoot(),s);return this.nearestNeighbour(o)}if(arguments[0]instanceof Mt&&"number"==typeof arguments[1]){var a=arguments[0],u=arguments[1],l=null,h=new Ot;for(h.add(a);!h.isEmpty()&&u>0;){var c=h.poll(),f=c.getDistance();if(f>=u)break;c.isLeaves()?(u=f,l=c):c.expandToQueue(h,u)}return[l.getBoundable(0).getItem(),l.getBoundable(1).getItem()]}}else if(3===arguments.length){var g=arguments[0],y=arguments[1],v=arguments[2],d=new Pt(g,y),_=new Mt(this.getRoot(),d,v);return this.nearestNeighbour(_)[0]}}},{key:"interfaces_",value:function(){return[Tt,t]}},{key:"getClass",value:function(){return n}}],[{key:"centreX",value:function(e){return n.avg(e.getMinX(),e.getMaxX())}},{key:"avg",value:function(e,t){return(e+t)/2}},{key:"centreY",value:function(e){return n.avg(e.getMinY(),e.getMaxY())}},{key:"STRtreeNode",get:function(){return Bt}},{key:"serialVersionUID",get:function(){return 0x39920f7d5f261e0}},{key:"xComparator",get:function(){return{interfaces_:function(){return[S]},compare:function(e,t){return At.compareDoubles(n.centreX(e.getBounds()),n.centreX(t.getBounds()))}}}},{key:"yComparator",get:function(){return{interfaces_:function(){return[S]},compare:function(e,t){return At.compareDoubles(n.centreY(e.getBounds()),n.centreY(t.getBounds()))}}}},{key:"intersectsOp",get:function(){return{interfaces_:function(){return[At.IntersectsOp]},intersects:function(e,t){return e.intersects(t)}}}},{key:"DEFAULT_NODE_CAPACITY",get:function(){return 10}}]),n}(),Bt=function(e){function t(){_(this,t);var e=arguments[0];return k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return m(t,bt),p(t,[{key:"computeBounds",value:function(){for(var e=null,t=this.getChildBoundables().iterator();t.hasNext();){var n=t.next();null===e?e=new U(n.getBounds()):e.expandToInclude(n.getBounds())}return e}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),zt=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"relativeSign",value:function(e,t){return e<t?-1:e>t?1:0}},{key:"compare",value:function(t,n,i){if(n.equals2D(i))return 0;var r=e.relativeSign(n.x,i.x),s=e.relativeSign(n.y,i.y);switch(t){case 0:return e.compareValue(r,s);case 1:return e.compareValue(s,r);case 2:return e.compareValue(s,-r);case 3:return e.compareValue(-r,s);case 4:return e.compareValue(-r,-s);case 5:return e.compareValue(-s,-r);case 6:return e.compareValue(-s,r);case 7:return e.compareValue(r,-s)}return Q.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(e,t){return e<0?-1:e>0?1:t<0?-1:t>0?1:0}}]),e}(),Vt=function(){function e(){_(this,e),this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3];this._segString=t,this.coord=new L(n),this.segmentIndex=i,this._segmentOctant=r,this._isInterior=!n.equals2D(t.getCoordinate(i))}return p(e,[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(e){var t=e;return this.segmentIndex<t.segmentIndex?-1:this.segmentIndex>t.segmentIndex?1:this.coord.equals2D(t.coord)?0:zt.compare(this._segmentOctant,this.coord,t.coord)}},{key:"isEndPoint",value:function(e){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===e}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",value:function(){return[N]}},{key:"getClass",value:function(){return e}}]),e}(),Ut=function(){function e(){_(this,e),this._nodeMap=new h,this._edge=null;var t=arguments[0];this._edge=t}return p(e,[{key:"getSplitCoordinates",value:function(){var e=new pe;this.addEndpoints();for(var t=this.iterator(),n=t.next();t.hasNext();){var i=t.next();this.addEdgeCoordinates(n,i,e),n=i}return e.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var e=new de;this.findCollapsesFromInsertedNodes(e),this.findCollapsesFromExistingVertices(e);for(var t=e.iterator();t.hasNext();){var n=t.next().intValue();this.add(this._edge.getCoordinate(n),n)}}},{key:"print",value:function(e){e.println("Intersections:");for(var t=this.iterator();t.hasNext();){t.next().print(e)}}},{key:"findCollapsesFromExistingVertices",value:function(e){for(var t=0;t<this._edge.size()-2;t++){var n=this._edge.getCoordinate(t),i=this._edge.getCoordinate(t+2);n.equals2D(i)&&e.add(new D(t+1))}}},{key:"addEdgeCoordinates",value:function(e,t,n){var i=this._edge.getCoordinate(t.segmentIndex),r=t.isInterior()||!t.coord.equals2D(i);n.add(new L(e.coord),!1);for(var s=e.segmentIndex+1;s<=t.segmentIndex;s++)n.add(this._edge.getCoordinate(s));r&&n.add(new L(t.coord))}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(e){this.addEndpoints(),this.addCollapsedNodes();for(var t=this.iterator(),n=t.next();t.hasNext();){var i=t.next(),r=this.createSplitEdge(n,i);e.add(r),n=i}}},{key:"findCollapseIndex",value:function(e,t,n){if(!e.coord.equals2D(t.coord))return!1;var i=t.segmentIndex-e.segmentIndex;return t.isInterior()||i--,1===i&&(n[0]=e.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(e){for(var t=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,t)&&e.add(new D(t[0])),i=r}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var e=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(e),e)}},{key:"createSplitEdge",value:function(e,t){var n=t.segmentIndex-e.segmentIndex+2,i=this._edge.getCoordinate(t.segmentIndex),r=t.isInterior()||!t.coord.equals2D(i);r||n--;var s=new Array(n).fill(null),o=0;s[o++]=new L(e.coord);for(var a=e.segmentIndex+1;a<=t.segmentIndex;a++)s[o++]=this._edge.getCoordinate(a);return r&&(s[o]=new L(t.coord)),new Ht(s,this._edge.getData())}},{key:"add",value:function(e,t){var n=new Vt(this._edge,e,t,this._edge.getSegmentOctant(t)),i=this._nodeMap.get(n);return null!==i?(Q.isTrue(i.coord.equals2D(e),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)}},{key:"checkSplitEdgesCorrectness",value:function(e){var t=this._edge.getCoordinates(),n=e.get(0).getCoordinate(0);if(!n.equals2D(t[0]))throw new K("bad split edge start point at "+n);var i=e.get(e.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(t[t.length-1]))throw new K("bad split edge end point at "+r)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Xt=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"octant",value:function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],n=arguments[1];if(0===t&&0===n)throw new x("Cannot compute the octant for point ( "+t+", "+n+" )");var i=Math.abs(t),r=Math.abs(n);return t>=0?n>=0?i>=r?0:1:i>=r?7:6:n>=0?i>=r?3:2:i>=r?4:5}if(arguments[0]instanceof L&&arguments[1]instanceof L){var s=arguments[0],o=arguments[1],a=o.x-s.x,u=o.y-s.y;if(0===a&&0===u)throw new x("Cannot compute the octant for two identical points "+s);return e.octant(a,u)}}}]),e}(),Yt=function(){function e(){_(this,e)}return p(e,[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(e){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(e){}},{key:"getData",value:function(){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),jt=function(){function e(){_(this,e)}return p(e,[{key:"addIntersection",value:function(e,t){}},{key:"interfaces_",value:function(){return[Yt]}},{key:"getClass",value:function(){return e}}]),e}(),Ht=function(){function e(){_(this,e),this._nodeList=new Ut(this),this._pts=null,this._data=null;var t=arguments[0],n=arguments[1];this._pts=t,this._data=n}return p(e,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(e){return this._pts[e]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(e){return e===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(e),this.getCoordinate(e+1))}},{key:"setData",value:function(e){this._data=e}},{key:"safeOctant",value:function(e,t){return e.equals2D(t)?0:Xt.octant(e,t)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];this.addIntersectionNode(e,t)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[3],s=new L(n.getIntersection(r));this.addIntersection(s,i)}}},{key:"toString",value:function(){return W.toLineString(new Qe(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(e,t){var n=t,i=n+1;if(i<this._pts.length){var r=this._pts[i];e.equals2D(r)&&(n=i)}return this._nodeList.add(e,n)}},{key:"addIntersections",value:function(e,t,n){for(var i=0;i<e.getIntersectionNum();i++)this.addIntersection(e,t,n,i)}},{key:"interfaces_",value:function(){return[jt]}},{key:"getClass",value:function(){return e}}],[{key:"getNodedSubstrings",value:function(){if(1===arguments.length){var t=arguments[0],n=new de;return e.getNodedSubstrings(t,n),n}if(2===arguments.length)for(var i=arguments[0],r=arguments[1],s=i.iterator();s.hasNext();){s.next().getNodeList().addSplitEdges(r)}}}]),e}(),Wt=function(){function e(){if(_(this,e),this.p0=null,this.p1=null,0===arguments.length)this.p0=new L,this.p1=new L;else if(1===arguments.length){var t=arguments[0];this.p0=new L(t.p0),this.p1=new L(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],s=arguments[3];this.p0=new L(n,i),this.p1=new L(r,s)}}return p(e,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof e){var t=arguments[0],n=ne.orientationIndex(this.p0,this.p1,t.p0),i=ne.orientationIndex(this.p0,this.p1,t.p1);return n>=0&&i>=0?Math.max(n,i):n<=0&&i<=0?Math.max(n,i):0}if(arguments[0]instanceof L){var r=arguments[0];return ne.orientationIndex(this.p0,this.p1,r)}}},{key:"toGeometry",value:function(e){return e.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(t){if(!(t instanceof e))return!1;var n=t;return this.p0.equals(n.p0)&&this.p1.equals(n.p1)}},{key:"intersection",value:function(e){var t=new $;return t.computeIntersection(this.p0,this.p1,e.p0,e.p1),t.hasIntersection()?t.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof L){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new L(t);var n=this.projectionFactor(t),i=new L;return i.x=this.p0.x+n*(this.p1.x-this.p0.x),i.y=this.p0.y+n*(this.p1.y-this.p0.y),i}if(arguments[0]instanceof e){var r=arguments[0],s=this.projectionFactor(r.p0),o=this.projectionFactor(r.p1);if(s>=1&&o>=1)return null;if(s<=0&&o<=0)return null;var a=this.project(r.p0);s<0&&(a=this.p0),s>1&&(a=this.p1);var u=this.project(r.p1);return o<0&&(u=this.p0),o>1&&(u=this.p1),new e(a,u)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(e){return 0===e?this.p0:this.p1}},{key:"distancePerpendicular",value:function(e){return ne.distancePointLinePerpendicular(e,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return e.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;var t=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=t*t+n*n;if(i<=0)return E.NaN;return((e.x-this.p0.x)*t+(e.y-this.p0.y)*n)/i}},{key:"closestPoints",value:function(e){var t=this.intersection(e);if(null!==t)return[t,t];var n=new Array(2).fill(null),i=E.MAX_VALUE,r=null,s=this.closestPoint(e.p0);i=s.distance(e.p0),n[0]=s,n[1]=e.p0;var o=this.closestPoint(e.p1);(r=o.distance(e.p1))<i&&(i=r,n[0]=o,n[1]=e.p1);var a=e.closestPoint(this.p0);(r=a.distance(this.p0))<i&&(i=r,n[0]=this.p0,n[1]=a);var u=e.closestPoint(this.p1);return(r=u.distance(this.p1))<i&&(i=r,n[0]=this.p1,n[1]=u),n}},{key:"closestPoint",value:function(e){var t=this.projectionFactor(e);if(t>0&&t<1)return this.project(e);return this.p0.distance(e)<this.p1.distance(e)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(e){var t=e,n=this.p0.compareTo(t.p0);return 0!==n?n:this.p1.compareTo(t.p1)}},{key:"reverse",value:function(){var e=this.p0;this.p0=this.p1,this.p1=e}},{key:"equalsTopo",value:function(e){return this.p0.equals(e.p0)&&(this.p1.equals(e.p1)||this.p0.equals(e.p1))&&this.p1.equals(e.p0)}},{key:"lineIntersection",value:function(e){try{return V.intersection(this.p0,this.p1,e.p0,e.p1)}catch(e){if(!(e instanceof B))throw e}return null}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(e,t){var n=this.p0.x+e*(this.p1.x-this.p0.x),i=this.p0.y+e*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,o=Math.sqrt(r*r+s*s),a=0,u=0;if(0!==t){if(o<=0)throw new Error("Cannot compute offset from zero-length line segment");a=t*r/o,u=t*s/o}return new L(n-u,i+a)}},{key:"setCoordinates",value:function(){if(1===arguments.length){var e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(2===arguments.length){var t=arguments[0],n=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=n.x,this.p1.y=n.y}}},{key:"segmentFraction",value:function(e){var t=this.projectionFactor(e);return t<0?t=0:(t>1||E.isNaN(t))&&(t=1),t}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"distance",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return ne.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof L){var n=arguments[0];return ne.distancePointLine(n,this.p0,this.p1)}}},{key:"pointAlong",value:function(e){var t=new L;return t.x=this.p0.x+e*(this.p1.x-this.p0.x),t.y=this.p0.y+e*(this.p1.y-this.p0.y),t}},{key:"hashCode",value:function(){var e=E.doubleToLongBits(this.p0.x);e^=31*E.doubleToLongBits(this.p0.y);var t=Math.trunc(e)^Math.trunc(e>>32),n=E.doubleToLongBits(this.p1.x);n^=31*E.doubleToLongBits(this.p1.y);return t^(Math.trunc(n)^Math.trunc(n>>32))}},{key:"interfaces_",value:function(){return[N,t]}},{key:"getClass",value:function(){return e}}],[{key:"midPoint",value:function(e,t){return new L((e.x+t.x)/2,(e.y+t.y)/2)}},{key:"serialVersionUID",get:function(){return 0x2d2172135f411c00}}]),e}(),Kt=function(){function e(){_(this,e),this.tempEnv1=new U,this.tempEnv2=new U,this._overlapSeg1=new Wt,this._overlapSeg2=new Wt}return p(e,[{key:"overlap",value:function(){if(2===arguments.length);else if(4===arguments.length){var e=arguments[0],t=arguments[1],n=arguments[2],i=arguments[3];e.getLineSegment(t,this._overlapSeg1),n.getLineSegment(i,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Jt=function(){function e(){_(this,e),this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3];this._pts=t,this._start=n,this._end=i,this._context=r}return p(e,[{key:"getLineSegment",value:function(e,t){t.p0=this._pts[e],t.p1=this._pts[e+1]}},{key:"computeSelect",value:function(e,t,n,i){var r=this._pts[t],s=this._pts[n];if(i.tempEnv1.init(r,s),n-t==1)return i.select(this,t),null;if(!e.intersects(i.tempEnv1))return null;var o=Math.trunc((t+n)/2);t<o&&this.computeSelect(e,t,o,i),o<n&&this.computeSelect(e,o,n,i)}},{key:"getCoordinates",value:function(){for(var e=new Array(this._end-this._start+1).fill(null),t=0,n=this._start;n<=this._end;n++)e[t++]=this._pts[n];return e}},{key:"computeOverlaps",value:function(e,t){this.computeOverlapsInternal(this._start,this._end,e,e._start,e._end,t)}},{key:"setId",value:function(e){this._id=e}},{key:"select",value:function(e,t){this.computeSelect(e,this._start,this._end,t)}},{key:"getEnvelope",value:function(){if(null===this._env){var e=this._pts[this._start],t=this._pts[this._end];this._env=new U(e,t)}return this._env}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}},{key:"computeOverlapsInternal",value:function(e,t,n,i,r,s){var o=this._pts[e],a=this._pts[t],u=n._pts[i],l=n._pts[r];if(t-e==1&&r-i==1)return s.overlap(this,e,n,i),null;if(s.tempEnv1.init(o,a),s.tempEnv2.init(u,l),!s.tempEnv1.intersects(s.tempEnv2))return null;var h=Math.trunc((e+t)/2),c=Math.trunc((i+r)/2);e<h&&(i<c&&this.computeOverlapsInternal(e,h,n,i,c,s),c<r&&this.computeOverlapsInternal(e,h,n,c,r,s)),h<t&&(i<c&&this.computeOverlapsInternal(h,t,n,i,c,s),c<r&&this.computeOverlapsInternal(h,t,n,c,r,s))}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Qt=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"getChainStartIndices",value:function(t){var n=0,i=new de;i.add(new D(n));do{var r=e.findChainEnd(t,n);i.add(new D(r)),n=r}while(n<t.length-1);return e.toIntArray(i)}},{key:"findChainEnd",value:function(e,t){for(var n=t;n<e.length-1&&e[n].equals2D(e[n+1]);)n++;if(n>=e.length-1)return e.length-1;for(var i=xt.quadrant(e[n],e[n+1]),r=t+1;r<e.length;){if(!e[r-1].equals2D(e[r])){if(xt.quadrant(e[r-1],e[r])!==i)break}r++}return r-1}},{key:"getChains",value:function(){if(1===arguments.length){var t=arguments[0];return e.getChains(t,null)}if(2===arguments.length){for(var n=arguments[0],i=arguments[1],r=new de,s=e.getChainStartIndices(n),o=0;o<s.length-1;o++){var a=new Jt(n,s[o],s[o+1],i);r.add(a)}return r}}},{key:"toIntArray",value:function(e){for(var t=new Array(e.size()).fill(null),n=0;n<t.length;n++)t[n]=e.get(n).intValue();return t}}]),e}(),Zt=function(){function e(){_(this,e)}return p(e,[{key:"computeNodes",value:function(e){}},{key:"getNodedSubstrings",value:function(){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),$t=function(){function e(){if(_(this,e),this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}}return p(e,[{key:"setSegmentIntersector",value:function(e){this._segInt=e}},{key:"interfaces_",value:function(){return[Zt]}},{key:"getClass",value:function(){return e}}]),e}(),en=function(e){function t(e){if(_(this,t),e)n=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));else var n=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._monoChains=new de,n._index=new qt,n._idCounter=0,n._nodedSegStrings=null,n._nOverlaps=0,k(n)}return m(t,$t),p(t,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return Ht.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(e){for(var t=Qt.getChains(e.getCoordinates(),e).iterator();t.hasNext();){var n=t.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}}},{key:"computeNodes",value:function(e){this._nodedSegStrings=e;for(var t=e.iterator();t.hasNext();)this.add(t.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var e=new tn(this._segInt),t=this._monoChains.iterator();t.hasNext();)for(var n=t.next(),i=this._index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,e),this._nOverlaps++),this._segInt.isDone())return null}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}],[{key:"SegmentOverlapAction",get:function(){return tn}}]),t}(),tn=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._si=null;var n=arguments[0];return e._si=n,e}return m(t,Kt),p(t,[{key:"overlap",value:function(){if(4!==arguments.length)return Kt.prototype.overlap.apply(this,arguments);var e=arguments[0],t=arguments[1],n=arguments[2],i=arguments[3],r=e.getContext(),s=n.getContext();this._si.processIntersections(r,t,s,i)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),nn=function(){function e(){if(_(this,e),this._quadrantSegments=e.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=e.CAP_ROUND,this._joinStyle=e.JOIN_ROUND,this._mitreLimit=e.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=e.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(i)}else if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(s),this.setJoinStyle(o),this.setMitreLimit(a)}}return p(e,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=e.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=e.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==e.JOIN_ROUND&&(this._quadrantSegments=e.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(e){this._joinStyle=e}},{key:"setSimplifyFactor",value:function(e){this._simplifyFactor=e<0?0:e}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(e){this._endCapStyle=e}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(e){this._mitreLimit=e}},{key:"setSingleSided",value:function(e){this._isSingleSided=e}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"bufferDistanceError",value:function(e){var t=Math.PI/2/e;return 1-Math.cos(t/2)}},{key:"CAP_ROUND",get:function(){return 1}},{key:"CAP_FLAT",get:function(){return 2}},{key:"CAP_SQUARE",get:function(){return 3}},{key:"JOIN_ROUND",get:function(){return 1}},{key:"JOIN_MITRE",get:function(){return 2}},{key:"JOIN_BEVEL",get:function(){return 3}},{key:"DEFAULT_QUADRANT_SEGMENTS",get:function(){return 8}},{key:"DEFAULT_MITRE_LIMIT",get:function(){return 5}},{key:"DEFAULT_SIMPLIFY_FACTOR",get:function(){return.01}}]),e}(),rn=function(){function e(t){_(this,e),this._distanceTol=null,this._isDeleted=null,this._angleOrientation=ne.COUNTERCLOCKWISE,this._inputLine=t||null}return p(e,[{key:"isDeletable",value:function(e,t,n,i){var r=this._inputLine[e],s=this._inputLine[t],o=this._inputLine[n];return!!this.isConcave(r,s,o)&&(!!this.isShallow(r,s,o,i)&&this.isShallowSampled(r,s,e,n,i))}},{key:"deleteShallowConcavities",value:function(){for(var t=1,n=this.findNextNonDeletedIndex(t),i=this.findNextNonDeletedIndex(n),r=!1;i<this._inputLine.length;){var s=!1;this.isDeletable(t,n,i,this._distanceTol)&&(this._isDeleted[n]=e.DELETE,s=!0,r=!0),t=s?i:n,n=this.findNextNonDeletedIndex(t),i=this.findNextNonDeletedIndex(n)}return r}},{key:"isShallowConcavity",value:function(e,t,n,i){if(!(ne.computeOrientation(e,t,n)===this._angleOrientation))return!1;return ne.distancePointLine(t,e,n)<i}},{key:"isShallowSampled",value:function(t,n,i,r,s){var o=Math.trunc((r-i)/e.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var a=i;a<r;a+=o)if(!this.isShallow(t,n,this._inputLine[a],s))return!1;return!0}},{key:"isConcave",value:function(e,t,n){var i=ne.computeOrientation(e,t,n)===this._angleOrientation;return i}},{key:"simplify",value:function(e){this._distanceTol=Math.abs(e),e<0&&(this._angleOrientation=ne.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var t=!1;do{t=this.deleteShallowConcavities()}while(t);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(t){for(var n=t+1;n<this._inputLine.length&&this._isDeleted[n]===e.DELETE;)n++;return n}},{key:"isShallow",value:function(e,t,n,i){return ne.distancePointLine(t,e,n)<i}},{key:"collapseLine",value:function(){for(var t=new pe,n=0;n<this._inputLine.length;n++)this._isDeleted[n]!==e.DELETE&&t.add(this._inputLine[n]);return t.toCoordinateArray()}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"simplify",value:function(t,n){return new e(t).simplify(n)}},{key:"INIT",get:function(){return 0}},{key:"DELETE",get:function(){return 1}},{key:"KEEP",get:function(){return 1}},{key:"NUM_PTS_TO_CHECK",get:function(){return 10}}]),e}(),sn=function(){function e(){_(this,e),this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new de}return p(e,[{key:"getCoordinates",value:function(){return this._ptList.toArray(e.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(e){this._precisionModel=e}},{key:"addPt",value:function(e){var t=new L(e);if(this._precisionModel.makePrecise(t),this.isRedundant(t))return null;this._ptList.add(t)}},{key:"revere",value:function(){}},{key:"addPts",value:function(e,t){if(t)for(var n=0;n<e.length;n++)this.addPt(e[n]);else for(var i=e.length-1;i>=0;i--)this.addPt(e[i])}},{key:"isRedundant",value:function(e){if(this._ptList.size()<1)return!1;var t=this._ptList.get(this._ptList.size()-1);return e.distance(t)<this._minimimVertexDistance}},{key:"toString",value:function(){return(new nt).createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var e=new L(this._ptList.get(0)),t=this._ptList.get(this._ptList.size()-1);if(e.equals(t))return null;this._ptList.add(e)}},{key:"setMinimumVertexDistance",value:function(e){this._minimimVertexDistance=e}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"COORDINATE_ARRAY_TYPE",get:function(){return new Array(0).fill(null)}}]),e}(),on=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"toDegrees",value:function(e){return 180*e/Math.PI}},{key:"normalize",value:function(t){for(;t>Math.PI;)t-=e.PI_TIMES_2;for(;t<=-Math.PI;)t+=e.PI_TIMES_2;return t}},{key:"angle",value:function(){if(1===arguments.length){var e=arguments[0];return Math.atan2(e.y,e.x)}if(2===arguments.length){var t=arguments[0],n=arguments[1],i=n.x-t.x,r=n.y-t.y;return Math.atan2(r,i)}}},{key:"isAcute",value:function(e,t,n){var i=e.x-t.x,r=e.y-t.y;return i*(n.x-t.x)+r*(n.y-t.y)>0}},{key:"isObtuse",value:function(e,t,n){var i=e.x-t.x,r=e.y-t.y;return i*(n.x-t.x)+r*(n.y-t.y)<0}},{key:"interiorAngle",value:function(t,n,i){var r=e.angle(n,t),s=e.angle(n,i);return Math.abs(s-r)}},{key:"normalizePositive",value:function(t){if(t<0){for(;t<0;)t+=e.PI_TIMES_2;t>=e.PI_TIMES_2&&(t=0)}else{for(;t>=e.PI_TIMES_2;)t-=e.PI_TIMES_2;t<0&&(t=0)}return t}},{key:"angleBetween",value:function(t,n,i){var r=e.angle(n,t),s=e.angle(n,i);return e.diff(r,s)}},{key:"diff",value:function(e,t){var n=null;return(n=e<t?t-e:e-t)>Math.PI&&(n=2*Math.PI-n),n}},{key:"toRadians",value:function(e){return e*Math.PI/180}},{key:"getTurn",value:function(t,n){var i=Math.sin(n-t);return i>0?e.COUNTERCLOCKWISE:i<0?e.CLOCKWISE:e.NONE}},{key:"angleBetweenOriented",value:function(t,n,i){var r=e.angle(n,t),s=e.angle(n,i)-r;return s<=-Math.PI?s+e.PI_TIMES_2:s>Math.PI?s-e.PI_TIMES_2:s}},{key:"PI_TIMES_2",get:function(){return 2*Math.PI}},{key:"PI_OVER_2",get:function(){return Math.PI/2}},{key:"PI_OVER_4",get:function(){return Math.PI/4}},{key:"COUNTERCLOCKWISE",get:function(){return ne.COUNTERCLOCKWISE}},{key:"CLOCKWISE",get:function(){return ne.CLOCKWISE}},{key:"NONE",get:function(){return ne.COLLINEAR}}]),e}(),an=function(){function e(){_(this,e),this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Wt,this._seg1=new Wt,this._offset0=new Wt,this._offset1=new Wt,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],n=arguments[1],i=arguments[2];this._precisionModel=t,this._bufParams=n,this._li=new $,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===nn.JOIN_ROUND&&(this._closingSegLengthFactor=e.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)}return p(e,[{key:"addNextSegment",value:function(e,t){if(this._s0=this._s1,this._s1=this._s2,this._s2=e,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=ne.computeOrientation(this._s0,this._s1,this._s2),i=n===ne.CLOCKWISE&&this._side===lt.LEFT||n===ne.COUNTERCLOCKWISE&&this._side===lt.RIGHT;0===n?this.addCollinear(t):i?this.addOutsideTurn(n,t):this.addInsideTurn(n,t)}},{key:"addLineEndCap",value:function(e,t){var n=new Wt(e,t),i=new Wt;this.computeOffsetSegment(n,lt.LEFT,this._distance,i);var r=new Wt;this.computeOffsetSegment(n,lt.RIGHT,this._distance,r);var s=t.x-e.x,o=t.y-e.y,a=Math.atan2(o,s);switch(this._bufParams.getEndCapStyle()){case nn.CAP_ROUND:this._segList.addPt(i.p1),this.addFilletArc(t,a+Math.PI/2,a-Math.PI/2,ne.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case nn.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case nn.CAP_SQUARE:var u=new L;u.x=Math.abs(this._distance)*Math.cos(a),u.y=Math.abs(this._distance)*Math.sin(a);var l=new L(i.p1.x+u.x,i.p1.y+u.y),h=new L(r.p1.x+u.x,r.p1.y+u.y);this._segList.addPt(l),this._segList.addPt(h)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(e,t,n,i){var r=!0,s=null;try{s=V.intersection(t.p0,t.p1,n.p0,n.p1);(i<=0?1:s.distance(e)/Math.abs(i))>this._bufParams.getMitreLimit()&&(r=!1)}catch(e){if(!(e instanceof B))throw e;s=new L(0,0),r=!1}r?this._segList.addPt(s):this.addLimitedMitreJoin(t,n,i,this._bufParams.getMitreLimit())}},{key:"addFilletCorner",value:function(e,t,n,i,r){var s=t.x-e.x,o=t.y-e.y,a=Math.atan2(o,s),u=n.x-e.x,l=n.y-e.y,h=Math.atan2(l,u);i===ne.CLOCKWISE?a<=h&&(a+=2*Math.PI):a>=h&&(a-=2*Math.PI),this._segList.addPt(t),this.addFilletArc(e,a,h,i,r),this._segList.addPt(n)}},{key:"addOutsideTurn",value:function(t,n){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*e.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===nn.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===nn.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(n&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(e){this._segList.addPt(new L(e.x+this._distance,e.y+this._distance)),this._segList.addPt(new L(e.x+this._distance,e.y-this._distance)),this._segList.addPt(new L(e.x-this._distance,e.y-this._distance)),this._segList.addPt(new L(e.x-this._distance,e.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(e,t){this._segList.addPts(e,t)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(e,t,n){this._s1=e,this._s2=t,this._side=n,this._seg1.setCoordinates(e,t),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(e,t,n,i){var r=this._seg0.p1,s=on.angle(r,this._seg0.p0),o=on.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=on.normalize(s+o),u=on.normalize(a+Math.PI),l=i*n,h=n-l*Math.abs(Math.sin(o)),c=r.x+l*Math.cos(u),f=r.y+l*Math.sin(u),g=new L(c,f),y=new Wt(r,g),v=y.pointAlongOffset(1,h),d=y.pointAlongOffset(1,-h);this._side===lt.LEFT?(this._segList.addPt(v),this._segList.addPt(d)):(this._segList.addPt(d),this._segList.addPt(v))}},{key:"computeOffsetSegment",value:function(e,t,n,i){var r=t===lt.LEFT?1:-1,s=e.p1.x-e.p0.x,o=e.p1.y-e.p0.y,a=Math.sqrt(s*s+o*o),u=r*n*s/a,l=r*n*o/a;i.p0.x=e.p0.x-l,i.p0.y=e.p0.y+u,i.p1.x=e.p1.x-l,i.p1.y=e.p1.y+u}},{key:"addFilletArc",value:function(e,t,n,i,r){var s=i===ne.CLOCKWISE?-1:1,o=Math.abs(t-n),a=Math.trunc(o/this._filletAngleQuantum+.5);if(a<1)return null;for(var u=o/a,l=0,h=new L;l<o;){var c=t+s*l;h.x=e.x+r*Math.cos(c),h.y=e.y+r*Math.sin(c),this._segList.addPt(h),l+=u}}},{key:"addInsideTurn",value:function(t,n){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*e.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var i=new L((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i);var r=new L((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(e){var t=new L(e.x+this._distance,e.y);this._segList.addPt(t),this.addFilletArc(e,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(e,t){this._segList.addPt(e.p1),this._segList.addPt(t.p0)}},{key:"init",value:function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new sn,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*e.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(e){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===nn.JOIN_BEVEL||this._bufParams.getJoinStyle()===nn.JOIN_MITRE?(e&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,ne.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"OFFSET_SEGMENT_SEPARATION_FACTOR",get:function(){return.001}},{key:"INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR",get:function(){return.001}},{key:"CURVE_VERTEX_SNAP_DISTANCE_FACTOR",get:function(){return 1e-6}},{key:"MAX_CLOSING_SEG_LEN_FACTOR",get:function(){return 80}}]),e}(),un=function(){function e(){_(this,e),this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],n=arguments[1];this._precisionModel=t,this._bufParams=n}return p(e,[{key:"getOffsetCurve",value:function(e,t){if(this._distance=t,0===t)return null;var n=t<0,i=Math.abs(t),r=this.getSegGen(i);e.length<=1?this.computePointCurve(e[0],r):this.computeOffsetCurve(e,n,r);var s=r.getCoordinates();return n&&me.reverse(s),s}},{key:"computeSingleSidedBufferCurve",value:function(e,t,n){var i=this.simplifyTolerance(this._distance);if(t){n.addSegments(e,!0);var r=rn.simplify(e,-i),s=r.length-1;n.initSideSegments(r[s],r[s-1],lt.LEFT),n.addFirstSegment();for(var o=s-2;o>=0;o--)n.addNextSegment(r[o],!0)}else{n.addSegments(e,!1);var a=rn.simplify(e,i),u=a.length-1;n.initSideSegments(a[0],a[1],lt.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment(),n.closeRing()}},{key:"computeRingBufferCurve",value:function(e,t,n){var i=this.simplifyTolerance(this._distance);t===lt.RIGHT&&(i=-i);var r=rn.simplify(e,i),s=r.length-1;n.initSideSegments(r[s-1],r[0],t);for(var o=1;o<=s;o++){var a=1!==o;n.addNextSegment(r[o],a)}n.closeRing()}},{key:"computeLineBufferCurve",value:function(e,t){var n=this.simplifyTolerance(this._distance),i=rn.simplify(e,n),r=i.length-1;t.initSideSegments(i[0],i[1],lt.LEFT);for(var s=2;s<=r;s++)t.addNextSegment(i[s],!0);t.addLastSegment(),t.addLineEndCap(i[r-1],i[r]);var o=rn.simplify(e,-n),a=o.length-1;t.initSideSegments(o[a],o[a-1],lt.LEFT);for(var u=a-2;u>=0;u--)t.addNextSegment(o[u],!0);t.addLastSegment(),t.addLineEndCap(o[1],o[0]),t.closeRing()}},{key:"computePointCurve",value:function(e,t){switch(this._bufParams.getEndCapStyle()){case nn.CAP_ROUND:t.createCircle(e);break;case nn.CAP_SQUARE:t.createSquare(e)}}},{key:"getLineCurve",value:function(e,t){if(this._distance=t,t<0&&!this._bufParams.isSingleSided())return null;if(0===t)return null;var n=Math.abs(t),i=this.getSegGen(n);if(e.length<=1)this.computePointCurve(e[0],i);else if(this._bufParams.isSingleSided()){var r=t<0;this.computeSingleSidedBufferCurve(e,r,i)}else this.computeLineBufferCurve(e,i);return i.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(e){return e*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(t,n,i){if(this._distance=i,t.length<=2)return this.getLineCurve(t,i);if(0===i)return e.copyCoordinates(t);var r=this.getSegGen(i);return this.computeRingBufferCurve(t,n,r),r.getCoordinates()}},{key:"computeOffsetCurve",value:function(e,t,n){var i=this.simplifyTolerance(this._distance);if(t){var r=rn.simplify(e,-i),s=r.length-1;n.initSideSegments(r[s],r[s-1],lt.LEFT),n.addFirstSegment();for(var o=s-2;o>=0;o--)n.addNextSegment(r[o],!0)}else{var a=rn.simplify(e,i),u=a.length-1;n.initSideSegments(a[0],a[1],lt.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment()}},{key:"getSegGen",value:function(e){return new an(this._precisionModel,this._bufParams,e)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"copyCoordinates",value:function(e){for(var t=new Array(e.length).fill(null),n=0;n<t.length;n++)t[n]=new L(e[n]);return t}}]),e}(),ln=function(){function e(){_(this,e),this._subgraphs=null,this._seg=new Wt,this._cga=new ne;var t=arguments[0];this._subgraphs=t}return p(e,[{key:"findStabbedSegments",value:function(){if(1===arguments.length){for(var e=arguments[0],t=new de,n=this._subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();e.y<r.getMinY()||e.y>r.getMaxY()||this.findStabbedSegments(e,i.getDirectedEdges(),t)}return t}if(3===arguments.length)if(R(arguments[2],ve)&&arguments[0]instanceof L&&arguments[1]instanceof Nt)for(var s=arguments[0],o=arguments[1],a=arguments[2],u=o.getEdge().getCoordinates(),l=0;l<u.length-1;l++){this._seg.p0=u[l],this._seg.p1=u[l+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse();if(!(Math.max(this._seg.p0.x,this._seg.p1.x)<s.x)&&!(this._seg.isHorizontal()||s.y<this._seg.p0.y||s.y>this._seg.p1.y||ne.computeOrientation(this._seg.p0,this._seg.p1,s)===ne.RIGHT)){var h=o.getDepth(lt.LEFT);this._seg.p0.equals(u[l])||(h=o.getDepth(lt.RIGHT));var c=new hn(this._seg,h);a.add(c)}}else if(R(arguments[2],ve)&&arguments[0]instanceof L&&R(arguments[1],ve))for(var f=arguments[0],g=arguments[1],y=arguments[2],v=g.iterator();v.hasNext();){var d=v.next();d.isForward()&&this.findStabbedSegments(f,d,y)}}},{key:"getDepth",value:function(e){var t=this.findStabbedSegments(e);if(0===t.size())return 0;return Dt.min(t)._leftDepth}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"DepthSegment",get:function(){return hn}}]),e}(),hn=function(){function e(){_(this,e),this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],n=arguments[1];this._upwardSeg=new Wt(t),this._leftDepth=n}return p(e,[{key:"compareTo",value:function(e){var t=e;if(this._upwardSeg.minX()>=t._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=t._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(t._upwardSeg);return 0!==n?n:0!=(n=-1*t._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(t._upwardSeg)}},{key:"compareX",value:function(e,t){var n=e.p0.compareTo(t.p0);return 0!==n?n:e.p1.compareTo(t.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",value:function(){return[N]}},{key:"getClass",value:function(){return e}}]),e}(),cn=function(){function e(t,n,i){_(this,e),this.p0=t||null,this.p1=n||null,this.p2=i||null}return p(e,[{key:"area",value:function(){return e.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return e.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(t){if(null===t)throw new x("Supplied point is null.");return e.interpolateZ(t,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return e.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return e.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return e.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return e.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return e.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return e.inCentre(this.p0,this.p1,this.p2)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"area",value:function(e,t,n){return Math.abs(((n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y))/2)}},{key:"signedArea",value:function(e,t,n){return((n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y))/2}},{key:"det",value:function(e,t,n,i){return e*i-t*n}},{key:"interpolateZ",value:function(e,t,n,i){var r=t.x,s=t.y,o=n.x-r,a=i.x-r,u=n.y-s,l=i.y-s,h=o*l-a*u,c=e.x-r,f=e.y-s,g=(l*c-a*f)/h,y=(-u*c+o*f)/h;return t.z+g*(n.z-t.z)+y*(i.z-t.z)}},{key:"longestSideLength",value:function(e,t,n){var i=e.distance(t),r=t.distance(n),s=n.distance(e),o=i;return r>o&&(o=r),s>o&&(o=s),o}},{key:"isAcute",value:function(e,t,n){return!!on.isAcute(e,t,n)&&(!!on.isAcute(t,n,e)&&!!on.isAcute(n,e,t))}},{key:"circumcentre",value:function(t,n,i){var r=i.x,s=i.y,o=t.x-r,a=t.y-s,u=n.x-r,l=n.y-s,h=2*e.det(o,a,u,l),c=e.det(a,o*o+a*a,l,u*u+l*l),f=e.det(o,o*o+a*a,u,u*u+l*l);return new L(r-c/h,s+f/h)}},{key:"perpendicularBisector",value:function(e,t){var n=t.x-e.x,i=t.y-e.y,r=new V(e.x+n/2,e.y+i/2,1),s=new V(e.x-i+n/2,e.y+n+i/2,1);return new V(r,s)}},{key:"angleBisector",value:function(e,t,n){var i=t.distance(e),r=i/(i+t.distance(n)),s=n.x-e.x,o=n.y-e.y;return new L(e.x+r*s,e.y+r*o)}},{key:"area3D",value:function(e,t,n){var i=t.x-e.x,r=t.y-e.y,s=t.z-e.z,o=n.x-e.x,a=n.y-e.y,u=n.z-e.z,l=r*u-s*a,h=s*o-i*u,c=i*a-r*o,f=l*l+h*h+c*c,g=Math.sqrt(f)/2;return g}},{key:"centroid",value:function(e,t,n){var i=(e.x+t.x+n.x)/3,r=(e.y+t.y+n.y)/3;return new L(i,r)}},{key:"inCentre",value:function(e,t,n){var i=t.distance(n),r=e.distance(n),s=e.distance(t),o=i+r+s,a=(i*e.x+r*t.x+s*n.x)/o,u=(i*e.y+r*t.y+s*n.y)/o;return new L(a,u)}}]),e}(),fn=function(){function e(){_(this,e),this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new de;var t=arguments[0],n=arguments[1],i=arguments[2];this._inputGeom=t,this._distance=n,this._curveBuilder=i}return p(e,[{key:"addPoint",value:function(e){if(this._distance<=0)return null;var t=e.getCoordinates(),n=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(n,O.EXTERIOR,O.INTERIOR)}},{key:"addPolygon",value:function(e){var t=this._distance,n=lt.LEFT;this._distance<0&&(t=-this._distance,n=lt.RIGHT);var i=e.getExteriorRing(),r=me.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,t,n,O.EXTERIOR,O.INTERIOR);for(var s=0;s<e.getNumInteriorRing();s++){var o=e.getInteriorRingN(s),a=me.removeRepeatedPoints(o.getCoordinates());this._distance>0&&this.isErodedCompletely(o,-this._distance)||this.addPolygonRing(a,t,lt.opposite(n),O.INTERIOR,O.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(e,t){var n=new cn(e[0],e[1],e[2]),i=n.inCentre();return ne.distancePointLine(i,n.p0,n.p1)<Math.abs(t)}},{key:"addLineString",value:function(e){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var t=me.removeRepeatedPoints(e.getCoordinates()),n=this._curveBuilder.getLineCurve(t,this._distance);this.addCurve(n,O.EXTERIOR,O.INTERIOR)}},{key:"addCurve",value:function(e,t,n){if(null===e||e.length<2)return null;var i=new Ht(e,new vt(0,O.BOUNDARY,t,n));this._curveList.add(i)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"addPolygonRing",value:function(e,t,n,i,r){if(0===t&&e.length<Ye.MINIMUM_VALID_SIZE)return null;var s=i,o=r;e.length>=Ye.MINIMUM_VALID_SIZE&&ne.isCCW(e)&&(s=r,o=i,n=lt.opposite(n));var a=this._curveBuilder.getRingCurve(e,n,t);this.addCurve(a,s,o)}},{key:"add",value:function(e){if(e.isEmpty())return null;e instanceof Ue?this.addPolygon(e):e instanceof qe?this.addLineString(e):e instanceof ze?this.addPoint(e):e instanceof Xe?this.addCollection(e):e instanceof De?this.addCollection(e):e instanceof je?this.addCollection(e):e instanceof be&&this.addCollection(e)}},{key:"isErodedCompletely",value:function(e,t){var n=e.getCoordinates();if(n.length<4)return t<0;if(4===n.length)return this.isTriangleErodedCompletely(n,t);var i=e.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return t<0&&2*Math.abs(t)>r}},{key:"addCollection",value:function(e){for(var t=0;t<e.getNumGeometries();t++){var n=e.getGeometryN(t);this.add(n)}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),gn=function(){function e(){_(this,e)}return p(e,[{key:"locate",value:function(e){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),yn=function(){function e(){_(this,e),this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()}return p(e,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,e.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new n;var t=this._parent.getGeometryN(this._index++);return t instanceof be?(this._subcollectionIterator=new e(t),this._subcollectionIterator.next()):t}},{key:"remove",value:function(){throw new Error(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",value:function(){return[ye]}},{key:"getClass",value:function(){return e}}],[{key:"isAtomic",value:function(e){return!(e instanceof be)}}]),e}(),vn=function(){function e(){_(this,e),this._geom=null;var t=arguments[0];this._geom=t}return p(e,[{key:"locate",value:function(t){return e.locate(t,this._geom)}},{key:"interfaces_",value:function(){return[gn]}},{key:"getClass",value:function(){return e}}],[{key:"isPointInRing",value:function(e,t){return!!t.getEnvelopeInternal().intersects(e)&&ne.isPointInRing(e,t.getCoordinates())}},{key:"containsPointInPolygon",value:function(t,n){if(n.isEmpty())return!1;var i=n.getExteriorRing();if(!e.isPointInRing(t,i))return!1;for(var r=0;r<n.getNumInteriorRing();r++){var s=n.getInteriorRingN(r);if(e.isPointInRing(t,s))return!1}return!0}},{key:"containsPoint",value:function(t,n){if(n instanceof Ue)return e.containsPointInPolygon(t,n);if(n instanceof be)for(var i=new yn(n);i.hasNext();){var r=i.next();if(r!==n&&e.containsPoint(t,r))return!0}return!1}},{key:"locate",value:function(t,n){return n.isEmpty()?O.EXTERIOR:e.containsPoint(t,n)?O.INTERIOR:O.EXTERIOR}}]),e}(),dn=function(){function e(){_(this,e),this._edgeMap=new h,this._edgeList=null,this._ptInAreaLocation=[O.NONE,O.NONE]}return p(e,[{key:"getNextCW",value:function(e){this.getEdges();var t=this._edgeList.indexOf(e),n=t-1;return 0===t&&(n=this._edgeList.size()-1),this._edgeList.get(n)}},{key:"propagateSideLabels",value:function(e){for(var t=O.NONE,n=this.iterator();n.hasNext();){var i=n.next().getLabel();i.isArea(e)&&i.getLocation(e,lt.LEFT)!==O.NONE&&(t=i.getLocation(e,lt.LEFT))}if(t===O.NONE)return null;for(var r=t,s=this.iterator();s.hasNext();){var o=s.next(),a=o.getLabel();if(a.getLocation(e,lt.ON)===O.NONE&&a.setLocation(e,lt.ON,r),a.isArea(e)){var u=a.getLocation(e,lt.LEFT),l=a.getLocation(e,lt.RIGHT);if(l!==O.NONE){if(l!==r)throw new ct("side location conflict",o.getCoordinate());u===O.NONE&&Q.shouldNeverReachHere("found single null side (at "+o.getCoordinate()+")"),r=u}else Q.isTrue(a.getLocation(e,lt.LEFT)===O.NONE,"found single null side"),a.setLocation(e,lt.RIGHT,r),a.setLocation(e,lt.LEFT,r)}}}},{key:"getCoordinate",value:function(){var e=this.iterator();if(!e.hasNext())return null;return e.next().getCoordinate()}},{key:"print",value:function(e){z.out.println("EdgeEndStar:   "+this.getCoordinate());for(var t=this.iterator();t.hasNext();){t.next().print(e)}}},{key:"isAreaLabelsConsistent",value:function(e){return this.computeEdgeEndLabels(e.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(e){var t=this.getEdges();if(t.size()<=0)return!0;var n=t.size()-1,i=t.get(n).getLabel().getLocation(e,lt.LEFT);Q.isTrue(i!==O.NONE,"Found unlabelled area edge");for(var r=i,s=this.iterator();s.hasNext();){var o=s.next().getLabel();Q.isTrue(o.isArea(e),"Found non-area edge");var a=o.getLocation(e,lt.LEFT),u=o.getLocation(e,lt.RIGHT);if(a===u)return!1;if(u!==r)return!1;r=a}return!0}},{key:"findIndex",value:function(e){this.iterator();for(var t=0;t<this._edgeList.size();t++){if(this._edgeList.get(t)===e)return t}return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return null===this._edgeList&&(this._edgeList=new de(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(e,t,n){return this._ptInAreaLocation[e]===O.NONE&&(this._ptInAreaLocation[e]=vn.locate(t,n[e].getGeometry())),this._ptInAreaLocation[e]}},{key:"toString",value:function(){var e=new b;e.append("EdgeEndStar:   "+this.getCoordinate()),e.append("\n");for(var t=this.iterator();t.hasNext();){var n=t.next();e.append(n),e.append("\n")}return e.toString()}},{key:"computeEdgeEndLabels",value:function(e){for(var t=this.iterator();t.hasNext();){t.next().computeLabel(e)}}},{key:"computeLabelling",value:function(e){this.computeEdgeEndLabels(e[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var t=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next().getLabel(),r=0;r<2;r++)i.isLine(r)&&i.getLocation(r)===O.BOUNDARY&&(t[r]=!0);for(var s=this.iterator();s.hasNext();)for(var o=s.next(),a=o.getLabel(),u=0;u<2;u++)if(a.isAnyNull(u)){var l=O.NONE;if(t[u])l=O.EXTERIOR;else{var h=o.getCoordinate();l=this.getLocation(u,h,e)}a.setAllLocationsIfNull(u,l)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(e,t){this._edgeMap.put(e,t),this._edgeList=null}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),_n=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._resultAreaEdgeList=null,e._label=null,e._SCANNING_FOR_INCOMING=1,e._LINKING_TO_OUTGOING=2,e}return m(t,dn),p(t,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var e=null,t=null,n=this._SCANNING_FOR_INCOMING,i=0;i<this._resultAreaEdgeList.size();i++){var r=this._resultAreaEdgeList.get(i),s=r.getSym();if(r.getLabel().isArea())switch(null===e&&r.isInResult()&&(e=r),n){case this._SCANNING_FOR_INCOMING:if(!s.isInResult())continue;t=s,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;t.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===e)throw new ct("no outgoing dirEdge found",this.getCoordinate());Q.isTrue(e.isInResult(),"unable to link last incoming dirEdge"),t.setNext(e)}}},{key:"insert",value:function(e){var t=e;this.insertEdgeEnd(t,t)}},{key:"getRightmostEdge",value:function(){var e=this.getEdges(),t=e.size();if(t<1)return null;var n=e.get(0);if(1===t)return n;var i=e.get(t-1),r=n.getQuadrant(),s=i.getQuadrant();return xt.isNorthern(r)&&xt.isNorthern(s)?n:xt.isNorthern(r)||xt.isNorthern(s)?0!==n.getDy()?n:0!==i.getDy()?i:(Q.shouldNeverReachHere("found two horizontal edges incident on node"),null):i}},{key:"print",value:function(e){z.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var t=this.iterator();t.hasNext();){var n=t.next();e.print("out "),n.print(e),e.println(),e.print("in "),n.getSym().print(e),e.println()}}},{key:"getResultAreaEdges",value:function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new de;for(var e=this.iterator();e.hasNext();){var t=e.next();(t.isInResult()||t.getSym().isInResult())&&this._resultAreaEdgeList.add(t)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(e){for(var t=this.iterator();t.hasNext();){var n=t.next().getLabel();n.setAllLocationsIfNull(0,e.getLocation(0)),n.setAllLocationsIfNull(1,e.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var e=null,t=null,n=this._edgeList.size()-1;n>=0;n--){var i=this._edgeList.get(n),r=i.getSym();null===t&&(t=r),null!==e&&r.setNext(e),e=i}t.setNext(e)}},{key:"computeDepths",value:function(){if(1===arguments.length){var e=arguments[0],t=this.findIndex(e),n=e.getDepth(lt.LEFT),i=e.getDepth(lt.RIGHT),r=this.computeDepths(t+1,this._edgeList.size(),n);if(this.computeDepths(0,t,r)!==i)throw new ct("depth mismatch at "+e.getCoordinate())}else if(3===arguments.length){for(var s=arguments[0],o=arguments[1],a=arguments[2],u=s;u<o;u++){var l=this._edgeList.get(u);l.setEdgeDepths(lt.RIGHT,a),a=l.getDepth(lt.LEFT)}return a}}},{key:"mergeSymLabels",value:function(){for(var e=this.iterator();e.hasNext();){var t=e.next();t.getLabel().merge(t.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(e){for(var t=null,n=null,i=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;r>=0;r--){var s=this._resultAreaEdgeList.get(r),o=s.getSym();switch(null===t&&s.getEdgeRing()===e&&(t=s),i){case this._SCANNING_FOR_INCOMING:if(o.getEdgeRing()!==e)continue;n=o,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(s.getEdgeRing()!==e)continue;n.setNextMin(s),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(Q.isTrue(null!==t,"found null for first outgoing dirEdge"),Q.isTrue(t.getEdgeRing()===e,"unable to link last incoming dirEdge"),n.setNextMin(t))}},{key:"getOutgoingDegree",value:function(){if(0===arguments.length){for(var e=0,t=this.iterator();t.hasNext();){t.next().isInResult()&&e++}return e}if(1===arguments.length){for(var n=arguments[0],i=0,r=this.iterator();r.hasNext();){r.next().getEdgeRing()===n&&i++}return i}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var e=O.NONE,t=this.iterator();t.hasNext();){var n=t.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){e=O.INTERIOR;break}if(i.isInResult()){e=O.EXTERIOR;break}}}if(e===O.NONE)return null;for(var r=e,s=this.iterator();s.hasNext();){var o=s.next(),a=o.getSym();o.isLineEdge()?o.getEdge().setCovered(r===O.INTERIOR):(o.isInResult()&&(r=O.EXTERIOR),a.isInResult()&&(r=O.INTERIOR))}}},{key:"computeLabelling",value:function(e){dn.prototype.computeLabelling.call(this,e),this._label=new vt(O.NONE);for(var t=this.iterator();t.hasNext();)for(var n=t.next().getEdge().getLabel(),i=0;i<2;i++){var r=n.getLocation(i);r!==O.INTERIOR&&r!==O.BOUNDARY||this._label.setLocation(i,O.INTERIOR)}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),pn=function(e){function t(){return _(this,t),k(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,Ct),p(t,[{key:"createNode",value:function(e){return new kt(e,new _n)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),mn=function(){function e(){_(this,e),this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=e.orientation(t)}return p(e,[{key:"compareTo",value:function(t){var n=t;return e.compareOriented(this._pts,this._orientation,n._pts,n._orientation)}},{key:"interfaces_",value:function(){return[N]}},{key:"getClass",value:function(){return e}}],[{key:"orientation",value:function(e){return 1===me.increasingDirection(e)}},{key:"compareOriented",value:function(e,t,n,i){for(var r=t?1:-1,s=i?1:-1,o=t?e.length:-1,a=i?n.length:-1,u=t?0:e.length-1,l=i?0:n.length-1;;){var h=e[u].compareTo(n[l]);if(0!==h)return h;var c=(u+=r)===o,f=(l+=s)===a;if(c&&!f)return-1;if(!c&&f)return 1;if(c&&f)return 0}}}]),e}(),kn=function(){function e(){_(this,e),this._edges=new de,this._ocaMap=new h}return p(e,[{key:"print",value:function(e){e.print("MULTILINESTRING ( ");for(var t=0;t<this._edges.size();t++){var n=this._edges.get(t);t>0&&e.print(","),e.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)r>0&&e.print(","),e.print(i[r].x+" "+i[r].y);e.println(")")}e.print(")  ")}},{key:"addAll",value:function(e){for(var t=e.iterator();t.hasNext();)this.add(t.next())}},{key:"findEdgeIndex",value:function(e){for(var t=0;t<this._edges.size();t++)if(this._edges.get(t).equals(e))return t;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(e){return this._edges.get(e)}},{key:"findEqualEdge",value:function(e){var t=new mn(e.getCoordinates());return this._ocaMap.get(t)}},{key:"add",value:function(e){this._edges.add(e);var t=new mn(e.getCoordinates());this._ocaMap.put(t,e)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),In=function(){function e(){_(this,e)}return p(e,[{key:"processIntersections",value:function(e,t,n,i){}},{key:"isDone",value:function(){}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),xn=function(){function e(){_(this,e),this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t}return p(e,[{key:"isTrivialIntersection",value:function(t,n,i,r){if(t===i&&1===this._li.getIntersectionNum()){if(e.isAdjacentSegments(n,r))return!0;if(t.isClosed()){var s=t.size()-1;if(0===n&&r===s||0===r&&n===s)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(e,t,n,i){if(e===n&&t===i)return null;this.numTests++;var r=e.getCoordinates()[t],s=e.getCoordinates()[t+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(e,t,n,i)||(this._hasIntersection=!0,e.addIntersections(this._li,t,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",value:function(){return[In]}},{key:"getClass",value:function(){return e}}],[{key:"isAdjacentSegments",value:function(e,t){return 1===Math.abs(e-t)}}]),e}(),En=function(){function e(){_(this,e),this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],n=arguments[1],i=arguments[2];this.coord=new L(t),this.segmentIndex=n,this.dist=i}return p(e,[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex),e.println(" dist = "+this.dist)}},{key:"compareTo",value:function(e){var t=e;return this.compare(t.segmentIndex,t.dist)}},{key:"isEndPoint",value:function(e){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===e}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(e,t){return this.segmentIndex<e?-1:this.segmentIndex>e?1:this.dist<t?-1:this.dist>t?1:0}},{key:"interfaces_",value:function(){return[N]}},{key:"getClass",value:function(){return e}}]),e}(),Nn=function(){function e(){_(this,e),this._nodeMap=new h,this.edge=null;var t=arguments[0];this.edge=t}return p(e,[{key:"print",value:function(e){e.println("Intersections:");for(var t=this.iterator();t.hasNext();){t.next().print(e)}}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(e){this.addEndpoints();for(var t=this.iterator(),n=t.next();t.hasNext();){var i=t.next(),r=this.createSplitEdge(n,i);e.add(r),n=i}}},{key:"addEndpoints",value:function(){var e=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[e],e,0)}},{key:"createSplitEdge",value:function(e,t){var n=t.segmentIndex-e.segmentIndex+2,i=this.edge.pts[t.segmentIndex],r=t.dist>0||!t.coord.equals2D(i);r||n--;var s=new Array(n).fill(null),o=0;s[o++]=new L(e.coord);for(var a=e.segmentIndex+1;a<=t.segmentIndex;a++)s[o++]=this.edge.pts[a];return r&&(s[o]=t.coord),new wn(s,new vt(this.edge._label))}},{key:"add",value:function(e,t,n){var i=new En(e,t,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)}},{key:"isIntersection",value:function(e){for(var t=this.iterator();t.hasNext();){if(t.next().coord.equals(e))return!0}return!1}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Cn=function(){function e(){_(this,e)}return p(e,[{key:"getChainStartIndices",value:function(t){var n=0,i=new de;i.add(new D(n));do{var r=this.findChainEnd(t,n);i.add(new D(r)),n=r}while(n<t.length-1);return e.toIntArray(i)}},{key:"findChainEnd",value:function(e,t){for(var n=xt.quadrant(e[t],e[t+1]),i=t+1;i<e.length;){if(xt.quadrant(e[i-1],e[i])!==n)break;i++}return i-1}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"toIntArray",value:function(e){for(var t=new Array(e.size()).fill(null),n=0;n<t.length;n++)t[n]=e.get(n).intValue();return t}}]),e}(),Sn=function(){function e(){_(this,e),this.e=null,this.pts=null,this.startIndex=null,this.env1=new U,this.env2=new U;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var n=new Cn;this.startIndex=n.getChainStartIndices(this.pts)}return p(e,[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(e){var t=this.pts[this.startIndex[e]].x,n=this.pts[this.startIndex[e+1]].x;return t>n?t:n}},{key:"getMinX",value:function(e){var t=this.pts[this.startIndex[e]].x,n=this.pts[this.startIndex[e+1]].x;return t<n?t:n}},{key:"computeIntersectsForChain",value:function(){if(4===arguments.length){var e=arguments[0],t=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[e],this.startIndex[e+1],t,t.startIndex[n],t.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3],u=arguments[4],l=arguments[5],h=this.pts[r],c=this.pts[s],f=o.pts[a],g=o.pts[u];if(s-r==1&&u-a==1)return l.addIntersections(this.e,r,o.e,a),null;if(this.env1.init(h,c),this.env2.init(f,g),!this.env1.intersects(this.env2))return null;var y=Math.trunc((r+s)/2),v=Math.trunc((a+u)/2);r<y&&(a<v&&this.computeIntersectsForChain(r,y,o,a,v,l),v<u&&this.computeIntersectsForChain(r,y,o,v,u,l)),y<s&&(a<v&&this.computeIntersectsForChain(y,s,o,a,v,l),v<u&&this.computeIntersectsForChain(y,s,o,v,u,l))}}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(e,t){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<e.startIndex.length-1;i++)this.computeIntersectsForChain(n,e,i,t)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Ln=function(){function e(){_(this,e),this._depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;t<2;t++)for(var n=0;n<3;n++)this._depth[t][n]=e.NULL_VALUE}return p(e,[{key:"getDepth",value:function(e,t){return this._depth[e][t]}},{key:"setDepth",value:function(e,t,n){this._depth[e][t]=n}},{key:"isNull",value:function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var n=0;n<3;n++)if(this._depth[t][n]!==e.NULL_VALUE)return!1;return!0}if(1===arguments.length){var i=arguments[0];return this._depth[i][1]===e.NULL_VALUE}if(2===arguments.length){var r=arguments[0],s=arguments[1];return this._depth[r][s]===e.NULL_VALUE}}},{key:"normalize",value:function(){for(var e=0;e<2;e++)if(!this.isNull(e)){var t=this._depth[e][1];this._depth[e][2]<t&&(t=this._depth[e][2]),t<0&&(t=0);for(var n=1;n<3;n++){var i=0;this._depth[e][n]>t&&(i=1),this._depth[e][n]=i}}}},{key:"getDelta",value:function(e){return this._depth[e][lt.RIGHT]-this._depth[e][lt.LEFT]}},{key:"getLocation",value:function(e,t){return this._depth[e][t]<=0?O.EXTERIOR:O.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(1===arguments.length)for(var t=arguments[0],n=0;n<2;n++)for(var i=1;i<3;i++){var r=t.getLocation(n,i);r!==O.EXTERIOR&&r!==O.INTERIOR||(this.isNull(n,i)?this._depth[n][i]=e.depthAtLocation(r):this._depth[n][i]+=e.depthAtLocation(r))}else if(3===arguments.length){var s=arguments[0],o=arguments[1];arguments[2]===O.INTERIOR&&this._depth[s][o]++}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"depthAtLocation",value:function(t){return t===O.EXTERIOR?0:t===O.INTERIOR?1:e.NULL_VALUE}},{key:"NULL_VALUE",get:function(){return-1}}]),e}(),wn=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(e.pts=null,e._env=null,e.eiList=new Nn(e),e._name=null,e._mce=null,e._isIsolated=!0,e._depth=new Ln,e._depthDelta=0,1===arguments.length){var n=arguments[0];t.call(e,n,null)}else if(2===arguments.length){var i=arguments[0],r=arguments[1];e.pts=i,e._label=r}return e}return m(t,mt),p(t,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var e=new Array(2).fill(null);e[0]=this.pts[0],e[1]=this.pts[1];return new t(e,vt.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(e){this._isIsolated=e}},{key:"setName",value:function(e){this._name=e}},{key:"equals",value:function(e){if(!(e instanceof t))return!1;var n=e;if(this.pts.length!==n.pts.length)return!1;for(var i=!0,r=!0,s=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(n.pts[o])||(i=!1),this.pts[o].equals2D(n.pts[--s])||(r=!1),!i&&!r)return!1;return!0}},{key:"getCoordinate",value:function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var e=arguments[0];return this.pts[e]}}},{key:"print",value:function(e){e.print("edge "+this._name+": "),e.print("LINESTRING (");for(var t=0;t<this.pts.length;t++)t>0&&e.print(","),e.print(this.pts[t].x+" "+this.pts[t].y);e.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(e){t.updateIM(this._label,e)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&(3===this.pts.length&&!!this.pts[0].equals(this.pts[2]))}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(e){e.print("edge "+this._name+": ");for(var t=this.pts.length-1;t>=0;t--)e.print(this.pts[t]+" ");e.println("")}},{key:"getMonotoneChainEdge",value:function(){return null===this._mce&&(this._mce=new Sn(this)),this._mce}},{key:"getEnvelope",value:function(){if(null===this._env){this._env=new U;for(var e=0;e<this.pts.length;e++)this._env.expandToInclude(this.pts[e])}return this._env}},{key:"addIntersection",value:function(e,t,n,i){var r=new L(e.getIntersection(i)),s=t,o=e.getEdgeDistance(n,i),a=s+1;if(a<this.pts.length){var u=this.pts[a];r.equals2D(u)&&(s=a,o=0)}this.eiList.add(r,s,o)}},{key:"toString",value:function(){var e=new b;e.append("edge "+this._name+": "),e.append("LINESTRING (");for(var t=0;t<this.pts.length;t++)t>0&&e.append(","),e.append(this.pts[t].x+" "+this.pts[t].y);return e.append(")  "+this._label+" "+this._depthDelta),e.toString()}},{key:"isPointwiseEqual",value:function(e){if(this.pts.length!==e.pts.length)return!1;for(var t=0;t<this.pts.length;t++)if(!this.pts[t].equals2D(e.pts[t]))return!1;return!0}},{key:"setDepthDelta",value:function(e){this._depthDelta=e}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(e,t,n){for(var i=0;i<e.getIntersectionNum();i++)this.addIntersection(e,t,n,i)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}],[{key:"updateIM",value:function(){if(2!==arguments.length)return mt.prototype.updateIM.apply(this,arguments);var e=arguments[0],t=arguments[1];t.setAtLeastIfValid(e.getLocation(0,lt.ON),e.getLocation(1,lt.ON),1),e.isArea()&&(t.setAtLeastIfValid(e.getLocation(0,lt.LEFT),e.getLocation(1,lt.LEFT),2),t.setAtLeastIfValid(e.getLocation(0,lt.RIGHT),e.getLocation(1,lt.RIGHT),2))}}]),t}(),Pn=function(){function e(t){_(this,e),this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new kn,this._bufParams=t||null}return p(e,[{key:"setWorkingPrecisionModel",value:function(e){this._workingPrecisionModel=e}},{key:"insertUniqueEdge",value:function(t){var n=this._edgeList.findEqualEdge(t);if(null!==n){var i=n.getLabel(),r=t.getLabel();n.isPointwiseEqual(t)||(r=new vt(t.getLabel())).flip(),i.merge(r);var s=e.depthDelta(r),o=n.getDepthDelta()+s;n.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(e.depthDelta(t.getLabel()))}},{key:"buildSubgraphs",value:function(e,t){for(var n=new de,i=e.iterator();i.hasNext();){var r=i.next(),s=r.getRightmostCoordinate(),o=new ln(n).getDepth(s);r.computeDepth(o),r.findResultEdges(),n.add(r),t.add(r.getDirectedEdges(),r.getNodes())}}},{key:"createSubgraphs",value:function(e){for(var t=new de,n=e.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new gt;r.create(i),t.add(r)}}return Dt.sort(t,Dt.reverseOrder()),t}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(e){if(null!==this._workingNoder)return this._workingNoder;var t=new en,n=new $;return n.setPrecisionModel(e),t.setSegmentIntersector(new xn(n)),t}},{key:"buffer",value:function(e,t){var n=this._workingPrecisionModel;null===n&&(n=e.getPrecisionModel()),this._geomFact=e.getFactory();var i=new un(n,this._bufParams),r=new fn(e,t,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new St(new pn),this._graph.addEdges(this._edgeList.getEdges());var s=this.createSubgraphs(this._graph),o=new Lt(this._geomFact);this.buildSubgraphs(s,o);var a=o.getPolygons();if(a.size()<=0)return this.createEmptyResultGeometry();return this._geomFact.buildGeometry(a)}},{key:"computeNodedEdges",value:function(e,t){var n=this.getNoder(t);n.computeNodes(e);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),s=r.getCoordinates();if(2!==s.length||!s[0].equals2D(s[1])){var o=r.getData(),a=new wn(r.getCoordinates(),new vt(o));this.insertUniqueEdge(a)}}}},{key:"setNoder",value:function(e){this._workingNoder=e}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"depthDelta",value:function(e){var t=e.getLocation(0,lt.LEFT),n=e.getLocation(0,lt.RIGHT);return t===O.INTERIOR&&n===O.EXTERIOR?1:t===O.EXTERIOR&&n===O.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(e){for(var t=new nt,n=new de;e.hasNext();){var i=e.next(),r=t.createLineString(i.getCoordinates());n.add(r)}return t.buildGeometry(n)}}]),e}(),On=function(){function e(){if(_(this,e),this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],n=arguments[1];this._noder=t,this._scaleFactor=n,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];this._noder=i,this._scaleFactor=r,this._offsetX=s,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}}return p(e,[{key:"rescale",value:function(){if(R(arguments[0],fe))for(var e=arguments[0].iterator();e.hasNext();){var t=e.next();this.rescale(t.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],i=0;i<n.length;i++)n[i].x=n[i].x/this._scaleFactor+this._offsetX,n[i].y=n[i].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&z.out.println(n)}}},{key:"scale",value:function(){if(R(arguments[0],fe)){for(var e=arguments[0],t=new de,n=e.iterator();n.hasNext();){var i=n.next();t.add(new Ht(this.scale(i.getCoordinates()),i.getData()))}return t}if(arguments[0]instanceof Array){for(var r=arguments[0],s=new Array(r.length).fill(null),o=0;o<r.length;o++)s[o]=new L(Math.round((r[o].x-this._offsetX)*this._scaleFactor),Math.round((r[o].y-this._offsetY)*this._scaleFactor),r[o].z);return me.removeRepeatedPoints(s)}}},{key:"isIntegerPrecision",value:function(){return 1===this._scaleFactor}},{key:"getNodedSubstrings",value:function(){var e=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(e),e}},{key:"computeNodes",value:function(e){var t=e;this._isScaled&&(t=this.scale(e)),this._noder.computeNodes(t)}},{key:"interfaces_",value:function(){return[Zt]}},{key:"getClass",value:function(){return e}}]),e}(),Rn=function(){function e(){_(this,e),this._li=new $,this._segStrings=null;var t=arguments[0];this._segStrings=t}return p(e,[{key:"checkEndPtVertexIntersections",value:function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var t=e.next().getCoordinates();this.checkEndPtVertexIntersections(t[0],this._segStrings),this.checkEndPtVertexIntersections(t[t.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1].iterator();i.hasNext();)for(var r=i.next().getCoordinates(),s=1;s<r.length-1;s++)if(r[s].equals(n))throw new K("found endpt/interior pt intersection at index "+s+" :pt "+n)}},{key:"checkInteriorIntersections",value:function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();)for(var t=e.next(),n=this._segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(t,i)}else if(2===arguments.length)for(var r=arguments[0],s=arguments[1],o=r.getCoordinates(),a=s.getCoordinates(),u=0;u<o.length-1;u++)for(var l=0;l<a.length-1;l++)this.checkInteriorIntersections(r,u,s,l);else if(4===arguments.length){var h=arguments[0],c=arguments[1],f=arguments[2],g=arguments[3];if(h===f&&c===g)return null;var y=h.getCoordinates()[c],v=h.getCoordinates()[c+1],d=f.getCoordinates()[g],_=f.getCoordinates()[g+1];if(this._li.computeIntersection(y,v,d,_),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,y,v)||this.hasInteriorIntersection(this._li,d,_)))throw new K("found non-noded intersection at "+y+"-"+v+" and "+d+"-"+_)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var t=e.next();this.checkCollapses(t)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),i=0;i<n.length-2;i++)this.checkCollapse(n[i],n[i+1],n[i+2])}},{key:"hasInteriorIntersection",value:function(e,t,n){for(var i=0;i<e.getIntersectionNum();i++){var r=e.getIntersection(i);if(!r.equals(t)&&!r.equals(n))return!0}return!1}},{key:"checkCollapse",value:function(t,n,i){if(t.equals(i))throw new K("found non-noded collapse at "+e.fact.createLineString([t,n,i]))}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"fact",get:function(){return new nt}}]),e}(),Tn=function(){function e(){_(this,e),this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],n=arguments[1],i=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=n,this._li=i,n<=0)throw new x("Scale factor must be non-zero");1!==n&&(this._pt=new L(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new L,this._p1Scaled=new L),this.initCorners(this._pt)}return p(e,[{key:"intersectsScaled",value:function(e,t){var n=Math.min(e.x,t.x),i=Math.max(e.x,t.x),r=Math.min(e.y,t.y),s=Math.max(e.y,t.y),o=this._maxx<n||this._minx>i||this._maxy<r||this._miny>s;if(o)return!1;var a=this.intersectsToleranceSquare(e,t);return Q.isTrue(!(o&&a),"Found bad envelope test"),a}},{key:"initCorners",value:function(e){this._minx=e.x-.5,this._maxx=e.x+.5,this._miny=e.y-.5,this._maxy=e.y+.5,this._corner[0]=new L(this._maxx,this._maxy),this._corner[1]=new L(this._minx,this._maxy),this._corner[2]=new L(this._minx,this._miny),this._corner[3]=new L(this._maxx,this._miny)}},{key:"intersects",value:function(e,t){return 1===this._scaleFactor?this.intersectsScaled(e,t):(this.copyScaled(e,this._p0Scaled),this.copyScaled(t,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(e){return Math.round(e*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(e,t){t.x=this.scale(e.x),t.y=this.scale(e.y)}},{key:"getSafeEnvelope",value:function(){if(null===this._safeEnv){var t=e.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new U(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(e,t){return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(e,t){var n=!1,i=!1;return this._li.computeIntersection(e,t,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(e,t,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(e,t,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(e,t,this._corner[3],this._corner[0]),!!this._li.isProper()||(!(!n||!i)||(!!e.equals(this._pt)||!!t.equals(this._pt))))))}},{key:"addSnappedNode",value:function(e,t){var n=e.getCoordinate(t),i=e.getCoordinate(t+1);return!!this.intersects(n,i)&&(e.addIntersection(this.getCoordinate(),t),!0)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"SAFE_ENV_EXPANSION_FACTOR",get:function(){return.75}}]),e}(),bn=function(){function e(){_(this,e),this.tempEnv1=new U,this.selectedSegment=new Wt}return p(e,[{key:"select",value:function(){if(1===arguments.length);else if(2===arguments.length){var e=arguments[0],t=arguments[1];e.getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Dn=function(){function e(){_(this,e),this._index=null;var t=arguments[0];this._index=t}return p(e,[{key:"snap",value:function(){if(1===arguments.length){var e=arguments[0];return this.snap(e,null,-1)}if(3===arguments.length){var t=arguments[0],n=arguments[1],i=arguments[2],r=t.getSafeEnvelope(),s=new Mn(t,n,i);return this._index.query(r,{interfaces_:function(){return[Rt]},visitItem:function(e){e.select(r,s)}}),s.isNodeAdded()}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"HotPixelSnapAction",get:function(){return Mn}}]),e}(),Mn=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._hotPixel=null,e._parentEdge=null,e._hotPixelVertexIndex=null,e._isNodeAdded=!1;var n=arguments[0],i=arguments[1],r=arguments[2];return e._hotPixel=n,e._parentEdge=i,e._hotPixelVertexIndex=r,e}return m(t,bn),p(t,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(2!==arguments.length)return bn.prototype.select.apply(this,arguments);var e=arguments[0],t=arguments[1],n=e.getContext();if(null!==this._parentEdge&&n===this._parentEdge&&t===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(n,t)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),An=function(){function e(){_(this,e),this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new de}return p(e,[{key:"processIntersections",value:function(e,t,n,i){if(e===n&&t===i)return null;var r=e.getCoordinates()[t],s=e.getCoordinates()[t+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var u=0;u<this._li.getIntersectionNum();u++)this._interiorIntersections.add(this._li.getIntersection(u));e.addIntersections(this._li,t,0),n.addIntersections(this._li,i,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",value:function(){return[In]}},{key:"getClass",value:function(){return e}}]),e}(),Fn=function(){function e(){_(this,e),this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new $,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()}return p(e,[{key:"checkCorrectness",value:function(e){var t=Ht.getNodedSubstrings(e),n=new Rn(t);try{n.checkValid()}catch(e){if(!(e instanceof q))throw e;e.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return Ht.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(e,t){var n=this.findInteriorIntersections(e,t);this.computeIntersectionSnaps(n),this.computeVertexSnaps(e)}},{key:"findInteriorIntersections",value:function(e,t){var n=new An(t);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(e),n.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(R(arguments[0],fe))for(var e=arguments[0].iterator();e.hasNext();){var t=e.next();this.computeVertexSnaps(t)}else if(arguments[0]instanceof Ht)for(var n=arguments[0],i=n.getCoordinates(),r=0;r<i.length;r++){var s=new Tn(i[r],this._scaleFactor,this._li);this._pointSnapper.snap(s,n,r)&&n.addIntersection(i[r],r)}}},{key:"computeNodes",value:function(e){this._nodedSegStrings=e,this._noder=new en,this._pointSnapper=new Dn(this._noder.getIndex()),this.snapRound(e,this._li)}},{key:"computeIntersectionSnaps",value:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next(),i=new Tn(n,this._scaleFactor,this._li);this._pointSnapper.snap(i)}}},{key:"interfaces_",value:function(){return[Zt]}},{key:"getClass",value:function(){return e}}]),e}(),Gn=function(){function e(){if(_(this,e),this._argGeom=null,this._distance=null,this._bufParams=new nn,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._argGeom=n,this._bufParams=i}}return p(e,[{key:"bufferFixedPrecision",value:function(e){var t=new On(new Fn(new et(1)),e.getScale()),n=new Pn(this._bufParams);n.setWorkingPrecisionModel(e),n.setNoder(t),this._resultGeometry=n.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(0===arguments.length){for(var t=e.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(e){if(!(e instanceof ct))throw e;this._saveException=e}if(null!==this._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],i=e.precisionScaleFactor(this._argGeom,this._distance,n),r=new et(i);this.bufferFixedPrecision(r)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var e=this._argGeom.getFactory().getPrecisionModel();e.getType()===et.FIXED?this.bufferFixedPrecision(e):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(e){this._bufParams.setQuadrantSegments(e)}},{key:"bufferOriginalPrecision",value:function(){try{var e=new Pn(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(e){if(!(e instanceof K))throw e;this._saveException=e}}},{key:"getResultGeometry",value:function(e){return this._distance=e,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(e){this._bufParams.setEndCapStyle(e)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"bufferOp",value:function(){if(2===arguments.length){var t=arguments[0],n=arguments[1];return new e(t).getResultGeometry(n)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof re&&"number"==typeof arguments[1]){var i=arguments[0],r=arguments[1],s=arguments[2],o=new e(i);o.setQuadrantSegments(s);return o.getResultGeometry(r)}if(arguments[2]instanceof nn&&arguments[0]instanceof re&&"number"==typeof arguments[1]){var a=arguments[0],u=arguments[1];return new e(a,arguments[2]).getResultGeometry(u)}}else if(4===arguments.length){var l=arguments[0],h=arguments[1],c=arguments[2],f=arguments[3],g=new e(l);g.setQuadrantSegments(c),g.setEndCapStyle(f);return g.getResultGeometry(h)}}},{key:"precisionScaleFactor",value:function(e,t,n){var i=e.getEnvelopeInternal(),r=T.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(t>0?t:0),s=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,s)}},{key:"CAP_ROUND",get:function(){return nn.CAP_ROUND}},{key:"CAP_BUTT",get:function(){return nn.CAP_FLAT}},{key:"CAP_FLAT",get:function(){return nn.CAP_FLAT}},{key:"CAP_SQUARE",get:function(){return nn.CAP_SQUARE}},{key:"MAX_PRECISION_DIGITS",get:function(){return 12}}]),e}(),qn=function(){function e(){_(this,e),this._pt=[new L,new L],this._distance=E.NaN,this._isNull=!0}return p(e,[{key:"getCoordinates",value:function(){return this._pt}},{key:"getCoordinate",value:function(e){return this._pt[e]}},{key:"setMinimum",value:function(){if(1===arguments.length){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(2===arguments.length){var t=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(t,n),null;var i=t.distance(n);i<this._distance&&this.initialize(t,n,i)}}},{key:"initialize",value:function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var e=arguments[0],t=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(t),this._distance=e.distance(t),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}}},{key:"getDistance",value:function(){return this._distance}},{key:"setMaximum",value:function(){if(1===arguments.length){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(2===arguments.length){var t=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(t,n),null;var i=t.distance(n);i>this._distance&&this.initialize(t,n,i)}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Bn=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"computeDistance",value:function(){if(arguments[2]instanceof qn&&arguments[0]instanceof qe&&arguments[1]instanceof L)for(var t=arguments[0],n=arguments[1],i=arguments[2],r=t.getCoordinates(),s=new Wt,o=0;o<r.length-1;o++){s.setCoordinates(r[o],r[o+1]);var a=s.closestPoint(n);i.setMinimum(a,n)}else if(arguments[2]instanceof qn&&arguments[0]instanceof Ue&&arguments[1]instanceof L){var u=arguments[0],l=arguments[1],h=arguments[2];e.computeDistance(u.getExteriorRing(),l,h);for(var c=0;c<u.getNumInteriorRing();c++)e.computeDistance(u.getInteriorRingN(c),l,h)}else if(arguments[2]instanceof qn&&arguments[0]instanceof re&&arguments[1]instanceof L){var f=arguments[0],g=arguments[1],y=arguments[2];if(f instanceof qe)e.computeDistance(f,g,y);else if(f instanceof Ue)e.computeDistance(f,g,y);else if(f instanceof be)for(var v=f,d=0;d<v.getNumGeometries();d++){var _=v.getGeometryN(d);e.computeDistance(_,g,y)}else y.setMinimum(f.getCoordinate(),g)}else if(arguments[2]instanceof qn&&arguments[0]instanceof Wt&&arguments[1]instanceof L){var p=arguments[0],m=arguments[1],k=arguments[2],I=p.closestPoint(m);k.setMinimum(I,m)}}}]),e}(),zn=(function(){function e(t){_(this,e),this._maxPtDist=new qn,this._inputGeom=t||null}p(e,[{key:"computeMaxMidpointDistance",value:function(e){var t=new Vn(this._inputGeom);e.apply(t),this._maxPtDist.setMaximum(t.getMaxPointDistance())}},{key:"computeMaxVertexDistance",value:function(e){var t=new zn(this._inputGeom);e.apply(t),this._maxPtDist.setMaximum(t.getMaxPointDistance())}},{key:"findDistance",value:function(e){return this.computeMaxVertexDistance(e),this.computeMaxMidpointDistance(e),this._maxPtDist.getDistance()}},{key:"getDistancePoints",value:function(){return this._maxPtDist}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"MaxPointDistanceFilter",get:function(){return zn}},{key:"MaxMidpointDistanceFilter",get:function(){return Vn}}])}(),function(){function e(t){_(this,e),this._maxPtDist=new qn,this._minPtDist=new qn,this._geom=t||null}return p(e,[{key:"filter",value:function(e){this._minPtDist.initialize(),Bn.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},{key:"getMaxPointDistance",value:function(){return this._maxPtDist}},{key:"interfaces_",value:function(){return[oe]}},{key:"getClass",value:function(){return e}}]),e}()),Vn=function(){function e(t){_(this,e),this._maxPtDist=new qn,this._minPtDist=new qn,this._geom=t||null}return p(e,[{key:"filter",value:function(e,t){if(0===t)return null;var n=e.getCoordinate(t-1),i=e.getCoordinate(t),r=new L((n.x+i.x)/2,(n.y+i.y)/2);this._minPtDist.initialize(),Bn.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},{key:"isDone",value:function(){return!1}},{key:"isGeometryChanged",value:function(){return!1}},{key:"getMaxPointDistance",value:function(){return this._maxPtDist}},{key:"interfaces_",value:function(){return[Te]}},{key:"getClass",value:function(){return e}}]),e}(),Un=function(){function e(t){_(this,e),this._comps=t||null}return p(e,[{key:"filter",value:function(e){e instanceof Ue&&this._comps.add(e)}},{key:"interfaces_",value:function(){return[Re]}},{key:"getClass",value:function(){return e}}],[{key:"getPolygons",value:function(){if(1===arguments.length){var t=arguments[0];return e.getPolygons(t,new de)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return n instanceof Ue?i.add(n):n instanceof be&&n.apply(new e(i)),i}}}]),e}(),Xn=function(){function e(){if(_(this,e),this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._lines=n,this._isForcedToLineString=i}}return p(e,[{key:"filter",value:function(e){if(this._isForcedToLineString&&e instanceof Ye){var t=e.getFactory().createLineString(e.getCoordinateSequence());return this._lines.add(t),null}e instanceof qe&&this._lines.add(e)}},{key:"setForceToLineString",value:function(e){this._isForcedToLineString=e}},{key:"interfaces_",value:function(){return[ie]}},{key:"getClass",value:function(){return e}}],[{key:"getGeometry",value:function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(e.getLines(t))}if(2===arguments.length){var n=arguments[0],i=arguments[1];return n.getFactory().buildGeometry(e.getLines(n,i))}}},{key:"getLines",value:function(){if(1===arguments.length){var t=arguments[0];return e.getLines(t,!1)}if(2===arguments.length){if(R(arguments[0],fe)&&R(arguments[1],fe)){for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();){var s=r.next();e.getLines(s,i)}return i}if(arguments[0]instanceof re&&"boolean"==typeof arguments[1]){var o=arguments[0],a=arguments[1],u=new de;return o.apply(new e(u,a)),u}if(arguments[0]instanceof re&&R(arguments[1],fe)){var l=arguments[0],h=arguments[1];return l instanceof qe?h.add(l):l.apply(new e(h)),h}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&R(arguments[0],fe)&&R(arguments[1],fe)){for(var c=arguments[0],f=arguments[1],g=arguments[2],y=c.iterator();y.hasNext();){var v=y.next();e.getLines(v,f,g)}return f}if("boolean"==typeof arguments[2]&&arguments[0]instanceof re&&R(arguments[1],fe)){var d=arguments[0],_=arguments[1],p=arguments[2];return d.apply(new e(_,p)),_}}}}]),e}(),Yn=function(){function e(){if(_(this,e),this._boundaryRule=ae.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new x("Rule must be non-null");this._boundaryRule=t}}return p(e,[{key:"locateInternal",value:function(){if(arguments[0]instanceof L&&arguments[1]instanceof Ue){var e=arguments[0],t=arguments[1];if(t.isEmpty())return O.EXTERIOR;var n=t.getExteriorRing(),i=this.locateInPolygonRing(e,n);if(i===O.EXTERIOR)return O.EXTERIOR;if(i===O.BOUNDARY)return O.BOUNDARY;for(var r=0;r<t.getNumInteriorRing();r++){var s=t.getInteriorRingN(r),o=this.locateInPolygonRing(e,s);if(o===O.INTERIOR)return O.EXTERIOR;if(o===O.BOUNDARY)return O.BOUNDARY}return O.INTERIOR}if(arguments[0]instanceof L&&arguments[1]instanceof qe){var a=arguments[0],u=arguments[1];if(!u.getEnvelopeInternal().intersects(a))return O.EXTERIOR;var l=u.getCoordinates();return u.isClosed()||!a.equals(l[0])&&!a.equals(l[l.length-1])?ne.isOnLine(a,l)?O.INTERIOR:O.EXTERIOR:O.BOUNDARY}if(arguments[0]instanceof L&&arguments[1]instanceof ze){var h=arguments[0];return arguments[1].getCoordinate().equals2D(h)?O.INTERIOR:O.EXTERIOR}}},{key:"locateInPolygonRing",value:function(e,t){return t.getEnvelopeInternal().intersects(e)?ne.locatePointInRing(e,t.getCoordinates()):O.EXTERIOR}},{key:"intersects",value:function(e,t){return this.locate(e,t)!==O.EXTERIOR}},{key:"updateLocationInfo",value:function(e){e===O.INTERIOR&&(this._isIn=!0),e===O.BOUNDARY&&this._numBoundaries++}},{key:"computeLocation",value:function(e,t){if(t instanceof ze&&this.updateLocationInfo(this.locateInternal(e,t)),t instanceof qe)this.updateLocationInfo(this.locateInternal(e,t));else if(t instanceof Ue)this.updateLocationInfo(this.locateInternal(e,t));else if(t instanceof De)for(var n=t,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(e,r))}else if(t instanceof je)for(var s=t,o=0;o<s.getNumGeometries();o++){var a=s.getGeometryN(o);this.updateLocationInfo(this.locateInternal(e,a))}else if(t instanceof be)for(var u=new yn(t);u.hasNext();){var l=u.next();l!==t&&this.computeLocation(e,l)}}},{key:"locate",value:function(e,t){return t.isEmpty()?O.EXTERIOR:t instanceof qe?this.locateInternal(e,t):t instanceof Ue?this.locateInternal(e,t):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(e,t),this._boundaryRule.isInBoundary(this._numBoundaries)?O.BOUNDARY:this._numBoundaries>0||this._isIn?O.INTERIOR:O.EXTERIOR)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),jn=function(){function e(){if(_(this,e),this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){var t=arguments[0],n=arguments[1];e.call(this,t,e.INSIDE_AREA,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this._component=i,this._segIndex=r,this._pt=s}}return p(e,[{key:"isInsideArea",value:function(){return this._segIndex===e.INSIDE_AREA}},{key:"getCoordinate",value:function(){return this._pt}},{key:"getGeometryComponent",value:function(){return this._component}},{key:"getSegmentIndex",value:function(){return this._segIndex}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"INSIDE_AREA",get:function(){return-1}}]),e}(),Hn=function(){function e(t){_(this,e),this._pts=t||null}return p(e,[{key:"filter",value:function(e){e instanceof ze&&this._pts.add(e)}},{key:"interfaces_",value:function(){return[Re]}},{key:"getClass",value:function(){return e}}],[{key:"getPoints",value:function(){if(1===arguments.length){var t=arguments[0];return t instanceof ze?Dt.singletonList(t):e.getPoints(t,new de)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return n instanceof ze?i.add(n):n instanceof be&&n.apply(new e(i)),i}}}]),e}(),Wn=function(){function e(){_(this,e),this._locations=null;var t=arguments[0];this._locations=t}return p(e,[{key:"filter",value:function(e){(e instanceof ze||e instanceof qe||e instanceof Ue)&&this._locations.add(new jn(e,0,e.getCoordinate()))}},{key:"interfaces_",value:function(){return[Re]}},{key:"getClass",value:function(){return e}}],[{key:"getLocations",value:function(t){var n=new de;return t.apply(new e(n)),n}}]),e}(),Kn=function(){function e(){if(_(this,e),this._geom=null,this._terminateDistance=0,this._ptLocator=new Yn,this._minDistanceLocation=null,this._minDistance=E.MAX_VALUE,2===arguments.length){var t=arguments[0],n=arguments[1];this._geom=[t,n],this._terminateDistance=0}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=i,this._geom[1]=r,this._terminateDistance=s}}return p(e,[{key:"computeContainmentDistance",value:function(){if(0===arguments.length){var e=new Array(2).fill(null);if(this.computeContainmentDistance(0,e),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,e)}else if(2===arguments.length){var t=arguments[0],n=arguments[1],i=1-t,r=Un.getPolygons(this._geom[t]);if(r.size()>0){var s=Wn.getLocations(this._geom[i]);if(this.computeContainmentDistance(s,r,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[i]=n[0],this._minDistanceLocation[t]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&R(arguments[0],ve)&&R(arguments[1],ve)){for(var o=arguments[0],a=arguments[1],u=arguments[2],l=0;l<o.size();l++)for(var h=o.get(l),c=0;c<a.size();c++)if(this.computeContainmentDistance(h,a.get(c),u),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof jn&&arguments[1]instanceof Ue){var f=arguments[0],g=arguments[1],y=arguments[2],v=f.getCoordinate();if(O.EXTERIOR!==this._ptLocator.locate(v,g))return this._minDistance=0,y[0]=f,y[1]=new jn(g,v),null}}},{key:"computeMinDistanceLinesPoints",value:function(e,t,n){for(var i=0;i<e.size();i++)for(var r=e.get(i),s=0;s<t.size();s++){var o=t.get(s);if(this.computeMinDistance(r,o,n),this._minDistance<=this._terminateDistance)return null}}},{key:"computeFacetDistance",value:function(){var e=new Array(2).fill(null),t=Xn.getLines(this._geom[0]),n=Xn.getLines(this._geom[1]),i=Hn.getPoints(this._geom[0]),r=Hn.getPoints(this._geom[1]);return this.computeMinDistanceLines(t,n,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(t,r,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(n,i,e),this.updateMinDistance(e,!0),this._minDistance<=this._terminateDistance?null:(e[0]=null,e[1]=null,this.computeMinDistancePoints(i,r,e),void this.updateMinDistance(e,!1))))}},{key:"nearestLocations",value:function(){return this.computeMinDistance(),this._minDistanceLocation}},{key:"updateMinDistance",value:function(e,t){if(null===e[0])return null;t?(this._minDistanceLocation[0]=e[1],this._minDistanceLocation[1]=e[0]):(this._minDistanceLocation[0]=e[0],this._minDistanceLocation[1]=e[1])}},{key:"nearestPoints",value:function(){this.computeMinDistance();return[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]}},{key:"computeMinDistance",value:function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof qe&&arguments[1]instanceof ze){var e=arguments[0],t=arguments[1],n=arguments[2];if(e.getEnvelopeInternal().distance(t.getEnvelopeInternal())>this._minDistance)return null;for(var i=e.getCoordinates(),r=t.getCoordinate(),s=0;s<i.length-1;s++){var o=ne.distancePointLine(r,i[s],i[s+1]);if(o<this._minDistance){this._minDistance=o;var a=new Wt(i[s],i[s+1]).closestPoint(r);n[0]=new jn(e,s,a),n[1]=new jn(t,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof qe&&arguments[1]instanceof qe){var u=arguments[0],l=arguments[1],h=arguments[2];if(u.getEnvelopeInternal().distance(l.getEnvelopeInternal())>this._minDistance)return null;for(var c=u.getCoordinates(),f=l.getCoordinates(),g=0;g<c.length-1;g++)for(var y=0;y<f.length-1;y++){var v=ne.distanceLineLine(c[g],c[g+1],f[y],f[y+1]);if(v<this._minDistance){this._minDistance=v;var d=new Wt(c[g],c[g+1]),_=new Wt(f[y],f[y+1]),p=d.closestPoints(_);h[0]=new jn(u,g,p[0]),h[1]=new jn(l,y,p[1])}if(this._minDistance<=this._terminateDistance)return null}}}},{key:"computeMinDistancePoints",value:function(e,t,n){for(var i=0;i<e.size();i++)for(var r=e.get(i),s=0;s<t.size();s++){var o=t.get(s),a=r.getCoordinate().distance(o.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new jn(r,0,r.getCoordinate()),n[1]=new jn(o,0,o.getCoordinate())),this._minDistance<=this._terminateDistance)return null}}},{key:"distance",value:function(){if(null===this._geom[0]||null===this._geom[1])throw new x("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)}},{key:"computeMinDistanceLines",value:function(e,t,n){for(var i=0;i<e.size();i++)for(var r=e.get(i),s=0;s<t.size();s++){var o=t.get(s);if(this.computeMinDistance(r,o,n),this._minDistance<=this._terminateDistance)return null}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"distance",value:function(t,n){return new e(t,n).distance()}},{key:"isWithinDistance",value:function(t,n,i){return new e(t,n,i).distance()<=i}},{key:"nearestPoints",value:function(t,n){return new e(t,n).nearestPoints()}}]),e}(),Jn=function(){function e(){_(this,e),this._pt=[new L,new L],this._distance=E.NaN,this._isNull=!0}return p(e,[{key:"getCoordinates",value:function(){return this._pt}},{key:"getCoordinate",value:function(e){return this._pt[e]}},{key:"setMinimum",value:function(){if(1===arguments.length){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(2===arguments.length){var t=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(t,n),null;var i=t.distance(n);i<this._distance&&this.initialize(t,n,i)}}},{key:"initialize",value:function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var e=arguments[0],t=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(t),this._distance=e.distance(t),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}}},{key:"toString",value:function(){return W.toLineString(this._pt[0],this._pt[1])}},{key:"getDistance",value:function(){return this._distance}},{key:"setMaximum",value:function(){if(1===arguments.length){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(2===arguments.length){var t=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(t,n),null;var i=t.distance(n);i>this._distance&&this.initialize(t,n,i)}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Qn=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"computeDistance",value:function(){if(arguments[2]instanceof Jn&&arguments[0]instanceof qe&&arguments[1]instanceof L)for(var t=arguments[0],n=arguments[1],i=arguments[2],r=new Wt,s=t.getCoordinates(),o=0;o<s.length-1;o++){r.setCoordinates(s[o],s[o+1]);var a=r.closestPoint(n);i.setMinimum(a,n)}else if(arguments[2]instanceof Jn&&arguments[0]instanceof Ue&&arguments[1]instanceof L){var u=arguments[0],l=arguments[1],h=arguments[2];e.computeDistance(u.getExteriorRing(),l,h);for(var c=0;c<u.getNumInteriorRing();c++)e.computeDistance(u.getInteriorRingN(c),l,h)}else if(arguments[2]instanceof Jn&&arguments[0]instanceof re&&arguments[1]instanceof L){var f=arguments[0],g=arguments[1],y=arguments[2];if(f instanceof qe)e.computeDistance(f,g,y);else if(f instanceof Ue)e.computeDistance(f,g,y);else if(f instanceof be)for(var v=f,d=0;d<v.getNumGeometries();d++){var _=v.getGeometryN(d);e.computeDistance(_,g,y)}else y.setMinimum(f.getCoordinate(),g)}else if(arguments[2]instanceof Jn&&arguments[0]instanceof Wt&&arguments[1]instanceof L){var p=arguments[0],m=arguments[1],k=arguments[2],I=p.closestPoint(m);k.setMinimum(I,m)}}}]),e}(),Zn=function(){function e(){_(this,e),this._g0=null,this._g1=null,this._ptDist=new Jn,this._densifyFrac=0;var t=arguments[0],n=arguments[1];this._g0=t,this._g1=n}return p(e,[{key:"getCoordinates",value:function(){return this._ptDist.getCoordinates()}},{key:"setDensifyFraction",value:function(e){if(e>1||e<=0)throw new x("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=e}},{key:"compute",value:function(e,t){this.computeOrientedDistance(e,t,this._ptDist),this.computeOrientedDistance(t,e,this._ptDist)}},{key:"distance",value:function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()}},{key:"computeOrientedDistance",value:function(e,t,n){var i=new $n(t);if(e.apply(i),n.setMaximum(i.getMaxPointDistance()),this._densifyFrac>0){var r=new ei(t,this._densifyFrac);e.apply(r),n.setMaximum(r.getMaxPointDistance())}}},{key:"orientedDistance",value:function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"distance",value:function(){if(2===arguments.length){return new e(arguments[0],arguments[1]).distance()}if(3===arguments.length){var t=arguments[0],n=arguments[1],i=arguments[2],r=new e(t,n);return r.setDensifyFraction(i),r.distance()}}},{key:"MaxPointDistanceFilter",get:function(){return $n}},{key:"MaxDensifiedByFractionDistanceFilter",get:function(){return ei}}]),e}(),$n=function(){function e(){_(this,e),this._maxPtDist=new Jn,this._minPtDist=new Jn,this._euclideanDist=new Qn,this._geom=null;var t=arguments[0];this._geom=t}return p(e,[{key:"filter",value:function(e){this._minPtDist.initialize(),Qn.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},{key:"getMaxPointDistance",value:function(){return this._maxPtDist}},{key:"interfaces_",value:function(){return[oe]}},{key:"getClass",value:function(){return e}}]),e}(),ei=function(){function e(){_(this,e),this._maxPtDist=new Jn,this._minPtDist=new Jn,this._geom=null,this._numSubSegs=0;var t=arguments[0],n=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/n))}return p(e,[{key:"filter",value:function(e,t){if(0===t)return null;for(var n=e.getCoordinate(t-1),i=e.getCoordinate(t),r=(i.x-n.x)/this._numSubSegs,s=(i.y-n.y)/this._numSubSegs,o=0;o<this._numSubSegs;o++){var a=n.x+o*r,u=n.y+o*s,l=new L(a,u);this._minPtDist.initialize(),Qn.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}}},{key:"isDone",value:function(){return!1}},{key:"isGeometryChanged",value:function(){return!1}},{key:"getMaxPointDistance",value:function(){return this._maxPtDist}},{key:"interfaces_",value:function(){return[Te]}},{key:"getClass",value:function(){return e}}]),e}(),ti=function(){function e(t,n,i){_(this,e),this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=n||null,this._result=i||null}return p(e,[{key:"checkMaximumDistance",value:function(e,t,n){var i=new Zn(t,e);if(i.setDensifyFraction(.25),this._maxDistanceFound=i.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var r=i.getCoordinates();this._errorLocation=r[1],this._errorIndicator=e.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+W.toLineString(r[0],r[1])+")"}}},{key:"isValid",value:function(){var t=Math.abs(this._bufDistance),n=e.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-n,this._maxValidDistance=t+n,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),e.VERBOSE&&z.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)}},{key:"checkNegativeValid",value:function(){if(!(this._input instanceof Ue||this._input instanceof je||this._input instanceof be))return null;var e=this.getPolygonLines(this._input);if(this.checkMinimumDistance(e,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(e,this._result,this._maxValidDistance)}},{key:"getErrorIndicator",value:function(){return this._errorIndicator}},{key:"checkMinimumDistance",value:function(e,t,n){var i=new Kn(e,t,n);if(this._minDistanceFound=i.distance(),this._minDistanceFound<n){this._isValid=!1;var r=i.nearestPoints();this._errorLocation=i.nearestPoints()[1],this._errorIndicator=e.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+W.toLineString(r[0],r[1])+" )"}}},{key:"checkPositiveValid",value:function(){var e=this._result.getBoundary();if(this.checkMinimumDistance(this._input,e,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,e,this._maxValidDistance)}},{key:"getErrorLocation",value:function(){return this._errorLocation}},{key:"getPolygonLines",value:function(e){for(var t=new de,n=new Xn(t),i=Un.getPolygons(e).iterator();i.hasNext();){i.next().apply(n)}return e.getFactory().buildGeometry(t)}},{key:"getErrorMessage",value:function(){return this._errMsg}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"VERBOSE",get:function(){return!1}},{key:"MAX_DISTANCE_DIFF_FRAC",get:function(){return.012}}]),e}(),ni=(function(){function e(t,n,i){_(this,e),this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=n||null,this._result=i||null}p(e,[{key:"isValid",value:function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid}},{key:"checkEnvelope",value:function(){if(this._distance<0)return null;var t=this._distance*e.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var n=new U(this._input.getEnvelopeInternal());n.expandBy(this._distance);var i=new U(this._result.getEnvelopeInternal());i.expandBy(t),i.contains(n)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(i)),this.report("Envelope")}},{key:"checkDistance",value:function(){var e=new ti(this._input,this._distance,this._result);e.isValid()||(this._isValid=!1,this._errorMsg=e.getErrorMessage(),this._errorLocation=e.getErrorLocation(),this._errorIndicator=e.getErrorIndicator()),this.report("Distance")}},{key:"checkArea",value:function(){var e=this._input.getArea(),t=this._result.getArea();this._distance>0&&e>t&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&e<t&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")}},{key:"checkPolygonal",value:function(){this._result instanceof Ue||this._result instanceof je||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")}},{key:"getErrorIndicator",value:function(){return this._errorIndicator}},{key:"getErrorLocation",value:function(){return this._errorLocation}},{key:"checkExpectedEmpty",value:function(){return this._input.getDimension()>=2?null:this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))}},{key:"report",value:function(t){if(!e.VERBOSE)return null;z.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))}},{key:"getErrorMessage",value:function(){return this._errorMsg}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"isValidMsg",value:function(t,n,i){var r=new e(t,n,i);return r.isValid()?null:r.getErrorMessage()}},{key:"isValid",value:function(t,n,i){return!!new e(t,n,i).isValid()}},{key:"VERBOSE",get:function(){return!1}},{key:"MAX_ENV_DIFF_FRAC",get:function(){return.012}}])}(),function(){function e(){_(this,e),this._pts=null,this._data=null;var t=arguments[0],n=arguments[1];this._pts=t,this._data=n}return p(e,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(e){return this._pts[e]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(e){return e===this._pts.length-1?-1:Xt.octant(this.getCoordinate(e),this.getCoordinate(e+1))}},{key:"setData",value:function(e){this._data=e}},{key:"getData",value:function(){return this._data}},{key:"toString",value:function(){return W.toLineString(new Qe(this._pts))}},{key:"interfaces_",value:function(){return[Yt]}},{key:"getClass",value:function(){return e}}]),e}()),ii=function(){function e(){_(this,e),this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new de,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null}return p(e,[{key:"getInteriorIntersection",value:function(){return this._interiorIntersection}},{key:"setCheckEndSegmentsOnly",value:function(e){this._isCheckEndSegmentsOnly=e}},{key:"getIntersectionSegments",value:function(){return this._intSegments}},{key:"count",value:function(){return this._intersectionCount}},{key:"getIntersections",value:function(){return this._intersections}},{key:"setFindAllIntersections",value:function(e){this._findAllIntersections=e}},{key:"setKeepIntersections",value:function(e){this._keepIntersections=e}},{key:"processIntersections",value:function(e,t,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;if(e===n&&t===i)return null;if(this._isCheckEndSegmentsOnly){if(!(this.isEndSegment(e,t)||this.isEndSegment(n,i)))return null}var r=e.getCoordinates()[t],s=e.getCoordinates()[t+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=s,this._intSegments[2]=o,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)}},{key:"isEndSegment",value:function(e,t){return 0===t||t>=e.size()-2}},{key:"hasIntersection",value:function(){return null!==this._interiorIntersection}},{key:"isDone",value:function(){return!this._findAllIntersections&&null!==this._interiorIntersection}},{key:"interfaces_",value:function(){return[In]}},{key:"getClass",value:function(){return e}}],[{key:"createAllIntersectionsFinder",value:function(t){var n=new e(t);return n.setFindAllIntersections(!0),n}},{key:"createAnyIntersectionFinder",value:function(t){return new e(t)}},{key:"createIntersectionCounter",value:function(t){var n=new e(t);return n.setFindAllIntersections(!0),n.setKeepIntersections(!1),n}}]),e}(),ri=function(){function e(){_(this,e),this._li=new $,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t}return p(e,[{key:"execute",value:function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()}},{key:"getIntersections",value:function(){return this._segInt.getIntersections()}},{key:"isValid",value:function(){return this.execute(),this._isValid}},{key:"setFindAllIntersections",value:function(e){this._findAllIntersections=e}},{key:"checkInteriorIntersections",value:function(){this._isValid=!0,this._segInt=new ii(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var e=new en;if(e.setSegmentIntersector(this._segInt),e.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null}},{key:"checkValid",value:function(){if(this.execute(),!this._isValid)throw new ct(this.getErrorMessage(),this._segInt.getInteriorIntersection())}},{key:"getErrorMessage",value:function(){if(this._isValid)return"no intersections found";var e=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+W.toLineString(e[0],e[1])+" and "+W.toLineString(e[2],e[3])}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"computeIntersections",value:function(t){var n=new e(t);return n.setFindAllIntersections(!0),n.isValid(),n.getIntersections()}}]),e}(),si=function(){function e(){_(this,e),this._nv=null;var t=arguments[0];this._nv=new ri(e.toSegmentStrings(t))}return p(e,[{key:"checkValid",value:function(){this._nv.checkValid()}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"toSegmentStrings",value:function(e){for(var t=new de,n=e.iterator();n.hasNext();){var i=n.next();t.add(new ni(i.getCoordinates(),i))}return t}},{key:"checkValid",value:function(t){new e(t).checkValid()}}]),e}(),oi=function(){function e(t){_(this,e),this._mapOp=t}return p(e,[{key:"map",value:function(e){for(var t=new de,n=0;n<e.getNumGeometries();n++){var i=this._mapOp.map(e.getGeometryN(n));i.isEmpty()||t.add(i)}return e.getFactory().createGeometryCollection(nt.toGeometryArray(t))}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"map",value:function(t,n){return new e(n).map(t)}}]),e}(),ai=function(){function e(){_(this,e),this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new de,this._resultLineList=new de;var t=arguments[0],n=arguments[1],i=arguments[2];this._op=t,this._geometryFactory=n,this._ptLocator=i}return p(e,[{key:"collectLines",value:function(e){for(var t=this._op.getGraph().getEdgeEnds().iterator();t.hasNext();){var n=t.next();this.collectLineEdge(n,e,this._lineEdgesList),this.collectBoundaryTouchEdge(n,e,this._lineEdgesList)}}},{key:"labelIsolatedLine",value:function(e,t){var n=this._ptLocator.locate(e.getCoordinate(),this._op.getArgGeometry(t));e.getLabel().setLocation(t,n)}},{key:"build",value:function(e){return this.findCoveredLineEdges(),this.collectLines(e),this.buildLines(e),this._resultLineList}},{key:"collectLineEdge",value:function(e,t,n){var i=e.getLabel(),r=e.getEdge();e.isLineEdge()&&(e.isVisited()||!Ai.isResultOfOp(i,t)||r.isCovered()||(n.add(r),e.setVisitedEdge(!0)))}},{key:"findCoveredLineEdges",value:function(){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){e.next().getEdges().findCoveredLineEdges()}for(var t=this._op.getGraph().getEdgeEnds().iterator();t.hasNext();){var n=t.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this._op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}}},{key:"labelIsolatedLines",value:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}}},{key:"buildLines",value:function(e){for(var t=this._lineEdgesList.iterator();t.hasNext();){var n=t.next(),i=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(i),n.setInResult(!0)}}},{key:"collectBoundaryTouchEdge",value:function(e,t,n){var i=e.getLabel();return e.isLineEdge()?null:e.isVisited()?null:e.isInteriorAreaEdge()?null:e.getEdge().isInResult()?null:(Q.isTrue(!(e.isInResult()||e.getSym().isInResult())||!e.getEdge().isInResult()),void(Ai.isResultOfOp(i,t)&&t===Ai.INTERSECTION&&(n.add(e.getEdge()),e.setVisitedEdge(!0))))}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),ui=function(){function e(){_(this,e),this._op=null,this._geometryFactory=null,this._resultPointList=new de;var t=arguments[0],n=arguments[1];this._op=t,this._geometryFactory=n}return p(e,[{key:"filterCoveredNodeToPoint",value:function(e){var t=e.getCoordinate();if(!this._op.isCoveredByLA(t)){var n=this._geometryFactory.createPoint(t);this._resultPointList.add(n)}}},{key:"extractNonCoveredResultNodes",value:function(e){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();){var n=t.next();if(!n.isInResult()&&(!n.isIncidentEdgeInResult()&&(0===n.getEdges().getDegree()||e===Ai.INTERSECTION))){var i=n.getLabel();Ai.isResultOfOp(i,e)&&this.filterCoveredNodeToPoint(n)}}}},{key:"build",value:function(e){return this.extractNonCoveredResultNodes(e),this._resultPointList}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),li=function(){function e(){_(this,e),this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1}return p(e,[{key:"transformPoint",value:function(e,t){return this._factory.createPoint(this.transformCoordinates(e.getCoordinateSequence(),e))}},{key:"transformPolygon",value:function(e,t){var n=!0,i=this.transformLinearRing(e.getExteriorRing(),e);null!==i&&i instanceof Ye&&!i.isEmpty()||(n=!1);for(var r=new de,s=0;s<e.getNumInteriorRing();s++){var o=this.transformLinearRing(e.getInteriorRingN(s),e);null===o||o.isEmpty()||(o instanceof Ye||(n=!1),r.add(o))}if(n)return this._factory.createPolygon(i,r.toArray([]));var a=new de;return null!==i&&a.add(i),a.addAll(r),this._factory.buildGeometry(a)}},{key:"createCoordinateSequence",value:function(e){return this._factory.getCoordinateSequenceFactory().create(e)}},{key:"getInputGeometry",value:function(){return this._inputGeom}},{key:"transformMultiLineString",value:function(e,t){for(var n=new de,i=0;i<e.getNumGeometries();i++){var r=this.transformLineString(e.getGeometryN(i),e);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)}},{key:"transformCoordinates",value:function(e,t){return this.copy(e)}},{key:"transformLineString",value:function(e,t){return this._factory.createLineString(this.transformCoordinates(e.getCoordinateSequence(),e))}},{key:"transformMultiPoint",value:function(e,t){for(var n=new de,i=0;i<e.getNumGeometries();i++){var r=this.transformPoint(e.getGeometryN(i),e);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)}},{key:"transformMultiPolygon",value:function(e,t){for(var n=new de,i=0;i<e.getNumGeometries();i++){var r=this.transformPolygon(e.getGeometryN(i),e);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)}},{key:"copy",value:function(e){return e.copy()}},{key:"transformGeometryCollection",value:function(e,t){for(var n=new de,i=0;i<e.getNumGeometries();i++){var r=this.transform(e.getGeometryN(i));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(nt.toGeometryArray(n)):this._factory.buildGeometry(n)}},{key:"transform",value:function(e){if(this._inputGeom=e,this._factory=e.getFactory(),e instanceof ze)return this.transformPoint(e,null);if(e instanceof Xe)return this.transformMultiPoint(e,null);if(e instanceof Ye)return this.transformLinearRing(e,null);if(e instanceof qe)return this.transformLineString(e,null);if(e instanceof De)return this.transformMultiLineString(e,null);if(e instanceof Ue)return this.transformPolygon(e,null);if(e instanceof je)return this.transformMultiPolygon(e,null);if(e instanceof be)return this.transformGeometryCollection(e,null);throw new x("Unknown Geometry subtype: "+e.getClass().getName())}},{key:"transformLinearRing",value:function(e,t){var n=this.transformCoordinates(e.getCoordinateSequence(),e);if(null===n)return this._factory.createLinearRing(null);var i=n.size();return i>0&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),hi=function(){function e(){if(_(this,e),this._snapTolerance=0,this._srcPts=null,this._seg=new Wt,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof qe&&"number"==typeof arguments[1]){var t=arguments[0],n=arguments[1];e.call(this,t.getCoordinates(),n)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var i=arguments[0],r=arguments[1];this._srcPts=i,this._isClosed=e.isClosed(i),this._snapTolerance=r}}return p(e,[{key:"snapVertices",value:function(e,t){for(var n=this._isClosed?e.size()-1:e.size(),i=0;i<n;i++){var r=e.get(i),s=this.findSnapForVertex(r,t);null!==s&&(e.set(i,new L(s)),0===i&&this._isClosed&&e.set(e.size()-1,new L(s)))}}},{key:"findSnapForVertex",value:function(e,t){for(var n=0;n<t.length;n++){if(e.equals2D(t[n]))return null;if(e.distance(t[n])<this._snapTolerance)return t[n]}return null}},{key:"snapTo",value:function(e){var t=new pe(this._srcPts);this.snapVertices(t,e),this.snapSegments(t,e);return t.toCoordinateArray()}},{key:"snapSegments",value:function(e,t){if(0===t.length)return null;var n=t.length;t[0].equals2D(t[t.length-1])&&(n=t.length-1);for(var i=0;i<n;i++){var r=t[i],s=this.findSegmentIndexToSnap(r,e);s>=0&&e.add(s+1,new L(r),!1)}}},{key:"findSegmentIndexToSnap",value:function(e,t){for(var n=E.MAX_VALUE,i=-1,r=0;r<t.size()-1;r++){if(this._seg.p0=t.get(r),this._seg.p1=t.get(r+1),this._seg.p0.equals2D(e)||this._seg.p1.equals2D(e)){if(this._allowSnappingToSourceVertices)continue;return-1}var s=this._seg.distance(e);s<this._snapTolerance&&s<n&&(n=s,i=r)}return i}},{key:"setAllowSnappingToSourceVertices",value:function(e){this._allowSnappingToSourceVertices=e}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"isClosed",value:function(e){return!(e.length<=1)&&e[0].equals2D(e[e.length-1])}}]),e}(),ci=function(){function e(t){_(this,e),this._srcGeom=t||null}return p(e,[{key:"snapTo",value:function(e,t){var n=this.extractTargetCoordinates(e);return new fi(t,n).transform(this._srcGeom)}},{key:"snapToSelf",value:function(e,t){var n=this.extractTargetCoordinates(this._srcGeom),i=new fi(e,n,!0).transform(this._srcGeom),r=i;return t&&R(r,Ve)&&(r=i.buffer(0)),r}},{key:"computeSnapTolerance",value:function(e){return this.computeMinimumSegmentLength(e)/10}},{key:"extractTargetCoordinates",value:function(e){for(var t=new f,n=e.getCoordinates(),i=0;i<n.length;i++)t.add(n[i]);return t.toArray(new Array(0).fill(null))}},{key:"computeMinimumSegmentLength",value:function(e){for(var t=E.MAX_VALUE,n=0;n<e.length-1;n++){var i=e[n].distance(e[n+1]);i<t&&(t=i)}return t}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"snap",value:function(t,n,i){var r=new Array(2).fill(null),s=new e(t);r[0]=s.snapTo(n,i);var o=new e(n);return r[1]=o.snapTo(r[0],i),r}},{key:"computeOverlaySnapTolerance",value:function(){if(1===arguments.length){var t=arguments[0],n=e.computeSizeBasedSnapTolerance(t),i=t.getPrecisionModel();if(i.getType()===et.FIXED){var r=1/i.getScale()*2/1.415;r>n&&(n=r)}return n}if(2===arguments.length){var s=arguments[0],o=arguments[1];return Math.min(e.computeOverlaySnapTolerance(s),e.computeOverlaySnapTolerance(o))}}},{key:"computeSizeBasedSnapTolerance",value:function(t){var n=t.getEnvelopeInternal();return Math.min(n.getHeight(),n.getWidth())*e.SNAP_PRECISION_FACTOR}},{key:"snapToSelf",value:function(t,n,i){return new e(t).snapToSelf(n,i)}},{key:"SNAP_PRECISION_FACTOR",get:function(){return 1e-9}}]),e}(),fi=function(e){function t(e,n,i){_(this,t);var r=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r._snapTolerance=e||null,r._snapPts=n||null,r._isSelfSnap=void 0!==i&&i,r}return m(t,li),p(t,[{key:"snapLine",value:function(e,t){var n=new hi(e,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(t)}},{key:"transformCoordinates",value:function(e,t){var n=e.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),gi=function(){function e(){_(this,e),this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null}return p(e,[{key:"getCommon",value:function(){return E.longBitsToDouble(this._commonBits)}},{key:"add",value:function(t){var n=E.doubleToLongBits(t);if(this._isFirst)return this._commonBits=n,this._commonSignExp=e.signExpBits(this._commonBits),this._isFirst=!1,null;if(e.signExpBits(n)!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=e.numCommonMostSigMantissaBits(this._commonBits,n),this._commonBits=e.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))}},{key:"toString",value:function(){if(1===arguments.length){var e=arguments[0],t=E.longBitsToDouble(e),n="0000000000000000000000000000000000000000000000000000000000000000"+E.toBinaryString(e),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+t+" ]"}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"getBit",value:function(e,t){return 0!=(e&1<<t)?1:0}},{key:"signExpBits",value:function(e){return e>>52}},{key:"zeroLowerBits",value:function(e,t){return e&~((1<<t)-1)}},{key:"numCommonMostSigMantissaBits",value:function(t,n){for(var i=0,r=52;r>=0;r--){if(e.getBit(t,r)!==e.getBit(n,r))return i;i++}return 52}}]),e}(),yi=function(){function e(){_(this,e),this._commonCoord=null,this._ccFilter=new vi}return p(e,[{key:"addCommonBits",value:function(e){var t=new di(this._commonCoord);e.apply(t),e.geometryChanged()}},{key:"removeCommonBits",value:function(e){if(0===this._commonCoord.x&&0===this._commonCoord.y)return e;var t=new L(this._commonCoord);t.x=-t.x,t.y=-t.y;var n=new di(t);return e.apply(n),e.geometryChanged(),e}},{key:"getCommonCoordinate",value:function(){return this._commonCoord}},{key:"add",value:function(e){e.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"CommonCoordinateFilter",get:function(){return vi}},{key:"Translater",get:function(){return di}}]),e}(),vi=function(){function e(){_(this,e),this._commonBitsX=new gi,this._commonBitsY=new gi}return p(e,[{key:"filter",value:function(e){this._commonBitsX.add(e.x),this._commonBitsY.add(e.y)}},{key:"getCommonCoordinate",value:function(){return new L(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())}},{key:"interfaces_",value:function(){return[oe]}},{key:"getClass",value:function(){return e}}]),e}(),di=function(){function e(){_(this,e),this.trans=null;var t=arguments[0];this.trans=t}return p(e,[{key:"filter",value:function(e,t){var n=e.getOrdinate(t,0)+this.trans.x,i=e.getOrdinate(t,1)+this.trans.y;e.setOrdinate(t,0,n),e.setOrdinate(t,1,i)}},{key:"isDone",value:function(){return!1}},{key:"isGeometryChanged",value:function(){return!0}},{key:"interfaces_",value:function(){return[Te]}},{key:"getClass",value:function(){return e}}]),e}(),_i=function(){function e(t,n){_(this,e),this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=n,this.computeSnapTolerance()}return p(e,[{key:"selfSnap",value:function(e){return new ci(e).snapTo(e,this._snapTolerance)}},{key:"removeCommonBits",value:function(e){this._cbr=new yi,this._cbr.add(e[0]),this._cbr.add(e[1]);var t=new Array(2).fill(null);return t[0]=this._cbr.removeCommonBits(e[0].copy()),t[1]=this._cbr.removeCommonBits(e[1].copy()),t}},{key:"prepareResult",value:function(e){return this._cbr.addCommonBits(e),e}},{key:"getResultGeometry",value:function(e){var t=this.snap(this._geom),n=Ai.overlayOp(t[0],t[1],e);return this.prepareResult(n)}},{key:"checkValid",value:function(e){e.isValid()||z.out.println("Snapped geometry is invalid")}},{key:"computeSnapTolerance",value:function(){this._snapTolerance=ci.computeOverlaySnapTolerance(this._geom[0],this._geom[1])}},{key:"snap",value:function(e){var t=this.removeCommonBits(e);return ci.snap(t[0],t[1],this._snapTolerance)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"overlayOp",value:function(t,n,i){return new e(t,n).getResultGeometry(i)}},{key:"union",value:function(t,n){return e.overlayOp(t,n,Ai.UNION)}},{key:"intersection",value:function(t,n){return e.overlayOp(t,n,Ai.INTERSECTION)}},{key:"symDifference",value:function(t,n){return e.overlayOp(t,n,Ai.SYMDIFFERENCE)}},{key:"difference",value:function(t,n){return e.overlayOp(t,n,Ai.DIFFERENCE)}}]),e}(),pi=function(){function e(t,n){_(this,e),this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=n}return p(e,[{key:"getResultGeometry",value:function(e){var t=null,n=!1,i=null;try{t=Ai.overlayOp(this._geom[0],this._geom[1],e);n=!0}catch(e){if(!(e instanceof K))throw e;i=e}if(!n)try{t=_i.overlayOp(this._geom[0],this._geom[1],e)}catch(e){throw e instanceof K?i:e}return t}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"overlayOp",value:function(t,n,i){return new e(t,n).getResultGeometry(i)}},{key:"union",value:function(t,n){return e.overlayOp(t,n,Ai.UNION)}},{key:"intersection",value:function(t,n){return e.overlayOp(t,n,Ai.INTERSECTION)}},{key:"symDifference",value:function(t,n){return e.overlayOp(t,n,Ai.SYMDIFFERENCE)}},{key:"difference",value:function(t,n){return e.overlayOp(t,n,Ai.DIFFERENCE)}}]),e}(),mi=function(){function e(){_(this,e),this.mce=null,this.chainIndex=null;var t=arguments[0],n=arguments[1];this.mce=t,this.chainIndex=n}return p(e,[{key:"computeIntersections",value:function(e,t){this.mce.computeIntersectsForChain(this.chainIndex,e.mce,e.chainIndex,t)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),ki=function(){function e(){if(_(this,e),this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var t=arguments[0],n=arguments[1];this._eventType=e.DELETE,this._xValue=t,this._insertEvent=n}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this._eventType=e.INSERT,this._label=i,this._xValue=r,this._obj=s}}return p(e,[{key:"isDelete",value:function(){return this._eventType===e.DELETE}},{key:"setDeleteEventIndex",value:function(e){this._deleteEventIndex=e}},{key:"getObject",value:function(){return this._obj}},{key:"compareTo",value:function(e){var t=e;return this._xValue<t._xValue?-1:this._xValue>t._xValue?1:this._eventType<t._eventType?-1:this._eventType>t._eventType?1:0}},{key:"getInsertEvent",value:function(){return this._insertEvent}},{key:"isInsert",value:function(){return this._eventType===e.INSERT}},{key:"isSameLabel",value:function(e){return null!==this._label&&this._label===e._label}},{key:"getDeleteEventIndex",value:function(){return this._deleteEventIndex}},{key:"interfaces_",value:function(){return[N]}},{key:"getClass",value:function(){return e}}],[{key:"INSERT",get:function(){return 1}},{key:"DELETE",get:function(){return 2}}]),e}(),Ii=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),xi=function(){function e(){_(this,e),this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],n=arguments[1],i=arguments[2];this._li=t,this._includeProper=n,this._recordIsolated=i}return p(e,[{key:"isTrivialIntersection",value:function(t,n,i,r){if(t===i&&1===this._li.getIntersectionNum()){if(e.isAdjacentSegments(n,r))return!0;if(t.isClosed()){var s=t.getNumPoints()-1;if(0===n&&r===s||0===r&&n===s)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"setIsDoneIfProperInt",value:function(e){this._isDoneWhenProperInt=e}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"isBoundaryPointInternal",value:function(e,t){for(var n=t.iterator();n.hasNext();){var i=n.next().getCoordinate();if(e.isIntersection(i))return!0}return!1}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return this._isDone}},{key:"isBoundaryPoint",value:function(e,t){return null!==t&&(!!this.isBoundaryPointInternal(e,t[0])||!!this.isBoundaryPointInternal(e,t[1]))}},{key:"setBoundaryNodes",value:function(e,t){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=e,this._bdyNodes[1]=t}},{key:"addIntersections",value:function(e,t,n,i){if(e===n&&t===i)return null;this.numTests++;var r=e.getCoordinates()[t],s=e.getCoordinates()[t+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&(this._recordIsolated&&(e.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(e,t,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(e.addIntersections(this._li,t,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"isAdjacentSegments",value:function(e,t){return 1===Math.abs(e-t)}}]),e}(),Ei=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.events=new de,e.nOverlaps=null,e}return m(t,Ii),p(t,[{key:"prepareEvents",value:function(){Dt.sort(this.events);for(var e=0;e<this.events.size();e++){var t=this.events.get(e);t.isDelete()&&t.getInsertEvent().setDeleteEventIndex(e)}}},{key:"computeIntersections",value:function(){if(1===arguments.length){var e=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var t=0;t<this.events.size();t++){var n=this.events.get(t);if(n.isInsert()&&this.processOverlaps(t,n.getDeleteEventIndex(),n,e),e.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof xi&&R(arguments[0],ve)&&R(arguments[1],ve)){var i=arguments[0],r=arguments[1],s=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(s)}else if("boolean"==typeof arguments[2]&&R(arguments[0],ve)&&arguments[1]instanceof xi){var o=arguments[0],a=arguments[1];arguments[2]?this.addEdges(o,null):this.addEdges(o),this.computeIntersections(a)}}},{key:"addEdge",value:function(e,t){for(var n=e.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var s=new mi(n,r),o=new ki(t,n.getMinX(r),s);this.events.add(o),this.events.add(new ki(n.getMaxX(r),o))}}},{key:"processOverlaps",value:function(e,t,n,i){for(var r=n.getObject(),s=e;s<t;s++){var o=this.events.get(s);if(o.isInsert()){var a=o.getObject();n.isSameLabel(o)||(r.computeIntersections(a,i),this.nOverlaps++)}}}},{key:"addEdges",value:function(){if(1===arguments.length)for(var e=arguments[0].iterator();e.hasNext();){var t=e.next();this.addEdge(t,t)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();){var s=r.next();this.addEdge(s,i)}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),Ni=function(){function e(){_(this,e),this._min=E.POSITIVE_INFINITY,this._max=E.NEGATIVE_INFINITY}return p(e,[{key:"getMin",value:function(){return this._min}},{key:"intersects",value:function(e,t){return!(this._min>t||this._max<e)}},{key:"getMax",value:function(){return this._max}},{key:"toString",value:function(){return W.toLineString(new L(this._min,0),new L(this._max,0))}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"NodeComparator",get:function(){return Ci}}]),e}(),Ci=function(){function e(){_(this,e)}return p(e,[{key:"compare",value:function(e,t){var n=e,i=t,r=(n._min+n._max)/2,s=(i._min+i._max)/2;return r<s?-1:r>s?1:0}},{key:"interfaces_",value:function(){return[S]}},{key:"getClass",value:function(){return e}}]),e}(),Si=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._item=null;var n=arguments[0],i=arguments[1],r=arguments[2];return e._min=n,e._max=i,e._item=r,e}return m(t,Ni),p(t,[{key:"query",value:function(e,t,n){if(!this.intersects(e,t))return null;n.visitItem(this._item)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),Li=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e._node1=null,e._node2=null;var n=arguments[0],i=arguments[1];return e._node1=n,e._node2=i,e.buildExtent(e._node1,e._node2),e}return m(t,Ni),p(t,[{key:"buildExtent",value:function(e,t){this._min=Math.min(e._min,t._min),this._max=Math.max(e._max,t._max)}},{key:"query",value:function(e,t,n){if(!this.intersects(e,t))return null;null!==this._node1&&this._node1.query(e,t,n),null!==this._node2&&this._node2.query(e,t,n)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}(),wi=function(){function e(){_(this,e),this._leaves=new de,this._root=null,this._level=0}return p(e,[{key:"buildTree",value:function(){Dt.sort(this._leaves,new Ni.NodeComparator);for(var e=this._leaves,t=null,n=new de;;){if(this.buildLevel(e,n),1===n.size())return n.get(0);t=e,e=n,n=t}}},{key:"insert",value:function(e,t,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new Si(e,t,n))}},{key:"query",value:function(e,t,n){this.init(),this._root.query(e,t,n)}},{key:"buildRoot",value:function(){if(null!==this._root)return null;this._root=this.buildTree()}},{key:"printNode",value:function(e){z.out.println(W.toLineString(new L(e._min,this._level),new L(e._max,this._level)))}},{key:"init",value:function(){if(null!==this._root)return null;this.buildRoot()}},{key:"buildLevel",value:function(e,t){this._level++,t.clear();for(var n=0;n<e.size();n+=2){var i=e.get(n);if(null===(n+1<e.size()?e.get(n):null))t.add(i);else{var r=new Li(e.get(n),e.get(n+1));t.add(r)}}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Pi=function(){function e(){_(this,e),this._items=new de}return p(e,[{key:"visitItem",value:function(e){this._items.add(e)}},{key:"getItems",value:function(){return this._items}},{key:"interfaces_",value:function(){return[Rt]}},{key:"getClass",value:function(){return e}}]),e}(),Oi=function(){function e(){_(this,e),this._index=null;var t=arguments[0];if(!R(t,Ve))throw new x("Argument must be Polygonal");this._index=new Ti(t)}return p(e,[{key:"locate",value:function(e){var t=new te(e),n=new Ri(t);return this._index.query(e.y,e.y,n),t.getLocation()}},{key:"interfaces_",value:function(){return[gn]}},{key:"getClass",value:function(){return e}}],[{key:"SegmentVisitor",get:function(){return Ri}},{key:"IntervalIndexedGeometry",get:function(){return Ti}}]),e}(),Ri=function(){function e(){_(this,e),this._counter=null;var t=arguments[0];this._counter=t}return p(e,[{key:"visitItem",value:function(e){var t=e;this._counter.countSegment(t.getCoordinate(0),t.getCoordinate(1))}},{key:"interfaces_",value:function(){return[Rt]}},{key:"getClass",value:function(){return e}}]),e}(),Ti=function(){function e(){_(this,e),this._index=new wi;var t=arguments[0];this.init(t)}return p(e,[{key:"init",value:function(e){for(var t=Xn.getLines(e).iterator();t.hasNext();){var n=t.next().getCoordinates();this.addLine(n)}}},{key:"addLine",value:function(e){for(var t=1;t<e.length;t++){var n=new Wt(e[t-1],e[t]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}}},{key:"query",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1],n=new Pi;return this._index.query(e,t,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this._index.query(i,r,s)}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),bi=function(e){function t(){_(this,t);var e=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(e._parentGeom=null,e._lineEdgeMap=new $e,e._boundaryNodeRule=null,e._useBoundaryDeterminationRule=!0,e._argIndex=null,e._boundaryNodes=null,e._hasTooFewPoints=!1,e._invalidPoint=null,e._areaPtLocator=null,e._ptLocator=new Yn,2===arguments.length){var n=arguments[0],i=arguments[1],r=ae.OGC_SFS_BOUNDARY_RULE;e._argIndex=n,e._parentGeom=i,e._boundaryNodeRule=r,null!==i&&e.add(i)}else if(3===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2];e._argIndex=s,e._parentGeom=o,e._boundaryNodeRule=a,null!==o&&e.add(o)}return e}return m(t,St),p(t,[{key:"insertBoundaryPoint",value:function(e,n){var i=this._nodes.addNode(n).getLabel(),r=1;O.NONE;i.getLocation(e,lt.ON)===O.BOUNDARY&&r++;var s=t.determineBoundary(this._boundaryNodeRule,r);i.setLocation(e,s)}},{key:"computeSelfNodes",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1];return this.computeSelfNodes(e,t,!1)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],s=new xi(n,!0,!1);s.setIsDoneIfProperInt(r);var o=this.createEdgeSetIntersector(),a=this._parentGeom instanceof Ye||this._parentGeom instanceof Ue||this._parentGeom instanceof je,u=i||!a;return o.computeIntersections(this._edges,s,u),this.addSelfIntersectionNodes(this._argIndex),s}}},{key:"computeSplitEdges",value:function(e){for(var t=this._edges.iterator();t.hasNext();){t.next().eiList.addSplitEdges(e)}}},{key:"computeEdgeIntersections",value:function(e,t,n){var i=new xi(t,n,!0);i.setBoundaryNodes(this.getBoundaryNodes(),e.getBoundaryNodes());return this.createEdgeSetIntersector().computeIntersections(this._edges,e._edges,i),i}},{key:"getGeometry",value:function(){return this._parentGeom}},{key:"getBoundaryNodeRule",value:function(){return this._boundaryNodeRule}},{key:"hasTooFewPoints",value:function(){return this._hasTooFewPoints}},{key:"addPoint",value:function(){if(arguments[0]instanceof ze){var e=arguments[0].getCoordinate();this.insertPoint(this._argIndex,e,O.INTERIOR)}else if(arguments[0]instanceof L){var t=arguments[0];this.insertPoint(this._argIndex,t,O.INTERIOR)}}},{key:"addPolygon",value:function(e){this.addPolygonRing(e.getExteriorRing(),O.EXTERIOR,O.INTERIOR);for(var t=0;t<e.getNumInteriorRing();t++){var n=e.getInteriorRingN(t);this.addPolygonRing(n,O.INTERIOR,O.EXTERIOR)}}},{key:"addEdge",value:function(e){this.insertEdge(e);var t=e.getCoordinates();this.insertPoint(this._argIndex,t[0],O.BOUNDARY),this.insertPoint(this._argIndex,t[t.length-1],O.BOUNDARY)}},{key:"addLineString",value:function(e){var t=me.removeRepeatedPoints(e.getCoordinates());if(t.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=t[0],null;var n=new wn(t,new vt(this._argIndex,O.INTERIOR));this._lineEdgeMap.put(e,n),this.insertEdge(n),Q.isTrue(t.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,t[0]),this.insertBoundaryPoint(this._argIndex,t[t.length-1])}},{key:"getInvalidPoint",value:function(){return this._invalidPoint}},{key:"getBoundaryPoints",value:function(){for(var e=this.getBoundaryNodes(),t=new Array(e.size()).fill(null),n=0,i=e.iterator();i.hasNext();){var r=i.next();t[n++]=r.getCoordinate().copy()}return t}},{key:"getBoundaryNodes",value:function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes}},{key:"addSelfIntersectionNode",value:function(e,t,n){if(this.isBoundaryNode(e,t))return null;n===O.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(e,t):this.insertPoint(e,t,n)}},{key:"addPolygonRing",value:function(e,t,n){if(e.isEmpty())return null;var i=me.removeRepeatedPoints(e.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var r=t,s=n;ne.isCCW(i)&&(r=n,s=t);var o=new wn(i,new vt(this._argIndex,O.BOUNDARY,r,s));this._lineEdgeMap.put(e,o),this.insertEdge(o),this.insertPoint(this._argIndex,i[0],O.BOUNDARY)}},{key:"insertPoint",value:function(e,t,n){var i=this._nodes.addNode(t),r=i.getLabel();null===r?i._label=new vt(e,n):r.setLocation(e,n)}},{key:"createEdgeSetIntersector",value:function(){return new Ei}},{key:"addSelfIntersectionNodes",value:function(e){for(var t=this._edges.iterator();t.hasNext();)for(var n=t.next(),i=n.getLabel().getLocation(e),r=n.eiList.iterator();r.hasNext();){var s=r.next();this.addSelfIntersectionNode(e,s.coord,i)}}},{key:"add",value:function(){if(1!==arguments.length)return St.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof je&&(this._useBoundaryDeterminationRule=!1),e instanceof Ue)this.addPolygon(e);else if(e instanceof qe)this.addLineString(e);else if(e instanceof ze)this.addPoint(e);else if(e instanceof Xe)this.addCollection(e);else if(e instanceof De)this.addCollection(e);else if(e instanceof je)this.addCollection(e);else{if(!(e instanceof be))throw new Error(e.getClass().getName());this.addCollection(e)}}},{key:"addCollection",value:function(e){for(var t=0;t<e.getNumGeometries();t++){var n=e.getGeometryN(t);this.add(n)}}},{key:"locate",value:function(e){return R(this._parentGeom,Ve)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new Oi(this._parentGeom)),this._areaPtLocator.locate(e)):this._ptLocator.locate(e,this._parentGeom)}},{key:"findEdge",value:function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return St.prototype.findEdge.apply(this,arguments)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}],[{key:"determineBoundary",value:function(e,t){return e.isInBoundary(t)?O.BOUNDARY:O.INTERIOR}}]),t}(),Di=function(){function e(){if(_(this,e),this._li=new $,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new bi(0,t)}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=ae.OGC_SFS_BOUNDARY_RULE;n.getPrecisionModel().compareTo(i.getPrecisionModel())>=0?this.setComputationPrecision(n.getPrecisionModel()):this.setComputationPrecision(i.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new bi(0,n,r),this._arg[1]=new bi(1,i,r)}else if(3===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2];s.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(s.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new bi(0,s,a),this._arg[1]=new bi(1,o,a)}}return p(e,[{key:"getArgGeometry",value:function(e){return this._arg[e].getGeometry()}},{key:"setComputationPrecision",value:function(e){this._resultPrecisionModel=e,this._li.setPrecisionModel(this._resultPrecisionModel)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Mi=function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"map",value:function(){if(arguments[0]instanceof re&&R(arguments[1],e.MapOp)){for(var t=arguments[0],n=arguments[1],i=new de,r=0;r<t.getNumGeometries();r++){var s=n.map(t.getGeometryN(r));null!==s&&i.add(s)}return t.getFactory().buildGeometry(i)}if(R(arguments[0],fe)&&R(arguments[1],e.MapOp)){for(var o=arguments[0],a=arguments[1],u=new de,l=o.iterator();l.hasNext();){var h=l.next(),c=a.map(h);null!==c&&u.add(c)}return u}}},{key:"MapOp",value:function(){}}]),e}(),Ai=function(e){function t(){_(this,t);var e=arguments[0],n=arguments[1],i=k(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._ptLocator=new Yn,i._geomFact=null,i._resultGeom=null,i._graph=null,i._edgeList=new kn,i._resultPolyList=new de,i._resultLineList=new de,i._resultPointList=new de,i._graph=new St(new pn),i._geomFact=e.getFactory(),i}return m(t,Di),p(t,[{key:"insertUniqueEdge",value:function(e){var t=this._edgeList.findEqualEdge(e);if(null!==t){var n=t.getLabel(),i=e.getLabel();t.isPointwiseEqual(e)||(i=new vt(e.getLabel())).flip();var r=t.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(e)}},{key:"getGraph",value:function(){return this._graph}},{key:"cancelDuplicateResultEdges",value:function(){for(var e=this._graph.getEdgeEnds().iterator();e.hasNext();){var t=e.next(),n=t.getSym();t.isInResult()&&n.isInResult()&&(t.setInResult(!1),n.setInResult(!1))}}},{key:"isCoveredByLA",value:function(e){return!!this.isCovered(e,this._resultLineList)||!!this.isCovered(e,this._resultPolyList)}},{key:"computeGeometry",value:function(e,n,i,r){var s=new de;return s.addAll(e),s.addAll(n),s.addAll(i),s.isEmpty()?t.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(s)}},{key:"mergeSymLabels",value:function(){for(var e=this._graph.getNodes().iterator();e.hasNext();){e.next().getEdges().mergeSymLabels()}}},{key:"isCovered",value:function(e,t){for(var n=t.iterator();n.hasNext();){var i=n.next();if(this._ptLocator.locate(e,i)!==O.EXTERIOR)return!0}return!1}},{key:"replaceCollapsedEdges",value:function(){for(var e=new de,t=this._edgeList.iterator();t.hasNext();){var n=t.next();n.isCollapsed()&&(t.remove(),e.add(n.getCollapsedEdge()))}this._edgeList.addAll(e)}},{key:"updateNodeLabelling",value:function(){for(var e=this._graph.getNodes().iterator();e.hasNext();){var t=e.next(),n=t.getEdges().getLabel();t.getLabel().merge(n)}}},{key:"getResultGeometry",value:function(e){return this.computeOverlay(e),this._resultGeom}},{key:"insertUniqueEdges",value:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.insertUniqueEdge(n)}}},{key:"computeOverlay",value:function(e){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var t=new de;this._arg[0].computeSplitEdges(t),this._arg[1].computeSplitEdges(t),this.insertUniqueEdges(t),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),si.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(e),this.cancelDuplicateResultEdges();var n=new Lt(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var i=new ai(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(e);var r=new ui(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(e),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,e)}},{key:"labelIncompleteNode",value:function(e,t){var n=this._ptLocator.locate(e.getCoordinate(),this._arg[t].getGeometry());e.getLabel().setLocation(t,n)}},{key:"copyPoints",value:function(e){for(var t=this._arg[e].getNodeIterator();t.hasNext();){var n=t.next();this._graph.addNode(n.getCoordinate()).setLabel(e,n.getLabel().getLocation(e))}}},{key:"findResultAreaEdges",value:function(e){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var i=n.next(),r=i.getLabel();r.isArea()&&!i.isInteriorAreaEdge()&&t.isResultOfOp(r.getLocation(0,lt.RIGHT),r.getLocation(1,lt.RIGHT),e)&&i.setInResult(!0)}}},{key:"computeLabelsFromDepths",value:function(){for(var e=this._edgeList.iterator();e.hasNext();){var t=e.next(),n=t.getLabel(),i=t.getDepth();if(!i.isNull()){i.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(Q.isTrue(!i.isNull(r,lt.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,lt.LEFT,i.getLocation(r,lt.LEFT)),Q.isTrue(!i.isNull(r,lt.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,lt.RIGHT,i.getLocation(r,lt.RIGHT))))}}}},{key:"computeLabelling",value:function(){for(var e=this._graph.getNodes().iterator();e.hasNext();){e.next().getEdges().computeLabelling(this._arg)}this.mergeSymLabels(),this.updateNodeLabelling()}},{key:"labelIncompleteNodes",value:function(){for(var e=this._graph.getNodes().iterator();e.hasNext();){var t=e.next(),n=t.getLabel();t.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(t,0):this.labelIncompleteNode(t,1)),t.getEdges().updateLabelling(n)}}},{key:"isCoveredByA",value:function(e){return!!this.isCovered(e,this._resultPolyList)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return t}}]),t}();Ai.overlayOp=function(e,t,n){return new Ai(e,t).getResultGeometry(n)},Ai.intersection=function(e,t){if(e.isEmpty()||t.isEmpty())return Ai.createEmptyResult(Ai.INTERSECTION,e,t,e.getFactory());if(e.isGeometryCollection()){var n=t;return oi.map(e,{interfaces_:function(){return[Mi.MapOp]},map:function(e){return e.intersection(n)}})}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),pi.overlayOp(e,t,Ai.INTERSECTION)},Ai.symDifference=function(e,t){if(e.isEmpty()||t.isEmpty()){if(e.isEmpty()&&t.isEmpty())return Ai.createEmptyResult(Ai.SYMDIFFERENCE,e,t,e.getFactory());if(e.isEmpty())return t.copy();if(t.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),pi.overlayOp(e,t,Ai.SYMDIFFERENCE)},Ai.resultDimension=function(e,t,n){var i=t.getDimension(),r=n.getDimension(),s=-1;switch(e){case Ai.INTERSECTION:s=Math.min(i,r);break;case Ai.UNION:s=Math.max(i,r);break;case Ai.DIFFERENCE:s=i;break;case Ai.SYMDIFFERENCE:s=Math.max(i,r)}return s},Ai.createEmptyResult=function(e,t,n,i){var r=null;switch(Ai.resultDimension(e,t,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},Ai.difference=function(e,t){return e.isEmpty()?Ai.createEmptyResult(Ai.DIFFERENCE,e,t,e.getFactory()):t.isEmpty()?e.copy():(e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),pi.overlayOp(e,t,Ai.DIFFERENCE))},Ai.isResultOfOp=function(){if(2===arguments.length){var e=arguments[0],t=arguments[1],n=e.getLocation(0),i=e.getLocation(1);return Ai.isResultOfOp(n,i,t)}if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];switch(r===O.BOUNDARY&&(r=O.INTERIOR),s===O.BOUNDARY&&(s=O.INTERIOR),o){case Ai.INTERSECTION:return r===O.INTERIOR&&s===O.INTERIOR;case Ai.UNION:return r===O.INTERIOR||s===O.INTERIOR;case Ai.DIFFERENCE:return r===O.INTERIOR&&s!==O.INTERIOR;case Ai.SYMDIFFERENCE:return r===O.INTERIOR&&s!==O.INTERIOR||r!==O.INTERIOR&&s===O.INTERIOR}return!1}},Ai.INTERSECTION=1,Ai.UNION=2,Ai.DIFFERENCE=3,Ai.SYMDIFFERENCE=4;(function(){function e(){_(this,e),this._graph=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2;var t=arguments[0];this._graph=t}p(e,[{key:"testLinkResultDirectedEdges",value:function(e,t){for(var n=this.getPotentialResultAreaEdges(e,t),i=null,r=this._SCANNING_FOR_INCOMING,s=0;s<n.size();s++){var o=n.get(s),a=o.getSym();if(o.getLabel().isArea())switch(null===i&&this.isPotentialResultAreaEdge(o,t)&&(i=o),r){case this._SCANNING_FOR_INCOMING:if(!this.isPotentialResultAreaEdge(a,t))continue;r=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!this.isPotentialResultAreaEdge(o,t))continue;r=this._SCANNING_FOR_INCOMING}}if(r===this._LINKING_TO_OUTGOING&&null===i)throw new ct("no outgoing dirEdge found",e.getCoordinate())}},{key:"getPotentialResultAreaEdges",value:function(e,t){for(var n=new de,i=e.iterator();i.hasNext();){var r=i.next();(this.isPotentialResultAreaEdge(r,t)||this.isPotentialResultAreaEdge(r.getSym(),t))&&n.add(r)}return n}},{key:"checkAll",value:function(){this.check(Ai.INTERSECTION),this.check(Ai.DIFFERENCE),this.check(Ai.UNION),this.check(Ai.SYMDIFFERENCE)}},{key:"check",value:function(e){for(var t=this._graph.getNodeIterator();t.hasNext();){var n=t.next();this.testLinkResultDirectedEdges(n.getEdges(),e)}}},{key:"isPotentialResultAreaEdge",value:function(e,t){var n=e.getLabel();return!(!n.isArea()||e.isInteriorAreaEdge()||!Ai.isResultOfOp(n.getLocation(0,lt.RIGHT),n.getLocation(1,lt.RIGHT),t))}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}])})(),function(){function e(){_(this,e),this._li=null,this._inputEdges=new de;var t=arguments[0];this._li=t}p(e,[{key:"addEdges",value:function(e){this._inputEdges.addAll(e)}},{key:"getNodedEdges",value:function(){var e=new Ei,t=new xi(this._li,!0,!1);e.computeIntersections(this._inputEdges,t,!0);for(var n=new de,i=this._inputEdges.iterator();i.hasNext();){i.next().getEdgeIntersectionList().addSplitEdges(n)}return n}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}])}();var Fi=function(){function e(){_(this,e),this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Yn,this._seg=new Wt;var t=arguments[0],n=arguments[1];this._g=t,this._boundaryDistanceTolerance=n,this._linework=this.extractLinework(t)}return p(e,[{key:"isWithinToleranceOfBoundary",value:function(e){for(var t=0;t<this._linework.getNumGeometries();t++)for(var n=this._linework.getGeometryN(t).getCoordinateSequence(),i=0;i<n.size()-1;i++){n.getCoordinate(i,this._seg.p0),n.getCoordinate(i+1,this._seg.p1);if(this._seg.distance(e)<=this._boundaryDistanceTolerance)return!0}return!1}},{key:"getLocation",value:function(e){return this.isWithinToleranceOfBoundary(e)?O.BOUNDARY:this._ptLocator.locate(e,this._g)}},{key:"extractLinework",value:function(e){var t=new Gi;e.apply(t);var n=t.getLinework(),i=nt.toLineStringArray(n);return e.getFactory().createMultiLineString(i)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Gi=function(){function e(){_(this,e),this._linework=null,this._linework=new de}return p(e,[{key:"getLinework",value:function(){return this._linework}},{key:"filter",value:function(e){if(e instanceof Ue){var t=e;this._linework.add(t.getExteriorRing());for(var n=0;n<t.getNumInteriorRing();n++)this._linework.add(t.getInteriorRingN(n))}}},{key:"interfaces_",value:function(){return[Re]}},{key:"getClass",value:function(){return e}}]),e}(),qi=function(){function e(){_(this,e),this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t}return p(e,[{key:"extractPoints",value:function(e,t,n){for(var i=e.getCoordinates(),r=0;r<i.length-1;r++)this.computeOffsetPoints(i[r],i[r+1],t,n)}},{key:"setSidesToGenerate",value:function(e,t){this._doLeft=e,this._doRight=t}},{key:"getPoints",value:function(e){for(var t=new de,n=Xn.getLines(this._g).iterator();n.hasNext();){var i=n.next();this.extractPoints(i,e,t)}return t}},{key:"computeOffsetPoints",value:function(e,t,n,i){var r=t.x-e.x,s=t.y-e.y,o=Math.sqrt(r*r+s*s),a=n*r/o,u=n*s/o,l=(t.x+e.x)/2,h=(t.y+e.y)/2;if(this._doLeft){var c=new L(l-u,h+a);i.add(c)}if(this._doRight){var f=new L(l+u,h-a);i.add(f)}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}]),e}(),Bi=(function(){function e(){_(this,e),this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=e.TOLERANCE,this._testCoords=new de;var t=arguments[0],n=arguments[1],i=arguments[2];this._boundaryDistanceTolerance=e.computeBoundaryDistanceTolerance(t,n),this._geom=[t,n,i],this._locFinder=[new Fi(this._geom[0],this._boundaryDistanceTolerance),new Fi(this._geom[1],this._boundaryDistanceTolerance),new Fi(this._geom[2],this._boundaryDistanceTolerance)]}p(e,[{key:"reportResult",value:function(e,t,n){z.out.println("Overlay result invalid - A:"+O.toLocationSymbol(t[0])+" B:"+O.toLocationSymbol(t[1])+" expected:"+(n?"i":"e")+" actual:"+O.toLocationSymbol(t[2]))}},{key:"isValid",value:function(e){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var t=this.checkValid(e);return t}},{key:"checkValid",value:function(){if(1===arguments.length){for(var t=arguments[0],n=0;n<this._testCoords.size();n++){var i=this._testCoords.get(n);if(!this.checkValid(t,i))return this._invalidLocation=i,!1}return!0}if(2===arguments.length){var r=arguments[0],s=arguments[1];return this._location[0]=this._locFinder[0].getLocation(s),this._location[1]=this._locFinder[1].getLocation(s),this._location[2]=this._locFinder[2].getLocation(s),!!e.hasLocation(this._location,O.BOUNDARY)||this.isValidResult(r,this._location)}}},{key:"addTestPts",value:function(e){var t=new qi(e);this._testCoords.addAll(t.getPoints(5*this._boundaryDistanceTolerance))}},{key:"isValidResult",value:function(e,t){var n=Ai.isResultOfOp(t[0],t[1],e),i=!(n^t[2]===O.INTERIOR);return i||this.reportResult(e,t,n),i}},{key:"getInvalidLocation",value:function(){return this._invalidLocation}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"hasLocation",value:function(e,t){for(var n=0;n<3;n++)if(e[n]===t)return!0;return!1}},{key:"computeBoundaryDistanceTolerance",value:function(e,t){return Math.min(ci.computeSizeBasedSnapTolerance(e),ci.computeSizeBasedSnapTolerance(t))}},{key:"isValid",value:function(t,n,i,r){return new e(t,n,r).isValid(i)}},{key:"TOLERANCE",get:function(){return 1e-6}}])}(),function(){function e(t){_(this,e),this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=e.extractFactory(t),this._inputGeoms=t}return p(e,[{key:"extractElements",value:function(e,t){if(null===e)return null;for(var n=0;n<e.getNumGeometries();n++){var i=e.getGeometryN(n);this._skipEmpty&&i.isEmpty()||t.add(i)}}},{key:"combine",value:function(){for(var e=new de,t=this._inputGeoms.iterator();t.hasNext();){var n=t.next();this.extractElements(n,e)}return 0===e.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(e)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"combine",value:function(){if(1===arguments.length){return new e(arguments[0]).combine()}if(2===arguments.length){var t=arguments[0],n=arguments[1];return new e(e.createList(t,n)).combine()}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];return new e(e.createList(i,r,s)).combine()}}},{key:"extractFactory",value:function(e){return e.isEmpty()?null:e.iterator().next().getFactory()}},{key:"createList",value:function(){if(2===arguments.length){var e=arguments[0],t=arguments[1],n=new de;return n.add(e),n.add(t),n}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=new de;return o.add(i),o.add(r),o.add(s),o}}}]),e}()),zi=function(){function e(){_(this,e),this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new de)}return p(e,[{key:"reduceToGeometries",value:function(e){for(var t=new de,n=e.iterator();n.hasNext();){var i=n.next(),r=null;R(i,ve)?r=this.unionTree(i):i instanceof re&&(r=i),t.add(r)}return t}},{key:"extractByEnvelope",value:function(e,t,n){for(var i=new de,r=0;r<t.getNumGeometries();r++){var s=t.getGeometryN(r);s.getEnvelopeInternal().intersects(e)?i.add(s):n.add(s)}return this._geomFactory.buildGeometry(i)}},{key:"unionOptimized",value:function(e,t){var n=e.getEnvelopeInternal(),i=t.getEnvelopeInternal();if(!n.intersects(i)){return Bi.combine(e,t)}if(e.getNumGeometries()<=1&&t.getNumGeometries()<=1)return this.unionActual(e,t);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(e,t,r)}},{key:"union",value:function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new qt(e.STRTREE_NODE_CAPACITY),n=this._inputPolys.iterator();n.hasNext();){var i=n.next();t.insert(i.getEnvelopeInternal(),i)}this._inputPolys=null;var r=t.itemsTree();return this.unionTree(r)}},{key:"binaryUnion",value:function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(r-i<=1){var s=e.getGeometry(n,i);return this.unionSafe(s,null)}if(r-i==2)return this.unionSafe(e.getGeometry(n,i),e.getGeometry(n,i+1));var o=Math.trunc((r+i)/2),a=this.binaryUnion(n,i,o),u=this.binaryUnion(n,o,r);return this.unionSafe(a,u)}}},{key:"repeatedUnion",value:function(e){for(var t=null,n=e.iterator();n.hasNext();){var i=n.next();t=null===t?i.copy():t.union(i)}return t}},{key:"unionSafe",value:function(e,t){return null===e&&null===t?null:null===e?t.copy():null===t?e.copy():this.unionOptimized(e,t)}},{key:"unionActual",value:function(t,n){return e.restrictToPolygons(t.union(n))}},{key:"unionTree",value:function(e){var t=this.reduceToGeometries(e);return this.binaryUnion(t)}},{key:"unionUsingEnvelopeIntersection",value:function(e,t,n){var i=new de,r=this.extractByEnvelope(n,e,i),s=this.extractByEnvelope(n,t,i),o=this.unionActual(r,s);i.add(o);return Bi.combine(i)}},{key:"bufferUnion",value:function(){if(1===arguments.length){var e=arguments[0];return e.get(0).getFactory().buildGeometry(e).buffer(0)}if(2===arguments.length){var t=arguments[0],n=arguments[1];return t.getFactory().createGeometryCollection([t,n]).buffer(0)}}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"restrictToPolygons",value:function(e){if(R(e,Ve))return e;var t=Un.getPolygons(e);return 1===t.size()?t.get(0):e.getFactory().createMultiPolygon(nt.toPolygonArray(t))}},{key:"getGeometry",value:function(e,t){return t>=e.size()?null:e.get(t)}},{key:"union",value:function(t){return new e(t).union()}},{key:"STRTREE_NODE_CAPACITY",get:function(){return 4}}]),e}(),Vi=function(){function e(){_(this,e),this._pointGeom=null,this._otherGeom=null,this._geomFact=null;var t=arguments[0],n=arguments[1];this._pointGeom=t,this._otherGeom=n,this._geomFact=n.getFactory()}return p(e,[{key:"union",value:function(){for(var e=new Yn,t=new f,n=0;n<this._pointGeom.getNumGeometries();n++){var i=this._pointGeom.getGeometryN(n).getCoordinate();e.locate(i,this._otherGeom)===O.EXTERIOR&&t.add(i)}if(0===t.size())return this._otherGeom;var r=null,s=me.toCoordinateArray(t);return r=1===s.length?this._geomFact.createPoint(s[0]):this._geomFact.createMultiPointFromCoords(s),Bi.combine(r,this._otherGeom)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"union",value:function(t,n){return new e(t,n).union()}}]),e}(),Ui=function(){function e(t,n){_(this,e),this._sortIndex=void 0!==t?t:-1,this._comps=n||null}return p(e,[{key:"filter",value:function(e){-1!==this._sortIndex&&e.getSortIndex()!==this._sortIndex||this._comps.add(e)}},{key:"interfaces_",value:function(){return[Re]}},{key:"getClass",value:function(){return e}}],[{key:"extract",value:function(){if(2===arguments.length){var t=arguments[0],n=arguments[1];return e.extract(t,n,new de)}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];return i.getSortIndex()===r?s.add(i):i instanceof be&&i.apply(new e(r,s)),s}}}]),e}(),Xi=(function(){function e(){if(_(this,e),this._polygons=new de,this._lines=new de,this._points=new de,this._geomFact=null,1===arguments.length){if(R(arguments[0],fe)){var t=arguments[0];this.extract(t)}else if(arguments[0]instanceof re){var n=arguments[0];this.extract(n)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this._geomFact=r,this.extract(i)}}p(e,[{key:"unionNoOpt",value:function(e){var t=this._geomFact.createPoint();return pi.overlayOp(e,t,Ai.UNION)}},{key:"unionWithNull",value:function(e,t){return null===e&&null===t?null:null===t?e:null===e?t:e.union(t)}},{key:"extract",value:function(){if(R(arguments[0],fe))for(var e=arguments[0].iterator();e.hasNext();){var t=e.next();this.extract(t)}else if(arguments[0]instanceof re){var n=arguments[0];null===this._geomFact&&(this._geomFact=n.getFactory()),Ui.extract(n,re.SORTINDEX_POLYGON,this._polygons),Ui.extract(n,re.SORTINDEX_LINESTRING,this._lines),Ui.extract(n,re.SORTINDEX_POINT,this._points)}}},{key:"union",value:function(){if(null===this._geomFact)return null;var e=null;if(this._points.size()>0){var t=this._geomFact.buildGeometry(this._points);e=this.unionNoOpt(t)}var n=null;if(this._lines.size()>0){var i=this._geomFact.buildGeometry(this._lines);n=this.unionNoOpt(i)}var r=null;this._polygons.size()>0&&(r=zi.union(this._polygons));var s=this.unionWithNull(n,r),o=null;return o=null===e?s:null===s?e:Vi.union(e,s),null===o?this._geomFact.createGeometryCollection():o}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"union",value:function(){if(1===arguments.length){if(R(arguments[0],fe)){return new e(arguments[0]).union()}if(arguments[0]instanceof re){return new e(arguments[0]).union()}}else if(2===arguments.length){return new e(arguments[0],arguments[1]).union()}}}])}(),function(){function e(){_(this,e),this._geomFactory=null,this._g0=null,this._g1=null,this._interacts0=null,this._interacts1=null;var t=arguments[0],n=arguments[1];this._g0=t,this._g1=n,this._geomFactory=t.getFactory(),this._interacts0=new Array(t.getNumGeometries()).fill(null),this._interacts1=new Array(n.getNumGeometries()).fill(null)}p(e,[{key:"extractElements",value:function(e,t,n){for(var i=new de,r=0;r<e.getNumGeometries();r++){var s=e.getGeometryN(r);t[r]===n&&i.add(s)}return this._geomFactory.buildGeometry(i)}},{key:"computeInteracting",value:function(){if(0===arguments.length)for(var e=0;e<this._g0.getNumGeometries();e++){var t=this._g0.getGeometryN(e);this._interacts0[e]=this.computeInteracting(t)}else if(1===arguments.length){for(var n=arguments[0],i=!1,r=0;r<this._g1.getNumGeometries();r++){var s=this._g1.getGeometryN(r).getEnvelopeInternal().intersects(n.getEnvelopeInternal());s&&(this._interacts1[r]=!0),s&&(i=!0)}return i}}},{key:"union",value:function(){this.computeInteracting();var e=this.extractElements(this._g0,this._interacts0,!0),t=this.extractElements(this._g1,this._interacts1,!0);(e.isEmpty()||t.isEmpty())&&z.out.println("found empty!");var n=e.union(t),i=this.extractElements(this._g0,this._interacts0,!1),r=this.extractElements(this._g1,this._interacts1,!1);return Bi.combine(n,i,r)}},{key:"bufferUnion",value:function(e,t){return e.getFactory().createGeometryCollection([e,t]).buffer(0)}},{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"union",value:function(t,n){return new e(t,n).union()}}])}(),function(){function e(){_(this,e)}return p(e,[{key:"interfaces_",value:function(){return[]}},{key:"getClass",value:function(){return e}}],[{key:"union",value:function(e,t){if(e.isEmpty()||t.isEmpty()){if(e.isEmpty()&&t.isEmpty())return Ai.createEmptyResult(Ai.UNION,e,t,e.getFactory());if(e.isEmpty())return t.copy();if(t.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(t),pi.overlayOp(e,t,Ai.UNION)}}]),e}());e.GeoJSONReader=at,e.GeoJSONWriter=ut,e.OverlayOp=Ai,e.UnionOp=Xi,e.BufferOp=Gn,Object.defineProperty(e,"__esModule",{value:!0})});
